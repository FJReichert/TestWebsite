<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projektmanagement Dokumentationssystem</title>
    <link rel="stylesheet" href="styles.css"> <!-- Linking to the shared styles.css -->
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>Projektmanagement Dokumentationssystem</h1>
            <p>Einheitliche Vorlagen f√ºr alle Projektphasen</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('project-kickoff', event)">Project Kickoff</button>
            <button class="nav-tab" onclick="showTab(event, 'meeting-minutes')">Meeting Minutes</button>
            <button class="nav-tab" onclick="showTab(event, 'risk-management')">Risk Management</button>
            <button class="nav-tab" onclick="showTab(event, 'lessons-learned')">Lessons Learned</button>
            <button class="nav-tab" onclick="showTab(event, 'project-handover')">Project Handover</button>
        </div>

        <div class="content">
            <div id="project-kickoff" class="tab-content active">
                <div class="section">
                    <h2>Projekt√ºbersicht</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name">Projektname:</label>
                            <input type="text" id="project-name" placeholder="Name des Projekts">
                        </div>
                        <div class="form-group">
                            <label for="project-leader">Projektleiter:</label>
                            <input type="text" id="project-leader" placeholder="Name des Projektleiters">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="project-goal">Projektziele:</label>
                        <textarea id="project-goal" placeholder="Hauptziele und SMART-Kriterien" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="project-scope">Projektumfang (Scope):</label>
                        <textarea id="project-scope" placeholder="Was ist im Umfang enthalten? Was ist ausgeschlossen?" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Projektteam & Rollen</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Rolle</th>
                                <th>Verantwortlichkeit</th>
                                <th>Kontakt</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="team-tbody">
                            <tr>
                                <td><input type="text" placeholder="Name"></td>
                                <td><input type="text" placeholder="Rolle"></td>
                                <td><input type="text" placeholder="Verantwortlichkeit"></td>
                                <td><input type="text" placeholder="E-Mail / Tel."></td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addTeamMember()">+ Teammitglied hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Meilensteine & Zeitplan (High-Level)</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Meilenstein</th>
                                <th>Lieferobjekte (Deliverables)</th>
                                <th>Datum</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="milestone-tbody">
                            <tr>
                                <td><input type="text" placeholder="Meilenstein-Name"></td>
                                <td><input type="text" placeholder="Deliverables"></td>
                                <td><input type="date"></td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addMilestone()">+ Meilenstein hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Budget & Ressourcen (Sch√§tzung)</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="estimated-budget">Gesch√§tztes Budget (‚Ç¨):</label>
                            <input type="number" id="estimated-budget" placeholder="Gesamtbudget" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="resources-needed">Ben√∂tigte Ressourcen:</label>
                            <input type="text" id="resources-needed" placeholder="Personal, Software, Hardware">
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>Kommunikation & Stakeholder</h2>
                    <div class="form-group">
                        <label for="communication-plan">Kommunikationsplan:</label>
                        <textarea id="communication-plan" placeholder="Frequenz, Kan√§le, Teilnehmer der Meetings" class="textarea-large"></textarea>
                    </div>
                    <h3>Wichtige Stakeholder</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Rolle</th>
                                <th>Erwartung</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="stakeholder-tbody">
                            <tr>
                                <td><input type="text" placeholder="Name"></td>
                                <td><input type="text" placeholder="Rolle/Abteilung"></td>
                                <td><input type="text" placeholder="Erwartungen"></td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addStakeholder()">+ Stakeholder hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Risikobetrachtung (Initial)</h2>
                    <div class="form-group">
                        <label for="initial-risks">Initiale Risiken:</label>
                        <textarea id="initial-risks" placeholder="Erste identifizierte Risiken und Gegenma√ünahmen" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="version-info">
                    <p id="version-date">Version 1.0 / <script>document.write(new Date().toLocaleDateString('de-DE'))</script></p>
                </div>
            </div>

            <div id="meeting-minutes" class="tab-content">
                <div class="section">
                    <h2>Meeting Details</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="meetingName">Meeting-Titel:</label>
                            <input type="text" id="meetingName" placeholder="Z.B. W√∂chentliches Projekt-Update">
                        </div>
                        <div class="form-group">
                            <label for="meetingDate">Datum:</label>
                            <input type="date" id="meetingDate">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="meetingTime">Uhrzeit:</label>
                            <input type="time" id="meetingTime">
                        </div>
                        <div class="form-group">
                            <label for="meetingLocation">Ort/Online-Link:</label>
                            <input type="text" id="meetingLocation" placeholder="Konferenzraum A / Zoom-Link">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="organizer">Organisator:</label>
                        <input type="text" id="organizer" placeholder="Name des Organisators">
                    </div>
                </div>

                <div class="section">
                    <h2>Teilnehmer & Abwesende</h2>
                    <div class="form-group">
                        <label for="presentParticipants">Anwesende Teilnehmer:</label>
                        <textarea id="presentParticipants" placeholder="Namen der Anwesenden, durch Komma getrennt oder Liste"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="absentParticipants">Abwesende Teilnehmer:</label>
                        <textarea id="absentParticipants" placeholder="Namen der Abwesenden (mit Entschuldigung)"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Agenda & Diskussionspunkte</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Thema</th>
                                <th>Diskussionspunkte</th>
                                <th>Aktionspunkte / Beschl√ºsse</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="agendaTableBody">
                            <tr>
                                <td><input type="text" placeholder="Agendapunkt"></td>
                                <td><textarea placeholder="Wichtige Diskussionspunkte"></textarea></td>
                                <td><textarea placeholder="Beschl√ºsse, n√§chste Schritte, Verantwortliche"></textarea></td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addAgendaItem()">+ Agendapunkt hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Offene Punkte, Probleme & Risiken</h2>
                    <div class="form-group">
                        <label for="issuesRisks">Beschreibung offener Punkte, Probleme oder Risiken:</label>
                        <textarea id="issuesRisks" placeholder="Aktuelle Herausforderungen, Blocker, neue Risiken"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>N√§chste Schritte & Verantwortlichkeiten</h2>
                    <div class="form-group">
                        <label for="nextSteps">√úbersicht der n√§chsten Schritte:</label>
                        <textarea id="nextSteps" placeholder="Klare Aktionspunkte, Verantwortlichkeiten und F√§lligkeiten"></textarea>
                    </div>
                </div>

                <div class="version-info">
                    <p>Meeting Minutes Template</p>
                </div>
            </div>

            <div id="risk-management" class="tab-content">
                <div class="section">
                    <h2>Risikoregistrierung</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Risiko-ID</th>
                                <th>Beschreibung</th>
                                <th>Eintrittswahrscheinlichkeit</th>
                                <th>Auswirkung</th>
                                <th>Risikobewertung</th>
                                <th>Gegenma√ünahme</th>
                                <th>Verantwortlicher</th>
                                <th>Status</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="risk-table-body">
                            <tr>
                                <td><input type="text" value="R-001" readonly></td>
                                <td><input type="text" placeholder="Beschreibung des Risikos"></td>
                                <td>
                                    <select onchange="updateRiskScore(this)">
                                        <option value="1">Gering (10-30%)</option>
                                        <option value="2">Mittel (30-70%)</option>
                                        <option value="3">Hoch (70-90%)</option>
                                    </select>
                                </td>
                                <td>
                                    <select onchange="updateRiskScore(this)">
                                        <option value="1">Gering</option>
                                        <option value="2">Mittel</option>
                                        <option value="3">Hoch</option>
                                    </select>
                                </td>
                                <td><span class="status-badge low" data-risk-score="1">Gering</span></td>
                                <td><input type="text" placeholder="Geplante Gegenma√ünahme"></td>
                                <td><input type="text" placeholder="Name"></td>
                                <td>
                                    <select>
                                        <option>Offen</option>
                                        <option>In Bearbeitung</option>
                                        <option>Geschlossen</option>
                                    </select>
                                </td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addRiskRow()">+ Risiko hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Risikobetrachtung & Strategie</h2>
                    <div class="form-group">
                        <label for="overall-risk-assessment">Gesamtrisikobewertung des Projekts:</label>
                        <textarea id="overall-risk-assessment" placeholder="Zusammenfassung der Gesamtrisikolage und gr√∂√üten Bedrohungen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="risk-strategy">Risikomanagement-Strategie:</label>
                        <textarea id="risk-strategy" placeholder="Ansatz zum Umgang mit Risiken (Vermeiden, Mindern, Akzeptieren, √úbertragen)" class="textarea-large"></textarea>
                    </div>
                </div>
            </div>

            <div id="lessons-learned" class="tab-content">
                <div class="section">
                    <h2>Lessons Learned √úbersicht</h2>
                    <div class="form-group">
                        <label for="ll-project-name">Projektname f√ºr Lessons Learned:</label>
                        <input type="text" id="ll-project-name" placeholder="Name des Projekts">
                    </div>
                    <div class="form-group">
                        <label for="ll-date">Datum der Erfassung:</label>
                        <input type="date" id="ll-date">
                    </div>
                    <div class="form-group">
                        <label for="ll-facilitator">Moderator:</label>
                        <input type="text" id="ll-facilitator" placeholder="Name des Moderators">
                    </div>
                </div>

                <div class="section">
                    <h2>Erfolgreiche Aspekte & Best Practices</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Thema</th>
                                <th>Was gut lief</th>
                                <th>Best Practice / Empfehlung</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="good-lessons-tbody">
                            <tr>
                                <td><input type="text" placeholder="Z.B. Kommunikation"></td>
                                <td><textarea placeholder="Was war besonders erfolgreich?"></textarea></td>
                                <td><textarea placeholder="Empfehlung f√ºr zuk√ºnftige Projekte"></textarea></td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addGoodLesson()">+ Positive Erfahrung hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Herausforderungen & Verbesserungspotenziale</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Thema</th>
                                <th>Was schwierig war</th>
                                <th>L√∂sung / Verbesserungsma√ünahme</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="bad-lessons-tbody">
                            <tr>
                                <td><input type="text" placeholder="Z.B. Risikomanagement"></td>
                                <td><textarea placeholder="Welche Schwierigkeiten gab es?"></textarea></td>
                                <td><textarea placeholder="Wie kann es zuk√ºnftig besser gemacht werden?"></textarea></td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addBadLesson()">+ Herausforderung hinzuf√ºgen</button>
                </div>

                <div class="section">
                    <h2>Aktionsplan aus Lessons Learned</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Aktion</th>
                                <th>Verantwortlicher</th>
                                <th>F√§lligkeitsdatum</th>
                                <th>Status</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="action-plan-tbody">
                            <tr>
                                <td><input type="text" placeholder="Konkrete Aktion"></td>
                                <td><input type="text" placeholder="Name"></td>
                                <td><input type="date"></td>
                                <td>
                                    <select>
                                        <option>Offen</option>
                                        <option>In Bearbeitung</option>
                                        <option>Abgeschlossen</option>
                                    </select>
                                </td>
                                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addActionPlanItem()">+ Aktionspunkt hinzuf√ºgen</button>
                </div>
            </div>

            <div id="project-handover" class="tab-content">
                <div class="section">
                    <h2>Projekt√ºbergabedokument</h2>
                    <div class="form-group">
                        <label for="handover-project-name">Projektname:</label>
                        <input type="text" id="handover-project-name" placeholder="Name des √ºbergebenen Projekts">
                    </div>
                    <div class="form-group">
                        <label for="handover-date">√úbergabedatum:</label>
                        <input type="date" id="handover-date">
                    </div>
                    <div class="form-group">
                        <label for="handover-from">√úbergebendes Team/Person:</label>
                        <input type="text" id="handover-from" placeholder="Name oder Abteilung">
                    </div>
                    <div class="form-group">
                        <label for="handover-to">Empfangendes Team/Person:</label>
                        <input type="text" id="handover-to" placeholder="Name oder Abteilung">
                    </div>
                </div>

                <div class="section">
                    <h2>Projektzusammenfassung & Status</h2>
                    <div class="form-group">
                        <label for="project-summary">Kurze Projektzusammenfassung:</label>
                        <textarea id="project-summary" placeholder="Wichtigste Ziele, Ergebnisse und Kontext" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="final-status">Finaler Projektstatus:</label>
                        <select id="final-status">
                            <option>Abgeschlossen</option>
                            <option>Teilweise abgeschlossen</option>
                            <option>Abgebrochen</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="remaining-tasks">Offene Aufgaben / Restarbeiten:</label>
                        <textarea id="remaining-tasks" placeholder="Aufgaben, die nach der √úbergabe noch offen sind" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Wichtige Dokumente & Assets</h2>
                    <div class="form-group">
                        <label for="document-locations">Speicherorte wichtiger Dokumente (z.B. Konzepte, Pl√§ne, Reports):</label>
                        <textarea id="document-locations" placeholder="Links zu relevanten Ordnern/Dokumenten (Drive, SharePoint etc.)" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="tool-access">Zug√§nge zu Tools/Systemen:</label>
                        <textarea id="tool-access" placeholder="Liste der ben√∂tigten Zug√§nge zu Tools, Systemen, Repositories" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="contacts">Wichtige Ansprechpartner:</label>
                        <textarea id="contacts" placeholder="Namen und Kontaktdaten von Schl√ºsselpersonen" class="textarea-large"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-secondary" onclick="printDocument()">üìÑ Dokument drucken</button>
            <button class="btn btn-primary" onclick="saveCombinedDocument()">üíæ Dokument speichern</button>
            <button class="btn btn-success" onclick="exportHandover()">üîÑ √úbergabe-Paket exportieren</button>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const firstTabButton = document.querySelector(".nav-tab");
            if (firstTabButton) {
                firstTabButton.click();
            }

            // Set today's date for relevant inputs
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) { // Only set if not already set
                    input.value = today;
                }
            });
             // Set default risk score for existing rows
             document.querySelectorAll('#risk-table-body tr').forEach(row => {
                const likelihoodSelect = row.cells[2].querySelector('select');
                if (likelihoodSelect) { // Ensure the select element exists
                    updateRiskScore(likelihoodSelect);
                }
            });
        });

        function showTab(tabName, event) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            if (event) {
                event.currentTarget.classList.add('active');
            }
        }

        function addTeamMember() {
            const tbody = document.getElementById('team-tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Name"></td>
                <td><input type="text" placeholder="Rolle"></td>
                <td><input type="text" placeholder="Verantwortlichkeit"></td>
                <td><input type="text" placeholder="E-Mail / Tel."></td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addMilestone() {
            const tbody = document.getElementById('milestone-tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Meilenstein-Name"></td>
                <td><input type="text" placeholder="Deliverables"></td>
                <td><input type="date"></td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addStakeholder() {
            const tbody = document.getElementById('stakeholder-tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Name"></td>
                <td><input type="text" placeholder="Rolle/Abteilung"></td>
                <td><input type="text" placeholder="Erwartungen"></td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addRiskRow() {
            const tbody = document.getElementById('risk-table-body');
            const newRow = document.createElement('tr');
            const newId = 'R-' + String(tbody.children.length + 1).padStart(3, '0');
            newRow.innerHTML = `
                <td><input type="text" value="${newId}" readonly></td>
                <td><input type="text" placeholder="Beschreibung des Risikos"></td>
                <td>
                    <select onchange="updateRiskScore(this)">
                        <option value="1">Gering (10-30%)</option>
                        <option value="2">Mittel (30-70%)</option>
                        <option value="3">Hoch (70-90%)</option>
                    </select>
                </td>
                <td>
                    <select onchange="updateRiskScore(this)">
                        <option value="1">Gering</option>
                        <option value="2">Mittel</option>
                        <option value="3">Hoch</option>
                    </select>
                </td>
                <td><span class="status-badge" data-risk-score="1"></span></td>
                <td><input type="text" placeholder="Geplante Gegenma√ünahme"></td>
                <td><input type="text" placeholder="Name"></td>
                <td>
                    <select>
                        <option>Offen</option>
                        <option>In Bearbeitung</option>
                        <option>Geschlossen</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
            updateRiskScore(newRow.querySelector('select')); // Initialize score for new row
        }

        function updateRiskScore(selectElement) {
            const row = selectElement.closest('tr');
            const likelihood = parseInt(row.cells[2].querySelector('select').value);
            const impact = parseInt(row.cells[3].querySelector('select').value);
            const score = likelihood * impact;
            const scoreElement = row.cells[4].querySelector('.status-badge');
            scoreElement.textContent = getRiskLevel(score);
            scoreElement.className = 'status-badge ' + getRiskLevel(score).toLowerCase();
            scoreElement.dataset.riskScore = score;
        }

        function getRiskLevel(score) {
            if (score <= 2) return 'Niedrig';
            if (score <= 4) return 'Mittel';
            return 'Hoch';
        }

        function addAgendaItem() {
            const tbody = document.getElementById('agendaTableBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Agendapunkt"></td>
                <td><textarea placeholder="Wichtige Diskussionspunkte"></textarea></td>
                <td><textarea placeholder="Beschl√ºsse, n√§chste Schritte, Verantwortliche"></textarea></td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addGoodLesson() {
            const tbody = document.getElementById('good-lessons-tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Z.B. Kommunikation"></td>
                <td><textarea placeholder="Was war besonders erfolgreich?"></textarea></td>
                <td><textarea placeholder="Empfehlung f√ºr zuk√ºnftige Projekte"></textarea></td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addBadLesson() {
            const tbody = document.getElementById('bad-lessons-tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Z.B. Risikomanagement"></td>
                <td><textarea placeholder="Welche Schwierigkeiten gab es?"></textarea></td>
                <td><textarea placeholder="Wie kann es zuk√ºnftig besser gemacht werden?"></textarea></td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addActionPlanItem() {
            const tbody = document.getElementById('action-plan-tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Konkrete Aktion"></td>
                <td><input type="text" placeholder="Name"></td>
                <td><input type="date"></td>
                <td>
                    <select>
                        <option>Offen</option>
                        <option>In Bearbeitung</option>
                        <option>Abgeschlossen</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="this.closest('tr').remove()">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function printDocument() {
            alert('Das Dokument wird gedruckt. In einer echten Anwendung w√ºrde dies die Druckfunktion des Browsers aufrufen.');
            window.print();
        }

        function saveCombinedDocument() {
            // Funktion zum Sammeln von Daten aus einer Tabelle
            function getTableData(tableBodyId) {
                const data = [];
                document.querySelectorAll(`#${tableBodyId} tr`).forEach(row => {
                    const rowData = {};
                    row.querySelectorAll('input, select, textarea').forEach((input, index) => {
                        // Verwende den Platzhalter oder eine generische Bezeichnung, wenn keine ID vorhanden ist
                        const key = input.id || input.placeholder || `col${index}`;
                        rowData[key] = input.value;
                    });
                    data.push(rowData);
                });
                return data;
            }

            // Funktion zum Erstellen von HTML f√ºr Tabellendaten
            function createTableHtml(headers, data) {
                let html = '<table class="output-table"><thead><tr>';
                headers.forEach(header => {
                    html += `<th>${header}</th>`;
                });
                html += '</tr></thead><tbody>';
                data.forEach(row => {
                    html += '<tr>';
                    headers.forEach(header => {
                        // Finde den Wert basierend auf dem Header-Text oder dem entsprechenden Schl√ºssel
                        const key = Object.keys(row).find(k => row[k] === row[header] || k.toLowerCase().includes(header.toLowerCase().replace(/ /g, '')));
                        html += `<td>${row[key] ? row[key].replace(/\n/g, '<br>') : ''}</td>`;
                    });
                    html += '</tr>';
                });
                html += '</tbody></table>';
                return html;
            }

            // --- Daten sammeln ---

            // Project Kickoff Daten
            const projectName = document.getElementById('project-name').value;
            const projectLeader = document.getElementById('project-leader').value;
            const projectGoal = document.getElementById('project-goal').value;
            const projectScope = document.getElementById('project-scope').value;
            const teamMembers = getTableData('team-tbody');
            const milestones = getTableData('milestone-tbody');
            const estimatedBudget = document.getElementById('estimated-budget').value;
            const resourcesNeeded = document.getElementById('resources-needed').value;
            const communicationPlan = document.getElementById('communication-plan').value;
            const stakeholders = getTableData('stakeholder-tbody');
            const initialRisks = document.getElementById('initial-risks').value;
            const versionDate = document.getElementById('version-date').textContent;

            // Meeting Minutes Daten
            const meetingName = document.getElementById('meetingName').value;
            const meetingDate = document.getElementById('meetingDate').value;
            const meetingTime = document.getElementById('meetingTime').value;
            const meetingLocation = document.getElementById('meetingLocation').value;
            const organizer = document.getElementById('organizer').value;
            const presentParticipants = document.getElementById('presentParticipants').value;
            const absentParticipants = document.getElementById('absentParticipants').value;
            const agendaItems = getTableData('agendaTableBody');
            const issuesRisks = document.getElementById('issuesRisks').value;
            const nextSteps = document.getElementById('nextSteps').value;

            // Risk Management Daten
            const risks = [];
            document.querySelectorAll('#risk-table-body tr').forEach(row => {
                const riskId = row.cells[0].querySelector('input').value;
                const description = row.cells[1].querySelector('input').value;
                const likelihood = row.cells[2].querySelector('select').value;
                const impact = row.cells[3].querySelector('select').value;
                const riskScore = row.cells[4].textContent; // Text content of the span
                const countermeasure = row.cells[5].querySelector('input').value;
                const responsible = row.cells[6].querySelector('input').value;
                const status = row.cells[7].querySelector('select').value;
                risks.push({ riskId, description, likelihood, impact, riskScore, countermeasure, responsible, status });
            });
            const overallRiskAssessment = document.getElementById('overall-risk-assessment').value;
            const riskStrategy = document.getElementById('risk-strategy').value;

            // Lessons Learned Daten
            const llProjectName = document.getElementById('ll-project-name').value;
            const llDate = document.getElementById('ll-date').value;
            const llFacilitator = document.getElementById('ll-facilitator').value;
            const goodLessons = getTableData('good-lessons-tbody');
            const badLessons = getTableData('bad-lessons-tbody');
            const actionPlan = getTableData('action-plan-tbody');

            // Project Handover Daten
            const handoverProjectName = document.getElementById('handover-project-name').value;
            const handoverDate = document.getElementById('handover-date').value;
            const handoverFrom = document.getElementById('handover-from').value;
            const handoverTo = document.getElementById('handover-to').value;
            const projectSummary = document.getElementById('project-summary').value;
            const finalStatus = document.getElementById('final-status').value;
            const remainingTasks = document.getElementById('remaining-tasks').value;
            const documentLocations = document.getElementById('document-locations').value;
            const toolAccess = document.getElementById('tool-access').value;
            const contacts = document.getElementById('contacts').value;

            // --- HTML-Struktur f√ºr den Download erstellen ---
            let teamMembersHtml = createTableHtml(['Name', 'Rolle', 'Verantwortlichkeit', 'Kontakt'], teamMembers);
            let milestonesHtml = createTableHtml(['Meilenstein', 'Lieferobjekte', 'Datum'], milestones);
            let stakeholdersHtml = createTableHtml(['Name', 'Rolle', 'Erwartung'], stakeholders);
            let agendaItemsHtml = createTableHtml(['Thema', 'Diskussionspunkte', 'Aktionspunkte / Beschl√ºsse'], agendaItems);
            let risksHtml = createTableHtml(['Risiko-ID', 'Beschreibung', 'Eintrittswahrscheinlichkeit', 'Auswirkung', 'Risikobewertung', 'Gegenma√ünahme', 'Verantwortlicher', 'Status'], risks);
            let goodLessonsHtml = createTableHtml(['Thema', 'Was gut lief', 'Best Practice / Empfehlung'], goodLessons);
            let badLessonsHtml = createTableHtml(['Thema', 'Was schwierig war', 'L√∂sung / Verbesserungsma√ünahme'], badLessons);
            let actionPlanHtml = createTableHtml(['Aktion', 'Verantwortlicher', 'F√§lligkeitsdatum', 'Status'], actionPlan);


            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Projektmanagement Dokumentation (Statisch)</title>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; line-height: 1.6; color: #333; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); padding: 40px; }
                        .header { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; margin-bottom: 30px;}
                        .header h1 { font-size: 2.2rem; margin-bottom: 10px; }
                        .header p { font-size: 1.1rem; opacity: 0.9; }
                        .section { margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
                        .section h2 { color: #1e293b; font-size: 1.8rem; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }
                        .section h3 { color: #334155; font-size: 1.3rem; margin-bottom: 15px; margin-top: 25px; }
                        .form-group { margin-bottom: 20px; }
                        .form-group label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; }
                        .form-group p {
                            margin-top: 0;
                            margin-bottom: 0;
                            padding: 8px 0;
                            border-bottom: 1px dotted #ccc;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                        }
                        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
                        .output-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 20px 0;
                            background: white;
                            border-radius: 8px;
                            overflow: hidden;
                            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
                            table-layout: auto;
                        }
                        .output-table th, .output-table td {
                            padding: 12px 15px;
                            text-align: left;
                            border-bottom: 1px solid #e5e7eb;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                        }
                        .output-table th { background: #f8fafc; font-weight: 600; color: #374151; }
                        .status-badge {
                            display: inline-block;
                            padding: 5px 10px;
                            border-radius: 5px;
                            font-size: 0.85em;
                            font-weight: 600;
                            margin-top: 5px;
                        }
                        .status-badge.niedrig { background-color: #2ecc71; color: white; }
                        .status-badge.mittel { background-color: #f1c40f; color: #333; }
                        .status-badge.hoch { background-color: #e74c3c; color: white; }
                        @media (max-width: 768px) {
                            .form-row { grid-template-columns: 1fr; }
                            .container { padding: 20px; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>Projektmanagement Dokumentationssystem</h1>
                            <p>Einheitliche Vorlagen f√ºr alle Projektphasen</p>
                        </div>

                        <div class="content">
                            <div class="section">
                                <h2>Projekt√ºbersicht</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projektname:</label>
                                        <p>${projectName}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Projektleiter:</label>
                                        <p>${projectLeader}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Projektziele:</label>
                                    <p>${projectGoal.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Projektumfang (Scope):</label>
                                    <p>${projectScope.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Projektteam & Rollen</h2>
                                ${teamMembersHtml}
                            </div>

                            <div class="section">
                                <h2>Meilensteine & Zeitplan (High-Level)</h2>
                                ${milestonesHtml}
                            </div>

                            <div class="section">
                                <h2>Budget & Ressourcen (Sch√§tzung)</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Gesch√§tztes Budget (‚Ç¨):</label>
                                        <p>${estimatedBudget}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Ben√∂tigte Ressourcen:</label>
                                        <p>${resourcesNeeded}</p>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Kommunikation & Stakeholder</h2>
                                <div class="form-group">
                                    <label>Kommunikationsplan:</label>
                                    <p>${communicationPlan.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>Wichtige Stakeholder</h3>
                                ${stakeholdersHtml}
                            </div>

                            <div class="section">
                                <h2>Risikobetrachtung (Initial)</h2>
                                <div class="form-group">
                                    <label>Initiale Risiken:</label>
                                    <p>${initialRisks.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>
                            <div class="version-info">
                                <p>${versionDate}</p>
                            </div>

                            <div class="section">
                                <h2>Meeting Minutes</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Meeting-Titel:</label>
                                        <p>${meetingName}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Datum:</label>
                                        <p>${meetingDate}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Uhrzeit:</label>
                                        <p>${meetingTime}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Ort/Online-Link:</label>
                                        <p>${meetingLocation}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Organisator:</label>
                                    <p>${organizer}</p>
                                </div>
                                <div class="form-group">
                                    <label>Anwesende Teilnehmer:</label>
                                    <p>${presentParticipants.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Abwesende Teilnehmer:</label>
                                    <p>${absentParticipants.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>Agenda & Diskussionspunkte</h3>
                                ${agendaItemsHtml}
                                <div class="form-group">
                                    <label>Beschreibung offener Punkte, Probleme oder Risiken:</label>
                                    <p>${issuesRisks.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>√úbersicht der n√§chsten Schritte:</label>
                                    <p>${nextSteps.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Risikomanagement</h2>
                                <h3>Risikoregistrierung</h3>
                                ${risksHtml}
                                <div class="form-group">
                                    <label>Gesamtrisikobewertung des Projekts:</label>
                                    <p>${overallRiskAssessment.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Risikomanagement-Strategie:</label>
                                    <p>${riskStrategy.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Lessons Learned</h2>
                                <div class="form-group">
                                    <label>Projektname f√ºr Lessons Learned:</label>
                                    <p>${llProjectName}</p>
                                </div>
                                <div class="form-group">
                                    <label>Datum der Erfassung:</label>
                                    <p>${llDate}</p>
                                </div>
                                <div class="form-group">
                                    <label>Moderator:</label>
                                    <p>${llFacilitator}</p>
                                </div>
                                <h3>Erfolgreiche Aspekte & Best Practices</h3>
                                ${goodLessonsHtml}
                                <h3>Herausforderungen & Verbesserungspotenziale</h3>
                                ${badLessonsHtml}
                                <h3>Aktionsplan aus Lessons Learned</h3>
                                ${actionPlanHtml}
                            </div>

                            <div class="section">
                                <h2>Projekt√ºbergabedokument</h2>
                                <div class="form-group">
                                    <label>Projektname:</label>
                                    <p>${handoverProjectName}</p>
                                </div>
                                <div class="form-group">
                                    <label>√úbergabedatum:</label>
                                    <p>${handoverDate}</p>
                                </div>
                                <div class="form-group">
                                    <label>√úbergebendes Team/Person:</label>
                                    <p>${handoverFrom}</p>
                                </div>
                                <div class="form-group">
                                    <label>Empfangendes Team/Person:</label>
                                    <p>${handoverTo}</p>
                                </div>
                                <div class="form-group">
                                    <label>Kurze Projektzusammenfassung:</label>
                                    <p>${projectSummary.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Finaler Projektstatus:</label>
                                    <p>${finalStatus}</p>
                                </div>
                                <div class="form-group">
                                    <label>Offene Aufgaben / Restarbeiten:</label>
                                    <p>${remainingTasks.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Speicherorte wichtiger Dokumente:</label>
                                    <p>${documentLocations.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Zug√§nge zu Tools/Systemen:</label>
                                    <p>${toolAccess.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Wichtige Ansprechpartner:</label>
                                    <p>${contacts.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Projektmanagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation erstellt!');
        }

        function exportHandover() {
            alert('√úbergabe-Paket Export w√ºrde hier implementiert werden - alle relevanten Dokumente und Daten f√ºr nahtlose √úbergabe');
        }

    </script>
</body>
</html>
