<!DOCTYPE html>
<html lang="de">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenProject - Partner Relationship Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>OpenProject PRM</h1>
            <p>Partner Relationship Management System</p>
            <div id="documentInfo" style="font-size: 0.8em; color: #666; margin-top: 10px;"></div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('project', event)">üìã Projekt</button>
            <button class="nav-tab" onclick="showTab('partner', event)">ü§ù Partner</button>
            <button class="nav-tab" onclick="showTab('service', event)">‚öôÔ∏è Service</button>
            <button class="nav-tab" onclick="showTab('sales', event)">üíº Vertrieb</button>
            <button class="nav-tab" onclick="showTab('marketing', event)">üì¢ Marketing</button>
            <button class="nav-tab" onclick="showTab('reporting', event)">üìä Reporting</button>
        </div>

        <div id="project" class="tab-content active">
            <div class="section">
                <h2>Projektinitiierung</h2>
                
                <h3>Projektgrundlagen</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="projektname">Projektname:</label>
                        <input type="text" id="projektname" name="projektname" placeholder="Projektbezeichnung eingeben">
                    </div>
                    <div class="form-group">
                        <label for="projekt-id">Projekt-ID:</label>
                        <input type="text" id="projekt-id" name="projekt-id" placeholder="Interne Kennung">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projektleiter">Projektleiter:</label>
                        <input type="text" id="projektleiter" name="projektleiter" placeholder="Name des Verantwortlichen">
                    </div>
                    <div class="form-group">
                        <label for="projektstatus">Projektstatus:</label>
                        <select id="projektstatus" name="projektstatus">
                            <option value="">Status ausw√§hlen</option>
                            <option value="geplant">Geplant</option>
                            <option value="laufend">Laufend</option>
                            <option value="pausiert">Pausiert</option>
                            <option value="abgeschlossen">Abgeschlossen</option>
                        </select>
                    </div>
                </div>

                <h3>Zeitplan & Budget</h3>
                <div class="form-row-triple">
                    <div class="form-group">
                        <label for="start-datum">Startdatum:</label>
                        <input type="date" id="start-datum" name="start-datum">
                    </div>
                    <div class="form-group">
                        <label for="end-datum">Enddatum:</label>
                        <input type="date" id="end-datum" name="end-datum">
                    </div>
                    <div class="form-group">
                        <label for="budget">Budget (‚Ç¨):</label>
                        <input type="number" id="budget" name="budget" placeholder="0,00" step="0.01">
                    </div>
                </div>

                <h3>Projektziel & Beschreibung</h3>
                <div class="form-group">
                    <label for="projektziel">Projektziel:</label>
                    <textarea id="projektziel" name="projektziel" placeholder="Hauptziele und erwartete Ergebnisse des Projekts beschreiben..." class="textarea-large"></textarea>
                </div>

                <div class="form-group">
                    <label for="projektbeschreibung">Detaillierte Projektbeschreibung:</label>
                    <textarea id="projektbeschreibung" name="projektbeschreibung" placeholder="Umfassende Beschreibung des Projektumfangs, der Anforderungen und Deliverables..." class="textarea-large"></textarea>
                </div>
            </div>
        </div>

        <div id="partner" class="tab-content">
            <div class="section">
                <h2>Partner Management</h2>
                
                <h3>Partner-Stammdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-name">Partner Name:</label>
                        <input type="text" id="partner-name" name="partner-name" placeholder="Offizieller Partnername">
                    </div>
                    <div class="form-group">
                        <label for="partner-typ">Partner-Typ:</label>
                        <select id="partner-typ" name="partner-typ">
                            <option value="">Typ ausw√§hlen</option>
                            <option value="reseller">Reseller</option>
                            <option value="distributor">Distributor</option>
                            <option value="system-integrator">System Integrator</option>
                            <option value="technology-partner">Technology Partner</option>
                            <option value="service-partner">Service Partner</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-tier">Partner-Tier:</label>
                        <select id="partner-tier" name="partner-tier">
                            <option value="">Tier ausw√§hlen</option>
                            <option value="gold">Gold Partner</option>
                            <option value="silver">Silver Partner</option>
                            <option value="bronze">Bronze Partner</option>
                            <option value="standard">Standard Partner</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="partner-status">Partner-Status:</label>
                        <select id="partner-status" name="partner-status">
                            <option value="">Status ausw√§hlen</option>
                            <option value="aktiv">Aktiv</option>
                            <option value="inaktiv">Inaktiv</option>
                            <option value="beendet">Beendet</option>
                            <option value="evaluierung">In Evaluierung</option>
                        </select>
                    </div>
                </div>

                <h3>Kontaktdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-ansprechpartner">Hauptansprechpartner:</label>
                        <input type="text" id="partner-ansprechpartner" name="partner-ansprechpartner" placeholder="Name & Position">
                    </div>
                    <div class="form-group">
                        <label for="partner-email">E-Mail:</label>
                        <input type="email" id="partner-email" name="partner-email" placeholder="kontakt@partner.de">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-telefon">Telefon:</label>
                        <input type="tel" id="partner-telefon" name="partner-telefon" placeholder="+49 123 456789">
                    </div>
                    <div class="form-group">
                        <label for="partner-website">Website:</label>
                        <input type="url" id="partner-website" name="partner-website" placeholder="https://www.partner.de">
                    </div>
                </div>

                <h3>Vertragsdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="vertragsstart">Vertragsbeginn:</label>
                        <input type="date" id="vertragsstart" name="vertragsstart">
                    </div>
                    <div class="form-group">
                        <label for="vertragsende">Vertragsende:</label>
                        <input type="date" id="vertragsende" name="vertragsende">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="provision">Provision (%):</label>
                        <input type="number" id="provision" name="provision" min="0" max="100" step="0.1" placeholder="0.0">
                    </div>
                    <div class="form-group">
                        <label for="rabatt">Rabatt (%):</label>
                        <input type="number" id="rabatt" name="rabatt" min="0" max="100" step="0.1" placeholder="0.0">
                    </div>
                </div>

                <h3>Zertifizierungen & Kompetenzen</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Zertifizierung</th>
                            <th>Level</th>
                            <th>G√ºltig bis</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="zertifizierungen-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Zertifizierung eingeben"></td>
                            <td>
                                <select>
                                    <option value="basic">Basic</option>
                                    <option value="advanced">Advanced</option>
                                    <option value="expert">Expert</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="abgelaufen">Abgelaufen</option>
                                    <option value="in-erneuerung">In Erneuerung</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addZertifizierung()">+ Zertifizierung hinzuf√ºgen</button>
            </div>
        </div>

        <div id="service" class="tab-content">
            <div class="section">
                <h2>Service Management</h2>
                
                <h3>Service-Portfolio</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Kategorie</th>
                            <th>SLA Level</th>
                            <th>Preis</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="services-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Service-Name"></td>
                            <td>
                                <select>
                                    <option value="support">Support</option>
                                    <option value="implementation">Implementation</option>
                                    <option value="consulting">Consulting</option>
                                    <option value="training">Training</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </td>
                            <td>
                                <select>
                                    <option value="bronze">Bronze</option>
                                    <option value="silver">Silver</option>
                                    <option value="gold">Gold</option>
                                    <option value="platinum">Platinum</option>
                                </select>
                            </td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="inaktiv">Inaktiv</option>
                                    <option value="entwicklung">In Entwicklung</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addService()">+ Service hinzuf√ºgen</button>

                <h3>Service Level Agreements (SLA)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="response-time">Reaktionszeit (Std):</label>
                        <input type="number" id="response-time" name="response-time" min="0" step="0.5" placeholder="24">
                    </div>
                    <div class="form-group">
                        <label for="resolution-time">L√∂sungszeit (Std):</label>
                        <input type="number" id="resolution-time" name="resolution-time" min="0" step="0.5" placeholder="72">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="availability">Verf√ºgbarkeit (%):</label>
                        <input type="number" id="availability" name="availability" min="0" max="100" step="0.1" placeholder="99.9">
                    </div>
                    <div class="form-group">
                        <label for="support-hours">Support-Zeiten:</label>
                        <select id="support-hours" name="support-hours">
                            <option value="8x5">8x5 (Gesch√§ftszeiten)</option>
                            <option value="12x5">12x5 (Erweiterte Gesch√§ftszeiten)</option>
                            <option value="24x7">24x7 (Rund um die Uhr)</option>
                        </select>
                    </div>
                </div>

                <h3>Ticket Management</h3>
                <div class="status-indicators">
                    <div class="metric-card">
                        <h4 id="open-tickets">24</h4>
                        <p>Offene Tickets</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="avg-response">2.3h</h4>
                        <p>√ò Reaktionszeit</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="satisfaction">4.7</h4>
                        <p>Kundenzufriedenheit</p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="ticket-system">Ticket-System Integration:</label>
                    <div class="integration-box">
                        <h4>Verf√ºgbare Integrationen</h4>
                        <div class="form-row">
                            <label><input type="checkbox" name="integrations" value="jira"> Jira Service Desk</label>
                            <label><input type="checkbox" name="integrations" value="servicenow"> ServiceNow</label>
                            <label><input type="checkbox" name="integrations" value="zendesk"> Zendesk</label>
                            <label><input type="checkbox" name="integrations" value="freshdesk"> Freshdesk</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="sales" class="tab-content">
            <div class="section">
                <h2>Vertrieb & Sales</h2>
                <h3>Sales Pipeline</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Opportunity</th>
                            <th>Kunde</th>
                            <th>Wert (‚Ç¨)</th>
                            <th>Stage</th>
                            <th>Wahrscheinlichkeit</th>
                            <th>Abschluss erwartet</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="opportunities-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Opportunity Name"></td>
                            <td><input type="text" placeholder="Kunde"></td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="lead">Lead</option>
                                    <option value="qualified">Qualified</option>
                                    <option value="proposal">Proposal</option>
                                    <option value="negotiation">Negotiation</option>
                                    <option value="closed-won">Closed Won</option>
                                    <option value="closed-lost">Closed Lost</option>
                                </select>
                            </td>
                            <td><input type="number" min="0" max="100" placeholder="%"></td>
                            <td><input type="date"></td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addOpportunity()">+ Opportunity hinzuf√ºgen</button>
                <h3>Sales Metriken</h3>
                <div class="status-indicators">
                    <div class="status-card">
                        <h4>Pipeline Wert</h4>
                        <input type="number" id="pipeline-value" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                    <div class="status-card">
                        <h4>Conversion Rate</h4>
                        <input type="number" id="conversion-rate" placeholder="0.0%" step="0.1">
                    </div>
                    <div class="status-card">
                        <h4>Durchschnittlicher Deal Wert</h4>
                        <input type="number" id="avg-deal-value" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                </div>

                <h3>Marketing Kampagnen</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Kampagnenname</th>
                            <th>Typ</th>
                            <th>Startdatum</th>
                            <th>Enddatum</th>
                            <th>Budget (‚Ç¨)</th>
                            <th>Status</th>
                            <th>Leads</th>
                            <th>Konversionen</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="campaigns-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Kampagnenname"></td>
                            <td>
                                <select>
                                    <option value="email">E-Mail</option>
                                    <option value="social-media">Social Media</option>
                                    <option value="webinar">Webinar</option>
                                    <option value="event">Event</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td><input type="date"></td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="planned">Planned</option>
                                    <option value="active">Active</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </td>
                            <td><input type="number" placeholder="0"></td>
                            <td><input type="number" placeholder="0"></td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addCampaign()">+ Kampagne hinzuf√ºgen</button>
            </div>
        </div>

        <div id="marketing" class="tab-content">
            <div class="section">
                <h2>Marketing & Kommunikation</h2>
                <h3>Inhalt & Materialien</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Titel</th>
                            <th>Typ</th>
                            <th>Erstellungsdatum</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="content-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Titel des Inhalts"></td>
                            <td>
                                <select>
                                    <option value="blog">Blog Post</option>
                                    <option value="whitepaper">Whitepaper</option>
                                    <option value="case-study">Case Study</option>
                                    <option value="video">Video</option>
                                    <option value="infographic">Infographic</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="draft">Draft</option>
                                    <option value="published">Published</option>
                                    <option value="archived">Archived</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addContent()">+ Inhalt hinzuf√ºgen</button>
                <h3>Kommunikationskan√§le</h3>
                <div class="form-group">
                    <label for="social-media-links">Social Media Links:</label>
                    <textarea id="social-media-links" placeholder="LinkedIn, Twitter, Facebook, etc."></textarea>
                </div>
                <div class="form-group">
                    <label for="newsletter-frequency">Newsletter Frequenz:</label>
                    <select id="newsletter-frequency">
                        <option value="weekly">W√∂chentlich</option>
                        <option value="bi-weekly">Zweiw√∂chentlich</option>
                        <option value="monthly">Monatlich</option>
                        <option value="quarterly">Quartalsweise</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="event-calendar">Event Kalender Integration:</label>
                    <input type="text" id="event-calendar" placeholder="Link zu externem Event Kalender">
                </div>
            </div>
        </div>

        <div id="reporting" class="tab-content">
            <div class="section">
                <h2>Reporting & Analyse</h2>
                <h3>Leistungsindikatoren (KPIs)</h3>
                <div class="status-indicators">
                    <div class="metric-card">
                        <h4>Umsatz mit Partnern</h4>
                        <input type="number" id="partner-revenue" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                    <div class="metric-card">
                        <h4>Neue Partner</h4>
                        <input type="number" id="new-partners" placeholder="0">
                    </div>
                    <div class="metric-card">
                        <h4>Partner-Aktivit√§t</h4>
                        <input type="number" id="partner-activity" placeholder="0">
                    </div>
                </div>

                <h3>Finanzberichte</h3>
                <div class="form-group">
                    <label for="current-costs">Aktuelle Kosten (‚Ç¨):</label>
                    <input type="number" id="current-costs" placeholder="0,00" step="0.01">
                </div>
                <div class="form-group">
                    <label for="cost-deviation">Kostenabweichung (‚Ç¨):</label>
                    <input type="number" id="cost-deviation" placeholder="0,00" step="0.01">
                </div>

                <h3>Meilensteine & Arbeitspakete</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Arbeitspaket/Meilenstein</th>
                            <th>Verantwortlich</th>
                            <th>Geplantes Ende</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="milestones-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Bezeichnung"></td>
                            <td><input type="text" placeholder="Name"></td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="open">Offen</option>
                                    <option value="in-progress">In Arbeit</option>
                                    <option value="completed">Abgeschlossen</option>
                                    <option value="delayed">Verz√∂gert</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addMilestone()">+ Meilenstein/Arbeitspaket hinzuf√ºgen</button>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn" onclick="saveAsStaticHtml()">Dokument speichern</button>
            <button class="btn" onclick="exportHandover()">√úbergabe-Paket Export</button>
        </div>
    </div>

    <script>
        // Set initial document version and date
        let documentVersion = "1.0";
        let documentDate = new Date().toLocaleDateString('de-DE');
        document.getElementById('documentInfo').textContent = `Version: ${documentVersion} | Datum: ${documentDate}`;

        // Tab functionality
        function showTab(tabId, event) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');

            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // Functions to add rows to tables
        function addZertifizierung() {
            const tbody = document.getElementById('zertifizierungen-tbody');
            const newRow = document.createElement('tr');
            newRow.classList.add('data-row');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Zertifizierung eingeben"></td>
                <td>
                    <select>
                        <option value="basic">Basic</option>
                        <option value="advanced">Advanced</option>
                        <option value="expert">Expert</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td>
                    <select>
                        <option value="aktiv">Aktiv</option>
                        <option value="abgelaufen">Abgelaufen</option>
                        <option value="in-erneuerung">In Erneuerung</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addService() {
            const tbody = document.getElementById('services-tbody');
            const newRow = document.createElement('tr');
            newRow.classList.add('data-row');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Service-Name"></td>
                <td>
                    <select>
                        <option value="support">Support</option>
                        <option value="implementation">Implementation</option>
                        <option value="consulting">Consulting</option>
                        <option value="training">Training</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option value="bronze">Bronze</option>
                        <option value="silver">Silver</option>
                        <option value="gold">Gold</option>
                        <option value="platinum">Platinum</option>
                    </select>
                </td>
                <td><input type="number" placeholder="‚Ç¨"></td>
                <td>
                    <select>
                        <option value="aktiv">Aktiv</option>
                        <option value="inaktiv">Inaktiv</option>
                        <option value="entwicklung">In Entwicklung</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addOpportunity() {
            const tbody = document.getElementById('opportunities-tbody');
            const newRow = document.createElement('tr');
            newRow.classList.add('data-row');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Opportunity Name"></td>
                <td><input type="text" placeholder="Kunde"></td>
                <td><input type="number" placeholder="‚Ç¨"></td>
                <td>
                    <select>
                        <option value="lead">Lead</option>
                        <option value="qualified">Qualified</option>
                        <option value="proposal">Proposal</option>
                        <option value="negotiation">Negotiation</option>
                        <option value="closed-won">Closed Won</option>
                        <option value="closed-lost">Closed Lost</option>
                    </select>
                </td>
                <td><input type="number" min="0" max="100" placeholder="%"></td>
                <td><input type="date"></td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addCampaign() {
            const tbody = document.getElementById('campaigns-tbody');
            const newRow = document.createElement('tr');
            newRow.classList.add('data-row');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Kampagnenname"></td>
                <td>
                    <select>
                        <option value="email">E-Mail</option>
                        <option value="social-media">Social Media</option>
                        <option value="webinar">Webinar</option>
                        <option value="event">Event</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td><input type="date"></td>
                <td><input type="number" placeholder="‚Ç¨"></td>
                <td>
                    <select>
                        <option value="planned">Planned</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                    </select>
                </td>
                <td><input type="number" placeholder="0"></td>
                <td><input type="number" placeholder="0"></td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addContent() {
            const tbody = document.getElementById('content-tbody');
            const newRow = document.createElement('tr');
            newRow.classList.add('data-row');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Titel des Inhalts"></td>
                <td>
                    <select>
                        <option value="blog">Blog Post</option>
                        <option value="whitepaper">Whitepaper</option>
                        <option value="case-study">Case Study</option>
                        <option value="video">Video</option>
                        <option value="infographic">Infographic</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td>
                    <select>
                        <option value="draft">Draft</option>
                        <option value="published">Published</option>
                        <option value="archived">Archived</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addMilestone() {
            const tbody = document.getElementById('milestones-tbody');
            const newRow = document.createElement('tr');
            newRow.classList.add('data-row');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Bezeichnung"></td>
                <td><input type="text" placeholder="Name"></td>
                <td><input type="date"></td>
                <td>
                    <select>
                        <option value="open">Offen</option>
                        <option value="in-progress">In Arbeit</option>
                        <option value="completed">Abgeschlossen</option>
                        <option value="delayed">Verz√∂gert</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function deleteRow(button) {
            button.closest('.data-row').remove();
        }

        function escapeHtml(text) {
            var map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }


        // Function to save the current form data as a static HTML file for documentation
        function saveAsStaticHtml() {
            const today = new Date();
            const yyyy = today.getFullYear();
            let mm = today.getMonth() + 1; // Months start at 0!
            let dd = today.getDate();

            if (dd < 10) dd = '0' + dd;
            if (mm < 10) mm = '0' + mm;

            const formattedToday = dd + '.' + mm + '.' + yyyy;

            // Project Tab Data
            const projektname = document.getElementById('projektname') ? escapeHtml(document.getElementById('projektname').value) : '';
            const projektId = document.getElementById('projekt-id') ? escapeHtml(document.getElementById('projekt-id').value) : '';
            const projektleiter = document.getElementById('projektleiter') ? escapeHtml(document.getElementById('projektleiter').value) : '';
            const projektstatus = document.getElementById('projektstatus') ? escapeHtml(document.getElementById('projektstatus').value) : '';
            const startDatum = document.getElementById('start-datum') ? escapeHtml(document.getElementById('start-datum').value) : '';
            const endDatum = document.getElementById('end-datum') ? escapeHtml(document.getElementById('end-datum').value) : '';
            const budget = document.getElementById('budget') ? escapeHtml(document.getElementById('budget').value) : '';
            const projektziel = document.getElementById('projektziel') ? escapeHtml(document.getElementById('projektziel').value).replace(/\n/g, '<br>') : '';
            const projektbeschreibung = document.getElementById('projektbeschreibung') ? escapeHtml(document.getElementById('projektbeschreibung').value).replace(/\n/g, '<br>') : '';

            // Partner Tab Data
            const partnerName = document.getElementById('partner-name') ? escapeHtml(document.getElementById('partner-name').value) : '';
            const partnerTyp = document.getElementById('partner-typ') ? escapeHtml(document.getElementById('partner-typ').value) : '';
            const partnerTier = document.getElementById('partner-tier') ? escapeHtml(document.getElementById('partner-tier').value) : '';
            const partnerStatus = document.getElementById('partner-status') ? escapeHtml(document.getElementById('partner-status').value) : '';
            const partnerAnsprechpartner = document.getElementById('partner-ansprechpartner') ? escapeHtml(document.getElementById('partner-ansprechpartner').value) : '';
            const partnerEmail = document.getElementById('partner-email') ? escapeHtml(document.getElementById('partner-email').value) : '';
            const partnerTelefon = document.getElementById('partner-telefon') ? escapeHtml(document.getElementById('partner-telefon').value) : '';
            const partnerWebsite = document.getElementById('partner-website') ? escapeHtml(document.getElementById('partner-website').value) : '';
            const vertragsstart = document.getElementById('vertragsstart') ? escapeHtml(document.getElementById('vertragsstart').value) : '';
            const vertragsende = document.getElementById('vertragsende') ? escapeHtml(document.getElementById('vertragsende').value) : '';
            const provision = document.getElementById('provision') ? escapeHtml(document.getElementById('provision').value) : '';
            const rabatt = document.getElementById('rabatt') ? escapeHtml(document.getElementById('rabatt').value) : '';

            const zertifizierungenTable = Array.from(document.querySelectorAll('#zertifizierungen-tbody tr')).map(row => {
                const cert = escapeHtml(row.cells[0].querySelector('input').value);
                const level = escapeHtml(row.cells[1].querySelector('select').value);
                const validUntil = escapeHtml(row.cells[2].querySelector('input').value);
                const status = escapeHtml(row.cells[3].querySelector('select').value);
                return `<tr><td>${cert}</td><td>${level}</td><td>${validUntil}</td><td>${status}</td></tr>`;
            }).join('');
            const finalZertifizierungenTable = zertifizierungenTable ? `
                <table class="output-table">
                    <thead><tr><th>Zertifizierung</th><th>Level</th><th>G√ºltig bis</th><th>Status</th></tr></thead>
                    <tbody>${zertifizierungenTable}</tbody>
                </table>
            ` : '<p>Keine Zertifizierungen eingetragen.</p>';

            // Service Tab Data
            const servicesTable = Array.from(document.querySelectorAll('#services-tbody tr')).map(row => {
                const service = escapeHtml(row.cells[0].querySelector('input').value);
                const category = escapeHtml(row.cells[1].querySelector('select').value);
                const slaLevel = escapeHtml(row.cells[2].querySelector('select').value);
                const price = escapeHtml(row.cells[3].querySelector('input').value);
                const status = escapeHtml(row.cells[4].querySelector('select').value);
                return `<tr><td>${service}</td><td>${category}</td><td>${slaLevel}</td><td>${price}</td><td>${status}</td></tr>`;
            }).join('');
            const finalServicesTable = servicesTable ? `
                <table class="output-table">
                    <thead><tr><th>Service</th><th>Kategorie</th><th>SLA Level</th><th>Preis</th><th>Status</th></tr></thead>
                    <tbody>${servicesTable}</tbody>
                </table>
            ` : '<p>Keine Services eingetragen.</p>';

            const responseTime = document.getElementById('response-time') ? escapeHtml(document.getElementById('response-time').value) : '';
            const resolutionTime = document.getElementById('resolution-time') ? escapeHtml(document.getElementById('resolution-time').value) : '';
            const availability = document.getElementById('availability') ? escapeHtml(document.getElementById('availability').value) : '';
            const supportHours = document.getElementById('support-hours') ? escapeHtml(document.getElementById('support-hours').value) : '';
            const openTickets = document.getElementById('open-tickets') ? escapeHtml(document.getElementById('open-tickets').textContent) : '';
            const avgResponse = document.getElementById('avg-response') ? escapeHtml(document.getElementById('avg-response').textContent) : '';
            const satisfaction = document.getElementById('satisfaction') ? escapeHtml(document.getElementById('satisfaction').textContent) : '';
            const integrations = Array.from(document.querySelectorAll('input[name="integrations"]:checked')).map(cb => escapeHtml(cb.value)).join(', ');

            // Sales Tab Data
            const opportunitiesTable = Array.from(document.querySelectorAll('#opportunities-tbody tr')).map(row => {
                const opportunity = escapeHtml(row.cells[0].querySelector('input').value);
                const customer = escapeHtml(row.cells[1].querySelector('input').value);
                const value = escapeHtml(row.cells[2].querySelector('input').value);
                const stage = escapeHtml(row.cells[3].querySelector('select').value);
                const probability = escapeHtml(row.cells[4].querySelector('input').value);
                const expectedClose = escapeHtml(row.cells[5].querySelector('input').value);
                return `<tr><td>${opportunity}</td><td>${customer}</td><td>${value}</td><td>${stage}</td><td>${probability}</td><td>${expectedClose}</td></tr>`;
            }).join('');
            const finalOpportunitiesTable = opportunitiesTable ? `
                <table class="output-table">
                    <thead><tr><th>Opportunity</th><th>Kunde</th><th>Wert (‚Ç¨)</th><th>Stage</th><th>Wahrscheinlichkeit</th><th>Abschluss erwartet</th></tr></thead>
                    <tbody>${opportunitiesTable}</tbody>
                </table>
            ` : '<p>Keine Opportunities eingetragen.</p>';

            const pipelineValue = document.getElementById('pipeline-value') ? escapeHtml(document.getElementById('pipeline-value').value) : '';
            const conversionRate = document.getElementById('conversion-rate') ? escapeHtml(document.getElementById('conversion-rate').value) : '';
            const avgDealValue = document.getElementById('avg-deal-value') ? escapeHtml(document.getElementById('avg-deal-value').value) : '';

            const campaignsTable = Array.from(document.querySelectorAll('#campaigns-tbody tr')).map(row => {
                const campaignName = escapeHtml(row.cells[0].querySelector('input').value);
                const type = escapeHtml(row.cells[1].querySelector('select').value);
                const startDate = escapeHtml(row.cells[2].querySelector('input').value);
                const endDate = escapeHtml(row.cells[3].querySelector('input').value);
                const budget = escapeHtml(row.cells[4].querySelector('input').value);
                const status = escapeHtml(row.cells[5].querySelector('select').value);
                const leads = escapeHtml(row.cells[6].querySelector('input').value);
                const conversions = escapeHtml(row.cells[7].querySelector('input').value);
                return `<tr><td>${campaignName}</td><td>${type}</td><td>${startDate}</td><td>${endDate}</td><td>${budget}</td><td>${status}</td><td>${leads}</td><td>${conversions}</td></tr>`;
            }).join('');
            const finalCampaignsTable = campaignsTable ? `
                <table class="output-table">
                    <thead><tr><th>Kampagnenname</th><th>Typ</th><th>Startdatum</th><th>Enddatum</th><th>Budget (‚Ç¨)</th><th>Status</th><th>Leads</th><th>Konversionen</th></tr></thead>
                    <tbody>${campaignsTable}</tbody>
                </table>
            ` : '<p>Keine Kampagnen eingetragen.</p>';

            // Marketing Tab Data
            const contentTable = Array.from(document.querySelectorAll('#content-tbody tr')).map(row => {
                const title = escapeHtml(row.cells[0].querySelector('input').value);
                const type = escapeHtml(row.cells[1].querySelector('select').value);
                const creationDate = escapeHtml(row.cells[2].querySelector('input').value);
                const status = escapeHtml(row.cells[3].querySelector('select').value);
                return `<tr><td>${title}</td><td>${type}</td><td>${creationDate}</td><td>${status}</td></tr>`;
            }).join('');
            const finalContentTable = contentTable ? `
                <table class="output-table">
                    <thead><tr><th>Titel</th><th>Typ</th><th>Erstellungsdatum</th><th>Status</th></tr></thead>
                    <tbody>${contentTable}</tbody>
                </table>
            ` : '<p>Keine Inhalte eingetragen.</p>';

            const socialMediaLinks = document.getElementById('social-media-links') ? escapeHtml(document.getElementById('social-media-links').value).replace(/\n/g, '<br>') : '';
            const newsletterFrequency = document.getElementById('newsletter-frequency') ? escapeHtml(document.getElementById('newsletter-frequency').value) : '';
            const eventCalendar = document.getElementById('event-calendar') ? escapeHtml(document.getElementById('event-calendar').value) : '';

            // Reporting Tab Data
            const partnerRevenue = document.getElementById('partner-revenue') ? escapeHtml(document.getElementById('partner-revenue').value) : '';
            const newPartners = document.getElementById('new-partners') ? escapeHtml(document.getElementById('new-partners').value) : '';
            const partnerActivity = document.getElementById('partner-activity') ? escapeHtml(document.getElementById('partner-activity').value) : '';
            const currentCosts = document.getElementById('current-costs') ? escapeHtml(document.getElementById('current-costs').value) : '';
            const costDeviation = document.getElementById('cost-deviation') ? escapeHtml(document.getElementById('cost-deviation').value) : '';

            const milestonesTable = Array.from(document.querySelectorAll('#milestones-tbody tr')).map(row => {
                const milestone = escapeHtml(row.cells[0].querySelector('input').value);
                const responsible = escapeHtml(row.cells[1].querySelector('input').value);
                const plannedEnd = escapeHtml(row.cells[2].querySelector('input').value);
                const status = escapeHtml(row.cells[3].querySelector('select').value);
                return `<tr><td>${milestone}</td><td>${responsible}</td><td>${plannedEnd}</td><td>${status}</td></tr>`;
            }).join('');
            const finalMilestonesTable = milestonesTable ? `
                <table class="output-table">
                    <thead><tr><th>Arbeitspaket/Meilenstein</th><th>Verantwortlich</th><th>Geplantes Ende</th><th>Status</th></tr></thead>
                    <tbody>${milestonesTable}</tbody>
                </table>
            ` : '<p>Keine Meilensteine/Arbeitspakete eingetragen.</p>';


            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Partner Relationship Management Dokumentation - ${projektname}</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 20px; background-color: #f4f4f4; }
                        .document-container { max-width: 900px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
                        .header-export { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #007bff; padding-bottom: 15px; }
                        .header-export h1 { color: #007bff; margin: 0; font-size: 2em; }
                        .header-export p { color: #555; font-size: 1.1em; }
                        .section-export { margin-bottom: 25px; border: 1px solid #e1e1e1; border-radius: 5px; padding: 20px; background-color: #f9f9f9; }
                        .section-export h2 { color: #007bff; border-bottom: 1px solid #007bff; padding-bottom: 10px; margin-top: 0; margin-bottom: 15px; font-size: 1.5em; }
                        .section-export h3 { color: #555; margin-top: 20px; margin-bottom: 10px; font-size: 1.2em; }
                        .data-row-export { display: flex; margin-bottom: 8px; }
                        .data-label-export { font-weight: bold; margin-right: 10px; color: #333; flex-shrink: 0; width: 200px; }
                        .data-value-export { flex-grow: 1; color: #666; }
                        .output-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
                        .output-table th, .output-table td { border: 1px solid #ddd; padding: 10px; text-align: left; }
                        .output-table th { background-color: #e9ecef; font-weight: bold; color: #333; }
                        .document-info-export { text-align: right; font-size: 0.9em; color: #777; margin-top: 20px; }
                        .metric-card-export {
                            background-color: #fff;
                            border: 1px solid #ddd;
                            border-radius: 5px;
                            padding: 15px;
                            margin-bottom: 15px;
                            text-align: center;
                            display: inline-block;
                            width: 30%;
                            margin-right: 2%;
                            box-sizing: border-box;
                        }
                        .metric-card-export h4 { margin: 0 0 5px 0; color: #007bff; font-size: 1.8em; }
                        .metric-card-export p { margin: 0; color: #666; font-size: 0.9em; }
                    </style>
                </head>
                <body>
                    <div class="document-container">
                        <div class="header-export">
                            <h1>Partner Relationship Management System</h1>
                            <p>Dokumentation</p>
                            <div class="document-info-export">Version: ${documentVersion} | Datum: ${formattedToday}</div>
                        </div>

                        <div class="section-export">
                            <h2>Projektinitiierung</h2>
                            <h3>Projektgrundlagen</h3>
                            <div class="data-row-export"><span class="data-label-export">Projektname:</span><span class="data-value-export">${projektname}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projekt-ID:</span><span class="data-value-export">${projektId}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projektleiter:</span><span class="data-value-export">${projektleiter}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projektstatus:</span><span class="data-value-export">${projektstatus}</span></div>

                            <h3>Zeitplan & Budget</h3>
                            <div class="data-row-export"><span class="data-label-export">Startdatum:</span><span class="data-value-export">${startDatum}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Enddatum:</span><span class="data-value-export">${endDatum}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Budget (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${budget}</span></div>

                            <h3>Projektziel & Beschreibung</h3>
                            <div class="data-row-export"><span class="data-label-export">Projektziel:</span><span class="data-value-export">${projektziel}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Detaillierte Projektbeschreibung:</span><span class="data-value-export">${projektbeschreibung}</span></div>
                        </div>

                        <div class="section-export">
                            <h2>Partner Management</h2>
                            <h3>Partner-Stammdaten</h3>
                            <div class="data-row-export"><span class="data-label-export">Partner Name:</span><span class="data-value-export">${partnerName}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Typ:</span><span class="data-value-export">${partnerTyp}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Tier:</span><span class="data-value-export">${partnerTier}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Status:</span><span class="data-value-export">${partnerStatus}</span></div>

                            <h3>Kontaktdaten</h3>
                            <div class="data-row-export"><span class="data-label-export">Hauptansprechpartner:</span><span class="data-value-export">${partnerAnsprechpartner}</span></div>
                            <div class="data-row-export"><span class="data-label-export">E-Mail:</span><span class="data-value-export">${partnerEmail}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Telefon:</span><span class="data-value-export">${partnerTelefon}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Website:</span><span class="data-value-export">${partnerWebsite}</span></div>

                            <h3>Vertragsdaten</h3>
                            <div class="data-row-export"><span class="data-label-export">Vertragsbeginn:</span><span class="data-value-export">${vertragsstart}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Vertragsende:</span><span class="data-value-export">${vertragsende}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Provision (%):</span><span class="data-value-export">${provision}%</span></div>
                            <div class="data-row-export"><span class="data-label-export">Rabatt (%):</span><span class="data-value-export">${rabatt}%</span></div>

                            <h3>Zertifizierungen & Kompetenzen</h3>
                            ${finalZertifizierungenTable}
                        </div>

                        <div class="section-export">
                            <h2>Service Management</h2>
                            <h3>Service-Portfolio</h3>
                            ${finalServicesTable}

                            <h3>Service Level Agreements (SLA)</h3>
                            <div class="data-row-export"><span class="data-label-export">Reaktionszeit (Std):</span><span class="data-value-export">${responseTime}</span></div>
                            <div class="data-row-export"><span class="data-label-export">L√∂sungszeit (Std):</span><span class="data-value-export">${resolutionTime}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Verf√ºgbarkeit (%):</span><span class="data-value-export">${availability}%</span></div>
                            <div class="data-row-export"><span class="data-label-export">Support-Zeiten:</span><span class="data-value-export">${supportHours}</span></div>

                            <h3>Ticket Management</h3>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                                <div class="metric-card-export"><h4>${openTickets}</h4><p>Offene Tickets</p></div>
                                <div class="metric-card-export"><h4>${avgResponse}</h4><p>√ò Reaktionszeit</p></div>
                                <div class="metric-card-export"><h4>${satisfaction}</h4><p>Kundenzufriedenheit</p></div>
                            </div>
                            <div class="data-row-export"><span class="data-label-export">Ticket-System Integrationen:</span><span class="data-value-export">${integrations}</span></div>
                        </div>

                        <div class="section-export">
                            <h2>Vertrieb & Sales</h2>
                            <h3>Sales Pipeline</h3>
                            ${finalOpportunitiesTable}

                            <h3>Sales Metriken</h3>
                            <div class="data-row-export"><span class="data-label-export">Pipeline Wert:</span><span class="data-value-export">‚Ç¨ ${pipelineValue}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Conversion Rate:</span><span class="data-value-export">${conversionRate}%</span></div>
                            <div class="data-row-export"><span class="data-label-export">Durchschnittlicher Deal Wert:</span><span class="data-value-export">‚Ç¨ ${avgDealValue}</span></div>

                            <h3>Marketing Kampagnen</h3>
                            ${finalCampaignsTable}
                        </div>

                        <div class="section-export">
                            <h2>Marketing & Kommunikation</h2>
                            <h3>Inhalt & Materialien</h3>
                            ${finalContentTable}

                            <h3>Kommunikationskan√§le</h3>
                            <div class="data-row-export"><span class="data-label-export">Social Media Links:</span><span class="data-value-export">${socialMediaLinks}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Newsletter Frequenz:</span><span class="data-value-export">${newsletterFrequency}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Event Kalender Integration:</span><span class="data-value-export">${eventCalendar}</span></div>
                        </div>

                        <div class="section-export">
                            <h2>Reporting & Analyse</h2>
                            <h3>Leistungsindikatoren (KPIs)</h3>
                            <div class="data-row-export"><span class="data-label-export">Umsatz mit Partnern (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${partnerRevenue}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Neue Partner:</span><span class="data-value-export">${newPartners}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Aktivit√§t:</span><span class="data-value-export">${partnerActivity}</span></div>
                            <h3>Finanzberichte</h3>
                            <div class="data-row-export"><span class="data-label-export">Aktuelle Kosten (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${currentCosts}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Kostenabweichung (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${costDeviation}</span></div>
                            <h3>Meilensteine & Arbeitspakete</h3>
                            ${finalMilestonesTable}
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'PartnerRelationshipManagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation f√ºr Partner Relationship Management erstellt!');
        }

    </script>
</body>
</html>