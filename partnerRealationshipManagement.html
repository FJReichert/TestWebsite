<!DOCTYPE html>
<html lang="de">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenProject - Partner Relationship Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>OpenProject PRM</h1>
            <p>Partner Relationship Management System</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('project', event)">üìã Projekt</button>
            <button class="nav-tab" onclick="showTab('partner', event)">ü§ù Partner</button>
            <button class="nav-tab" onclick="showTab('service', event)">‚öôÔ∏è Service</button>
            <button class="nav-tab" onclick="showTab('sales', event)">üíº Vertrieb</button>
            <button class="nav-tab" onclick="showTab('marketing', event)">üì¢ Marketing</button>
            <button class="nav-tab" onclick="showTab('reporting', event)">üìä Reporting</button>
        </div>

        <div id="project" class="tab-content active">
            <div class="section">
                <h2>Projektinitiierung</h2>
                
                <h3>Projektgrundlagen</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="projektname">Projektname:</label>
                        <input type="text" id="projektname" name="projektname" placeholder="Projektbezeichnung eingeben">
                    </div>
                    <div class="form-group">
                        <label for="projekt-id">Projekt-ID:</label>
                        <input type="text" id="projekt-id" name="projekt-id" placeholder="Interne Kennung">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projektleiter">Projektleiter:</label>
                        <input type="text" id="projektleiter" name="projektleiter" placeholder="Name des Verantwortlichen">
                    </div>
                    <div class="form-group">
                        <label for="projektstatus">Projektstatus:</label>
                        <select id="projektstatus" name="projektstatus">
                            <option value="">Status ausw√§hlen</option>
                            <option value="geplant">Geplant</option>
                            <option value="laufend">Laufend</option>
                            <option value="pausiert">Pausiert</option>
                            <option value="abgeschlossen">Abgeschlossen</option>
                        </select>
                    </div>
                </div>

                <h3>Zeitplan & Budget</h3>
                <div class="form-row-triple">
                    <div class="form-group">
                        <label for="start-datum">Startdatum:</label>
                        <input type="date" id="start-datum" name="start-datum">
                    </div>
                    <div class="form-group">
                        <label for="end-datum">Enddatum:</label>
                        <input type="date" id="end-datum" name="end-datum">
                    </div>
                    <div class="form-group">
                        <label for="budget">Budget (‚Ç¨):</label>
                        <input type="number" id="budget" name="budget" placeholder="0,00" step="0.01">
                    </div>
                </div>

                <h3>Projektziel & Beschreibung</h3>
                <div class="form-group">
                    <label for="projektziel">Projektziel:</label>
                    <textarea id="projektziel" name="projektziel" placeholder="Hauptziele und erwartete Ergebnisse des Projekts beschreiben..." class="textarea-large"></textarea>
                </div>

                <div class="form-group">
                    <label for="projektbeschreibung">Detaillierte Projektbeschreibung:</label>
                    <textarea id="projektbeschreibung" name="projektbeschreibung" placeholder="Umfassende Beschreibung des Projektumfangs, der Anforderungen und Deliverables..." class="textarea-large"></textarea>
                </div>
            </div>
        </div>

        <div id="partner" class="tab-content">
            <div class="section">
                <h2>Partner Management</h2>
                
                <h3>Partner-Stammdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-name">Partner Name:</label>
                        <input type="text" id="partner-name" name="partner-name" placeholder="Offizieller Partnername">
                    </div>
                    <div class="form-group">
                        <label for="partner-typ">Partner-Typ:</label>
                        <select id="partner-typ" name="partner-typ">
                            <option value="">Typ ausw√§hlen</option>
                            <option value="reseller">Reseller</option>
                            <option value="distributor">Distributor</option>
                            <option value="system-integrator">System Integrator</option>
                            <option value="technology-partner">Technology Partner</option>
                            <option value="service-partner">Service Partner</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-tier">Partner-Tier:</label>
                        <select id="partner-tier" name="partner-tier">
                            <option value="">Tier ausw√§hlen</option>
                            <option value="gold">Gold Partner</option>
                            <option value="silver">Silver Partner</option>
                            <option value="bronze">Bronze Partner</option>
                            <option value="standard">Standard Partner</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="partner-status">Partner-Status:</label>
                        <select id="partner-status" name="partner-status">
                            <option value="">Status ausw√§hlen</option>
                            <option value="aktiv">Aktiv</option>
                            <option value="inaktiv">Inaktiv</option>
                            <option value="beendet">Beendet</option>
                            <option value="evaluierung">In Evaluierung</option>
                        </select>
                    </div>
                </div>

                <h3>Kontaktdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-ansprechpartner">Hauptansprechpartner:</label>
                        <input type="text" id="partner-ansprechpartner" name="partner-ansprechpartner" placeholder="Name & Position">
                    </div>
                    <div class="form-group">
                        <label for="partner-email">E-Mail:</label>
                        <input type="email" id="partner-email" name="partner-email" placeholder="kontakt@partner.de">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-telefon">Telefon:</label>
                        <input type="tel" id="partner-telefon" name="partner-telefon" placeholder="+49 123 456789">
                    </div>
                    <div class="form-group">
                        <label for="partner-website">Website:</label>
                        <input type="url" id="partner-website" name="partner-website" placeholder="https://www.partner.de">
                    </div>
                </div>

                <h3>Vertragsdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="vertragsstart">Vertragsbeginn:</label>
                        <input type="date" id="vertragsstart" name="vertragsstart">
                    </div>
                    <div class="form-group">
                        <label for="vertragsende">Vertragsende:</label>
                        <input type="date" id="vertragsende" name="vertragsende">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="provision">Provision (%):</label>
                        <input type="number" id="provision" name="provision" min="0" max="100" step="0.1" placeholder="0.0">
                    </div>
                    <div class="form-group">
                        <label for="rabatt">Rabatt (%):</label>
                        <input type="number" id="rabatt" name="rabatt" min="0" max="100" step="0.1" placeholder="0.0">
                    </div>
                </div>

                <h3>Zertifizierungen & Kompetenzen</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Zertifizierung</th>
                            <th>Level</th>
                            <th>G√ºltig bis</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="zertifizierungen-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Zertifizierung eingeben"></td>
                            <td>
                                <select>
                                    <option value="basic">Basic</option>
                                    <option value="advanced">Advanced</option>
                                    <option value="expert">Expert</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="abgelaufen">Abgelaufen</option>
                                    <option value="in-erneuerung">In Erneuerung</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addZertifizierung()">+ Zertifizierung hinzuf√ºgen</button>
            </div>
        </div>

        <div id="service" class="tab-content">
            <div class="section">
                <h2>Service Management</h2>
                
                <h3>Service-Portfolio</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Kategorie</th>
                            <th>SLA Level</th>
                            <th>Preis</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="services-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Service-Name"></td>
                            <td>
                                <select>
                                    <option value="support">Support</option>
                                    <option value="implementation">Implementation</option>
                                    <option value="consulting">Consulting</option>
                                    <option value="training">Training</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </td>
                            <td>
                                <select>
                                    <option value="bronze">Bronze</option>
                                    <option value="silver">Silver</option>
                                    <option value="gold">Gold</option>
                                    <option value="platinum">Platinum</option>
                                </select>
                            </td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="inaktiv">Inaktiv</option>
                                    <option value="entwicklung">In Entwicklung</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addService()">+ Service hinzuf√ºgen</button>

                <h3>Service Level Agreements (SLA)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="response-time">Reaktionszeit (Std):</label>
                        <input type="number" id="response-time" name="response-time" min="0" step="0.5" placeholder="24">
                    </div>
                    <div class="form-group">
                        <label for="resolution-time">L√∂sungszeit (Std):</label>
                        <input type="number" id="resolution-time" name="resolution-time" min="0" step="0.5" placeholder="72">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="availability">Verf√ºgbarkeit (%):</label>
                        <input type="number" id="availability" name="availability" min="0" max="100" step="0.1" placeholder="99.9">
                    </div>
                    <div class="form-group">
                        <label for="support-hours">Support-Zeiten:</label>
                        <select id="support-hours" name="support-hours">
                            <option value="8x5">8x5 (Gesch√§ftszeiten)</option>
                            <option value="12x5">12x5 (Erweiterte Gesch√§ftszeiten)</option>
                            <option value="24x7">24x7 (Rund um die Uhr)</option>
                        </select>
                    </div>
                </div>

                <h3>Ticket Management</h3>
                <div class="status-indicators">
                    <div class="metric-card">
                        <h4 id="open-tickets">24</h4>
                        <p>Offene Tickets</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="avg-response">2.3h</h4>
                        <p>√ò Reaktionszeit</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="satisfaction">4.7</h4>
                        <p>Kundenzufriedenheit</p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="ticket-system">Ticket-System Integration:</label>
                    <div class="integration-box">
                        <h4>Verf√ºgbare Integrationen</h4>
                        <div class="form-row">
                            <label><input type="checkbox" name="integrations" value="jira"> Jira Service Desk</label>
                            <label><input type="checkbox" name="integrations" value="servicenow"> ServiceNow</label>
                            <label><input type="checkbox" name="integrations" value="zendesk"> Zendesk</label>
                            <label><input type="checkbox" name="integrations" value="freshdesk"> Freshdesk</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="sales" class="tab-content">
            <div class="section">
                <h2>Vertrieb & Sales</h2>
                
                <h3>Sales Pipeline</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Opportunity</th>
                            <th>Kunde</th>
                            <th>Wert (‚Ç¨)</th>
                            <th>Stage</th>
                            <th>Wahrscheinlichkeit</th>
                            <th>Abschluss erwartet</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="opportunities-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Opportunity Name"></td>
                            <td><input type="text" placeholder="Kunde"></td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="lead">Lead</option>
                                    <option value="qualified">Qualified</option>
                                    <option value="proposal">Proposal</option>
                                    <option value="negotiation">Negotiation</option>
                                    <option value="closed-won">Closed Won</option>
                                    <option value="closed-lost">Closed Lost</option>
                                </select>
                            </td>
                            <td><input type="number" min="0" max="100" placeholder="%"></td>
                            <td><input type="date"></td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addOpportunity()">+ Opportunity hinzuf√ºgen</button>

                <h3>Sales Metriken</h3>
                <div class="status-indicators">
                    <div class="status-card">
                        <h4>Pipeline Wert</h4>
                        <input type="number" id="pipeline-value" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                    <div class="status-card">
                        <h4>Conversion Rate</h4>
                        <input type="number" id="conversion-rate" placeholder="%" min="0" max="100" step="0.1">
                    </div>
                    <div class="status-card">
                        <h4>Durchschnittlicher Deal</h4>
                        <input type="number" id="avg-deal" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                </div>

                <h3>Lead Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="lead-source">Lead-Quelle:</label>
                        <select id="lead-source" name="lead-source">
                            <option value="">Quelle ausw√§hlen</option>
                            <option value="website">Website</option>
                            <option value="referral">Empfehlung</option>
                            <option value="partner">Partner</option>
                            <option value="event">Event/Messe</option>
                            <option value="cold-call">Cold Call</option>
                            <option value="marketing">Marketing Kampagne</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lead-scoring">Lead Score:</label>
                        <input type="number" id="lead-scoring" name="lead-scoring" min="0" max="100" placeholder="0-100">
                    </div>
                </div>

                <h3>CRM Integration</h3>
                <div class="integration-box">
                    <h4>CRM System Verbindung</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="crm-system">CRM System:</label>
                            <select id="crm-system" name="crm-system">
                                <option value="">System ausw√§hlen</option>
                                <option value="salesforce">Salesforce</option>
                                <option value="hubspot">HubSpot</option>
                                <option value="pipedrive">Pipedrive</option>
                                <option value="dynamics">Microsoft Dynamics</option>
                                <option value="custom">Custom CRM</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="sync-frequency">Sync Frequenz:</label>
                            <select id="sync-frequency" name="sync-frequency">
                                <option value="realtime">Real-time</option>
                                <option value="hourly">St√ºndlich</option>
                                <option value="daily">T√§glich</option>
                                <option value="weekly">W√∂chentlich</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="marketing" class="tab-content">
            <div class="section">
                <h2>Marketing & Kampagnen</h2>
                
                <h3>Kampagnen-Management</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Kampagne</th>
                            <th>Typ</th>
                            <th>Zielgruppe</th>
                            <th>Budget (‚Ç¨)</th>
                            <th>Start</th>
                            <th>Ende</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="campaigns-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Kampagnen-Name"></td>
                            <td>
                                <select>
                                    <option value="email">E-Mail</option>
                                    <option value="social">Social Media</option>
                                    <option value="webinar">Webinar</option>
                                    <option value="event">Event</option>
                                    <option value="content">Content Marketing</option>
                                    <option value="ppc">PPC/Ads</option>
                                </select>
                            </td>
                            <td><input type="text" placeholder="Zielgruppe"></td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td><input type="date"></td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="geplant">Geplant</option>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="pausiert">Pausiert</option>
                                    <option value="abgeschlossen">Abgeschlossen</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addCampaign()">+ Kampagne hinzuf√ºgen</button>

                <h3>Marketing Metriken</h3>
                <div class="status-indicators">
                    <div class="status-card">
                        <h4>Leads generiert</h4>
                        <input type="number" id="leads-generated" placeholder="0">
                    </div>
                    <div class="status-card">
                        <h4>Cost per Lead</h4>
                        <input type="number" id="cost-per-lead" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                    <div class="status-card">
                        <h4>ROI (%)</h4>
                        <input type="number" id="marketing-roi" placeholder="%" step="0.1">
                    </div>
                </div>

                <h3>Content Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="content-type">Content-Typ:</label>
                        <select id="content-type" name="content-type">
                            <option value="">Typ ausw√§hlen</option>
                            <option value="blog">Blog Artikel</option>
                            <option value="whitepaper">Whitepaper</option>
                            <option value="case-study">Case Study</option>
                            <option value="video">Video</option>
                            <option value="webinar">Webinar</option>
                            <option value="infographic">Infografik</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="content-status">Status:</label>
                        <select id="content-status" name="content-status">
                            <option value="planung">In Planung</option>
                            <option value="erstellung">In Erstellung</option>
                            <option value="review">Review</option>
                            <option value="published">Ver√∂ffentlicht</option>
                        </select>
                    </div>
                </div>

                <h3>Partner Marketing</h3>
                <div class="form-group">
                    <label for="partner-marketing">Partner Marketing Programme:</label>
                    <div class="integration-box">
                        <h4>Verf√ºgbare Programme</h4>
                        <div class="form-row">
                            <label><input type="checkbox" name="partner-programs" value="co-marketing"> Co-Marketing</label>
                            <label><input type="checkbox" name="partner-programs" value="mdf"> Market Development Funds</label>
                            <label><input type="checkbox" name="partner-programs" value="lead-sharing"> Lead Sharing</label>
                            <label><input type="checkbox" name="partner-programs" value="joint-events"> Joint Events</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="reporting" class="tab-content">
            <div class="section">
                <h2>Reporting & Analytics</h2>
                
                <h3>Partner Performance</h3>
                <div class="status-indicators">
                    <div class="metric-card">
                        <h4 id="partner-revenue">‚Ç¨ 245.000</h4>
                        <p>Partner Revenue (YTD)</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="partner-growth">+23%</h4>
                        <p>Wachstum (YoY)</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="partner-satisfaction">4.2/5</h4>
                        <p>Partner Zufriedenheit</p>
                    </div>
                </div>

                <h3>Projektfortschritt</h3>
                <div class="status-card">
                    <h4>Gesamtfortschritt</h4>
                    <input type="range" min="0" max="100" value="0" id="progress-range" oninput="updateProgress(this.value)">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <p id="progress-text">0% abgeschlossen</p>
                </div>

                <h3>Finanzberichte</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="aktuelle-kosten">Aktuelle Kosten (‚Ç¨):</label>
                        <input type="number" id="aktuelle-kosten" name="aktuelle-kosten" placeholder="0,00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="kostenabweichung">Kostenabweichung (‚Ç¨):</label>
                        <input type="number" id="kostenabweichung" name="kostenabweichung" placeholder="0,00" step="0.01">
                    </div>
                </div>

                <h3>Meilensteine & Arbeitspakete</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Arbeitspaket/Meilenstein</th>
                            <th>Verantwortlich</th>
                            <th>Geplantes Ende</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="meilensteine-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Arbeitspaket eingeben"></td>
                            <td><input type="text" placeholder="Name"></td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="geplant">Geplant</option>
                                    <option value="laufend">Laufend</option>
                                    <option value="abgeschlossen">Abgeschlossen</option>
                                    <option value="verzoegert">Verz√∂gert</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addMeilenstein()">+ Arbeitspaket hinzuf√ºgen</button>

                <h3>Export & Integration</h3>
                <div class="integration-box">
                    <h4>Datenexport</h4>
                    <div class="form-row">
                        <button class="add-button" onclick="exportStaticHtml()">üìÑ Dokumentation Export (HTML)</button>
                        <button class="add-button" onclick="exportHandover()">üì¶ √úbergabe-Paket Export</button>
                    </div>
                </div>
            </div>
        </div>

        <button class="save-button" onclick="saveProject()">Alle Daten speichern</button>
    </div>

    <script>
        function showTab(tabName, event) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }
        }

        document.addEventListener("DOMContentLoaded", function() {
            const firstTabButton = document.querySelector(".nav-tab");
            if (firstTabButton) {
                firstTabButton.click();
            }
        });

        function deleteRow(button) {
            const row = button.closest('tr');
            if (row) {
                row.remove();
            }
        }

        function addZertifizierung() {
            const tbody = document.getElementById('zertifizierungen-tbody');
            const newRow = `
                <tr class="data-row">
                    <td><input type="text" placeholder="Zertifizierung eingeben"></td>
                    <td>
                        <select>
                            <option value="basic">Basic</option>
                            <option value="advanced">Advanced</option>
                            <option value="expert">Expert</option>
                        </select>
                    </td>
                    <td><input type="date"></td>
                    <td>
                        <select>
                            <option value="aktiv">Aktiv</option>
                            <option value="abgelaufen">Abgelaufen</option>
                            <option value="in-erneuerung">In Erneuerung</option>
                        </select>
                    </td>
                    <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', newRow);
        }

        function addService() {
            const tbody = document.getElementById('services-tbody');
            const newRow = `
                <tr class="data-row">
                    <td><input type="text" placeholder="Service-Name"></td>
                    <td>
                        <select>
                            <option value="support">Support</option>
                            <option value="implementation">Implementation</option>
                            <option value="consulting">Consulting</option>
                            <option value="training">Training</option>
                            <option value="maintenance">Maintenance</option>
                        </select>
                    </td>
                    <td>
                        <select>
                            <option value="bronze">Bronze</option>
                            <option value="silver">Silver</option>
                            <option value="gold">Gold</option>
                            <option value="platinum">Platinum</option>
                        </select>
                    </td>
                    <td><input type="number" placeholder="‚Ç¨"></td>
                    <td>
                        <select>
                            <option value="aktiv">Aktiv</option>
                            <option value="inaktiv">Inaktiv</option>
                            <option value="entwicklung">In Entwicklung</option>
                        </select>
                    </td>
                    <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', newRow);
        }

        function addOpportunity() {
            const tbody = document.getElementById('opportunities-tbody');
            const newRow = `
                <tr class="data-row">
                    <td><input type="text" placeholder="Opportunity Name"></td>
                    <td><input type="text" placeholder="Kunde"></td>
                    <td><input type="number" placeholder="‚Ç¨"></td>
                    <td>
                        <select>
                            <option value="lead">Lead</option>
                            <option value="qualified">Qualified</option>
                            <option value="proposal">Proposal</option>
                            <option value="negotiation">Negotiation</option>
                            <option value="closed-won">Closed Won</option>
                            <option value="closed-lost">Closed Lost</option>
                        </select>
                    </td>
                    <td><input type="number" min="0" max="100" placeholder="%"></td>
                    <td><input type="date"></td>
                    <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', newRow);
        }

        function addCampaign() {
            const tbody = document.getElementById('campaigns-tbody');
            const newRow = `
                <tr class="data-row">
                    <td><input type="text" placeholder="Kampagnen-Name"></td>
                    <td>
                        <select>
                            <option value="email">E-Mail</option>
                            <option value="social">Social Media</option>
                            <option value="webinar">Webinar</option>
                            <option value="event">Event</option>
                            <option value="content">Content Marketing</option>
                            <option value="ppc">PPC/Ads</option>
                        </select>
                    </td>
                    <td><input type="text" placeholder="Zielgruppe"></td>
                    <td><input type="number" placeholder="‚Ç¨"></td>
                    <td><input type="date"></td>
                    <td><input type="date"></td>
                    <td>
                        <select>
                            <option value="geplant">Geplant</option>
                            <option value="aktiv">Aktiv</option>
                            <option value="pausiert">Pausiert</option>
                            <option value="abgeschlossen">Abgeschlossen</option>
                        </select>
                    </td>
                    <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', newRow);
        }

        function addMeilenstein() {
            const tbody = document.getElementById('meilensteine-tbody');
            const newRow = `
                <tr class="data-row">
                    <td><input type="text" placeholder="Arbeitspaket eingeben"></td>
                    <td><input type="text" placeholder="Name"></td>
                    <td><input type="date"></td>
                    <td>
                        <select>
                            <option value="geplant">Geplant</option>
                            <option value="laufend">Laufend</option>
                            <option value="abgeschlossen">Abgeschlossen</option>
                            <option value="verzoegert">Verz√∂gert</option>
                        </select>
                    </td>
                    <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                </tr>
            `;
            tbody.insertAdjacentHTML('beforeend', newRow);
        }

        function updateProgress(value) {
            document.getElementById('progress-fill').style.width = value + '%';
            document.getElementById('progress-text').textContent = value + '% abgeschlossen';
        }

        // --- Export Functions (adapted from programmManagement.html) ---
        function exportStaticHtml() {
            const projectName = document.getElementById('projektname').value || 'Unbenanntes Projekt';
            const projectID = document.getElementById('projekt-id').value || 'N/A';
            const projectLeader = document.getElementById('projektleiter').value || 'N/A';
            const projectStatus = document.getElementById('projektstatus').value || 'N/A';
            const startDate = document.getElementById('start-datum').value || 'N/A';
            const endDate = document.getElementById('end-datum').value || 'N/A';
            const budget = document.getElementById('budget').value || 'N/A';
            const projectObjective = document.getElementById('projektziel').value || 'N/A';
            const projectDescription = document.getElementById('projektbeschreibung').value || 'N/A';
            
            // Partner Management
            const partnerName = document.getElementById('partner-name').value || 'N/A';
            const partnerType = document.getElementById('partner-typ').value || 'N/A';
            const partnerTier = document.getElementById('partner-tier').value || 'N/A';
            const partnerStatus = document.getElementById('partner-status').value || 'N/A';
            const contactPerson = document.getElementById('partner-ansprechpartner').value || 'N/A';
            const partnerEmail = document.getElementById('partner-email').value || 'N/A';
            const partnerPhone = document.getElementById('partner-telefon').value || 'N/A';
            const partnerWebsite = document.getElementById('partner-website').value || 'N/A';
            const contractStart = document.getElementById('vertragsstart').value || 'N/A';
            const contractEnd = document.getElementById('vertragsende').value || 'N/A';
            const commission = document.getElementById('provision').value || 'N/A';
            const discount = document.getElementById('rabatt').value || 'N/A';

            let certificationsTable = '';
            const zertifizierungenRows = document.querySelectorAll('#zertifizierungen-tbody tr');
            zertifizierungenRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                certificationsTable += `
                    <tr>
                        <td>${inputs[0].value || 'N/A'}</td>
                        <td>${inputs[1].value || 'N/A'}</td>
                        <td>${inputs[2].value || 'N/A'}</td>
                        <td>${inputs[3].value || 'N/A'}</td>
                    </tr>
                `;
            });

            // Service Management
            let servicesTable = '';
            const servicesRows = document.querySelectorAll('#services-tbody tr');
            servicesRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                servicesTable += `
                    <tr>
                        <td>${inputs[0].value || 'N/A'}</td>
                        <td>${inputs[1].value || 'N/A'}</td>
                        <td>${inputs[2].value || 'N/A'}</td>
                        <td>${inputs[3].value || 'N/A'}</td>
                        <td>${inputs[4].value || 'N/A'}</td>
                    </tr>
                `;
            });
            const responseTime = document.getElementById('response-time').value || 'N/A';
            const resolutionTime = document.getElementById('resolution-time').value || 'N/A';
            const availability = document.getElementById('availability').value || 'N/A';
            const supportHours = document.getElementById('support-hours').value || 'N/A';
            const openTickets = document.getElementById('open-tickets').textContent || 'N/A';
            const avgResponse = document.getElementById('avg-response').textContent || 'N/A';
            const satisfaction = document.getElementById('satisfaction').textContent || 'N/A';
            const selectedIntegrations = Array.from(document.querySelectorAll('input[name="integrations"]:checked')).map(cb => cb.value).join(', ') || 'Keine';

            // Sales & Vertrieb
            let opportunitiesTable = '';
            const opportunitiesRows = document.querySelectorAll('#opportunities-tbody tr');
            opportunitiesRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                opportunitiesTable += `
                    <tr>
                        <td>${inputs[0].value || 'N/A'}</td>
                        <td>${inputs[1].value || 'N/A'}</td>
                        <td>${inputs[2].value || 'N/A'}</td>
                        <td>${inputs[3].value || 'N/A'}</td>
                        <td>${inputs[4].value || 'N/A'}</td>
                        <td>${inputs[5].value || 'N/A'}</td>
                    </tr>
                `;
            });
            const pipelineValue = document.getElementById('pipeline-value').value || 'N/A';
            const conversionRate = document.getElementById('conversion-rate').value || 'N/A';
            const avgDeal = document.getElementById('avg-deal').value || 'N/A';
            const leadSource = document.getElementById('lead-source').value || 'N/A';
            const leadScoring = document.getElementById('lead-scoring').value || 'N/A';
            const crmSystem = document.getElementById('crm-system').value || 'N/A';
            const syncFrequency = document.getElementById('sync-frequency').value || 'N/A';

            // Marketing & Kampagnen
            let campaignsTable = '';
            const campaignsRows = document.querySelectorAll('#campaigns-tbody tr');
            campaignsRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                campaignsTable += `
                    <tr>
                        <td>${inputs[0].value || 'N/A'}</td>
                        <td>${inputs[1].value || 'N/A'}</td>
                        <td>${inputs[2].value || 'N/A'}</td>
                        <td>${inputs[3].value || 'N/A'}</td>
                        <td>${inputs[4].value || 'N/A'}</td>
                        <td>${inputs[5].value || 'N/A'}</td>
                        <td>${inputs[6].value || 'N/A'}</td>
                    </tr>
                `;
            });
            const leadsGenerated = document.getElementById('leads-generated').value || 'N/A';
            const costPerLead = document.getElementById('cost-per-lead').value || 'N/A';
            const marketingROI = document.getElementById('marketing-roi').value || 'N/A';
            const contentType = document.getElementById('content-type').value || 'N/A';
            const contentStatus = document.getElementById('content-status').value || 'N/A';
            const selectedPartnerPrograms = Array.from(document.querySelectorAll('input[name="partner-programs"]:checked')).map(cb => cb.value).join(', ') || 'Keine';

            // Reporting & Analytics
            const partnerRevenue = document.getElementById('partner-revenue').textContent || 'N/A';
            const partnerGrowth = document.getElementById('partner-growth').textContent || 'N/A';
            const partnerSatisfaction = document.getElementById('partner-satisfaction').textContent || 'N/A';
            const overallProgress = document.getElementById('progress-range').value || 'N/A';
            const currentCosts = document.getElementById('aktuelle-kosten').value || 'N/A';
            const costDeviation = document.getElementById('kostenabweichung').value || 'N/A';

            let milestonesTable = '';
            const meilensteineRows = document.querySelectorAll('#meilensteine-tbody tr');
            meilensteineRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                milestonesTable += `
                    <tr>
                        <td>${inputs[0].value || 'N/A'}</td>
                        <td>${inputs[1].value || 'N/A'}</td>
                        <td>${inputs[2].value || 'N/A'}</td>
                        <td>${inputs[3].value || 'N/A'}</td>
                    </tr>
                `;
            });


            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Partner Relationship Management - Dokumentation</title>
                    <link rel="stylesheet" href="styles.css">
                    <style>
                        body { background: #f0f2f5; color: #333; line-height: 1.6; padding: 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
                        .report-container { max-width: 900px; margin: 20px auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
                        h1, h2, h3 { color: #2c3e50; margin-bottom: 15px; border-bottom: 2px solid #eee; padding-bottom: 5px; }
                        h1 { text-align: center; font-size: 2.5em; margin-bottom: 30px; }
                        h2 { font-size: 1.8em; margin-top: 30px; }
                        h3 { font-size: 1.4em; margin-top: 20px; border-bottom: 1px dashed #eee; }
                        .form-group p, .data-item p { margin-bottom: 10px; padding-left: 10px; }
                        .form-group label, .data-item label { font-weight: bold; margin-bottom: 5px; display: block; color: #555; }
                        .data-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
                        .data-table th, .data-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        .data-table th { background-color: #f2f2f2; font-weight: bold; }
                        .metric-card { background: #e9ecef; padding: 15px; border-radius: 5px; margin-bottom: 10px; text-align: center; }
                        .metric-card h4 { font-size: 1.5em; color: #3498db; }
                        .metric-card p { font-size: 0.9em; color: #666; }
                        .section-divider { border-top: 1px solid #ccc; margin: 40px 0; }
                    </style>
                </head>
                <body>
                    <div class="report-container">
                        <h1>Partner Relationship Management Dokumentation</h1>
                        
                        <div class="section">
                            <h2>Projektinitiierung</h2>
                            <h3>Projektgrundlagen</h3>
                            <div class="form-group"><label>Projektname:</label><p>${projectName.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Projekt-ID:</label><p>${projectID.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Projektleiter:</label><p>${projectLeader.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Projektstatus:</label><p>${projectStatus.replace(/\n/g, '<br>')}</p></div>
                            <h3>Zeitplan & Budget</h3>
                            <div class="form-group"><label>Startdatum:</label><p>${startDate.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Enddatum:</label><p>${endDate.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Budget (‚Ç¨):</label><p>${budget.replace(/\n/g, '<br>')}</p></div>
                            <h3>Projektziel & Beschreibung</h3>
                            <div class="form-group"><label>Projektziel:</label><p>${projectObjective.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Detaillierte Projektbeschreibung:</label><p>${projectDescription.replace(/\n/g, '<br>')}</p></div>
                        </div>

                        <div class="section">
                            <h2>Partner Management</h2>
                            <h3>Partner-Stammdaten</h3>
                            <div class="form-group"><label>Partner Name:</label><p>${partnerName.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Partner-Typ:</label><p>${partnerType.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Partner-Tier:</label><p>${partnerTier.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Partner-Status:</label><p>${partnerStatus.replace(/\n/g, '<br>')}</p></div>
                            <h3>Kontaktdaten</h3>
                            <div class="form-group"><label>Hauptansprechpartner:</label><p>${contactPerson.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>E-Mail:</label><p>${partnerEmail.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Telefon:</label><p>${partnerPhone.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Website:</label><p>${partnerWebsite.replace(/\n/g, '<br>')}</p></div>
                            <h3>Vertragsdaten</h3>
                            <div class="form-group"><label>Vertragsbeginn:</label><p>${contractStart.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Vertragsende:</label><p>${contractEnd.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Provision (%):</label><p>${commission.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Rabatt (%):</label><p>${discount.replace(/\n/g, '<br>')}</p></div>
                            <h3>Zertifizierungen & Kompetenzen</h3>
                            <table class="data-table">
                                <thead><tr><th>Zertifizierung</th><th>Level</th><th>G√ºltig bis</th><th>Status</th></tr></thead>
                                <tbody>${certificationsTable}</tbody>
                            </table>
                        </div>

                        <div class="section">
                            <h2>Service Management</h2>
                            <h3>Service-Portfolio</h3>
                            <table class="data-table">
                                <thead><tr><th>Service</th><th>Kategorie</th><th>SLA Level</th><th>Preis</th><th>Status</th></tr></thead>
                                <tbody>${servicesTable}</tbody>
                            </table>
                            <h3>Service Level Agreements (SLA)</h3>
                            <div class="form-group"><label>Reaktionszeit (Std):</label><p>${responseTime.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>L√∂sungszeit (Std):</label><p>${resolutionTime.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Verf√ºgbarkeit (%):</label><p>${availability.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Support-Zeiten:</label><p>${supportHours.replace(/\n/g, '<br>')}</p></div>
                            <h3>Ticket Management</h3>
                            <div class="form-group"><label>Offene Tickets:</label><p>${openTickets.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>√ò Reaktionszeit:</label><p>${avgResponse.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Kundenzufriedenheit:</label><p>${satisfaction.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Ticket-System Integration:</label><p>${selectedIntegrations.replace(/\n/g, '<br>')}</p></div>
                        </div>

                        <div class="section">
                            <h2>Vertrieb & Sales</h2>
                            <h3>Sales Pipeline</h3>
                            <table class="data-table">
                                <thead><tr><th>Opportunity</th><th>Kunde</th><th>Wert (‚Ç¨)</th><th>Stage</th><th>Wahrscheinlichkeit</th><th>Abschluss erwartet</th></tr></thead>
                                <tbody>${opportunitiesTable}</tbody>
                            </table>
                            <h3>Sales Metriken</h3>
                            <div class="form-group"><label>Pipeline Wert:</label><p>‚Ç¨ ${pipelineValue.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Conversion Rate:</label><p>${conversionRate.replace(/\n/g, '<br>')}%</p></div>
                            <div class="form-group"><label>Durchschnittlicher Deal:</label><p>‚Ç¨ ${avgDeal.replace(/\n/g, '<br>')}</p></div>
                            <h3>Lead Management</h3>
                            <div class="form-group"><label>Lead-Quelle:</label><p>${leadSource.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Lead Score:</label><p>${leadScoring.replace(/\n/g, '<br>')}</p></div>
                            <h3>CRM Integration</h3>
                            <div class="form-group"><label>CRM System:</label><p>${crmSystem.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Sync Frequenz:</label><p>${syncFrequency.replace(/\n/g, '<br>')}</p></div>
                        </div>

                        <div class="section">
                            <h2>Marketing & Kampagnen</h2>
                            <h3>Kampagnen-Management</h3>
                            <table class="data-table">
                                <thead><tr><th>Kampagne</th><th>Typ</th><th>Zielgruppe</th><th>Budget (‚Ç¨)</th><th>Start</th><th>Ende</th><th>Status</th></tr></thead>
                                <tbody>${campaignsTable}</tbody>
                            </table>
                            <h3>Marketing Metriken</h3>
                            <div class="form-group"><label>Leads generiert:</label><p>${leadsGenerated.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Cost per Lead:</label><p>‚Ç¨ ${costPerLead.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>ROI (%):</label><p>${marketingROI.replace(/\n/g, '<br>')}%</p></div>
                            <h3>Content Management</h3>
                            <div class="form-group"><label>Content-Typ:</label><p>${contentType.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Status:</label><p>${contentStatus.replace(/\n/g, '<br>')}</p></div>
                            <h3>Partner Marketing</h3>
                            <div class="form-group"><label>Partner Marketing Programme:</label><p>${selectedPartnerPrograms.replace(/\n/g, '<br>')}</p></div>
                        </div>

                        <div class="section">
                            <h2>Reporting & Analytics</h2>
                            <h3>Partner Performance</h3>
                            <div class="form-group"><label>Partner Revenue (YTD):</label><p>${partnerRevenue.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Wachstum (YoY):</label><p>${partnerGrowth.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Partner Zufriedenheit:</label><p>${partnerSatisfaction.replace(/\n/g, '<br>')}</p></div>
                            <h3>Projektfortschritt</h3>
                            <div class="form-group"><label>Gesamtfortschritt:</label><p>${overallProgress.replace(/\n/g, '<br>')}% abgeschlossen</p></div>
                            <h3>Finanzberichte</h3>
                            <div class="form-group"><label>Aktuelle Kosten (‚Ç¨):</label><p>‚Ç¨ ${currentCosts.replace(/\n/g, '<br>')}</p></div>
                            <div class="form-group"><label>Kostenabweichung (‚Ç¨):</label><p>‚Ç¨ ${costDeviation.replace(/\n/g, '<br>')}</p></div>
                            <h3>Meilensteine & Arbeitspakete</h3>
                            <table class="data-table">
                                <thead><tr><th>Arbeitspaket/Meilenstein</th><th>Verantwortlich</th><th>Geplantes Ende</th><th>Status</th></tr></thead>
                                <tbody>${milestonesTable}</tbody>
                            </table>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'PartnerRelationshipManagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation f√ºr Partner Relationship Management erstellt!');
        }

        function exportHandover() {
            alert('√úbergabe-Paket Export f√ºr Partner Relationship Management w√ºrde hier implementiert werden - alle relevanten Dokumente und Daten f√ºr nahtlose √úbergabe.');
        }

        function saveProject() {
            alert('Alle Daten f√ºr Partner Relationship Management wurden erfolgreich gespeichert!\n\nHinweis: In einer echten Implementierung w√ºrden die Daten an OpenProject oder eine Datenbank √ºbertragen.');
        }
    </script>
</body>
</html>