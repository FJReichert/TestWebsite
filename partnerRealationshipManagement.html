<!DOCTYPE html>
<html lang="de">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenProject - Partner Relationship Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>OpenProject PRM</h1>
            <p>Partner Relationship Management System</p>
            <div id="documentInfo" style="font-size: 0.8em; color: #666; margin-top: 10px;"></div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('project', event)">üìã Projekt</button>
            <button class="nav-tab" onclick="showTab('partner', event)">ü§ù Partner</button>
            <button class="nav-tab" onclick="showTab('service', event)">‚öôÔ∏è Service</button>
            <button class="nav-tab" onclick="showTab('sales', event)">üíº Vertrieb</button>
            <button class="nav-tab" onclick="showTab('marketing', event)">üì¢ Marketing</button>
            <button class="nav-tab" onclick="showTab('reporting', event)">üìä Reporting</button>
        </div>

        <div id="project" class="tab-content active">
            <div class="section">
                <h2>Projektinitiierung</h2>
                
                <h3>Projektgrundlagen</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="projektname">Projektname:</label>
                        <input type="text" id="projektname" name="projektname" placeholder="Projektbezeichnung eingeben">
                    </div>
                    <div class="form-group">
                        <label for="projekt-id">Projekt-ID:</label>
                        <input type="text" id="projekt-id" name="projekt-id" placeholder="Interne Kennung">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projektleiter">Projektleiter:</label>
                        <input type="text" id="projektleiter" name="projektleiter" placeholder="Name des Verantwortlichen">
                    </div>
                    <div class="form-group">
                        <label for="projektstatus">Projektstatus:</label>
                        <select id="projektstatus" name="projektstatus">
                            <option value="">Status ausw√§hlen</option>
                            <option value="geplant">Geplant</option>
                            <option value="laufend">Laufend</option>
                            <option value="pausiert">Pausiert</option>
                            <option value="abgeschlossen">Abgeschlossen</option>
                        </select>
                    </div>
                </div>

                <h3>Zeitplan & Budget</h3>
                <div class="form-row-triple">
                    <div class="form-group">
                        <label for="start-datum">Startdatum:</label>
                        <input type="date" id="start-datum" name="start-datum">
                    </div>
                    <div class="form-group">
                        <label for="end-datum">Enddatum:</label>
                        <input type="date" id="end-datum" name="end-datum">
                    </div>
                    <div class="form-group">
                        <label for="budget">Budget (‚Ç¨):</label>
                        <input type="number" id="budget" name="budget" placeholder="0,00" step="0.01">
                    </div>
                </div>

                <h3>Projektziel & Beschreibung</h3>
                <div class="form-group">
                    <label for="projektziel">Projektziel:</label>
                    <textarea id="projektziel" name="projektziel" placeholder="Hauptziele und erwartete Ergebnisse des Projekts beschreiben..." class="textarea-large"></textarea>
                </div>

                <div class="form-group">
                    <label for="projektbeschreibung">Detaillierte Projektbeschreibung:</label>
                    <textarea id="projektbeschreibung" name="projektbeschreibung" placeholder="Umfassende Beschreibung des Projektumfangs, der Anforderungen und Deliverables..." class="textarea-large"></textarea>
                </div>
            </div>
        </div>

        <div id="partner" class="tab-content">
            <div class="section">
                <h2>Partner Management</h2>
                
                <h3>Partner-Stammdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-name">Partner Name:</label>
                        <input type="text" id="partner-name" name="partner-name" placeholder="Offizieller Partnername">
                    </div>
                    <div class="form-group">
                        <label for="partner-typ">Partner-Typ:</label>
                        <select id="partner-typ" name="partner-typ">
                            <option value="">Typ ausw√§hlen</option>
                            <option value="reseller">Reseller</option>
                            <option value="distributor">Distributor</option>
                            <option value="system-integrator">System Integrator</option>
                            <option value="technology-partner">Technology Partner</option>
                            <option value="service-partner">Service Partner</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-tier">Partner-Tier:</label>
                        <select id="partner-tier" name="partner-tier">
                            <option value="">Tier ausw√§hlen</option>
                            <option value="gold">Gold Partner</option>
                            <option value="silver">Silver Partner</option>
                            <option value="bronze">Bronze Partner</option>
                            <option value="standard">Standard Partner</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="partner-status">Partner-Status:</label>
                        <select id="partner-status" name="partner-status">
                            <option value="">Status ausw√§hlen</option>
                            <option value="aktiv">Aktiv</option>
                            <option value="inaktiv">Inaktiv</option>
                            <option value="beendet">Beendet</option>
                            <option value="evaluierung">In Evaluierung</option>
                        </select>
                    </div>
                </div>

                <h3>Kontaktdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-ansprechpartner">Hauptansprechpartner:</label>
                        <input type="text" id="partner-ansprechpartner" name="partner-ansprechpartner" placeholder="Name & Position">
                    </div>
                    <div class="form-group">
                        <label for="partner-email">E-Mail:</label>
                        <input type="email" id="partner-email" name="partner-email" placeholder="kontakt@partner.de">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="partner-telefon">Telefon:</label>
                        <input type="tel" id="partner-telefon" name="partner-telefon" placeholder="+49 123 456789">
                    </div>
                    <div class="form-group">
                        <label for="partner-website">Website:</label>
                        <input type="url" id="partner-website" name="partner-website" placeholder="https://www.partner.de">
                    </div>
                </div>

                <h3>Vertragsdaten</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="vertragsstart">Vertragsbeginn:</label>
                        <input type="date" id="vertragsstart" name="vertragsstart">
                    </div>
                    <div class="form-group">
                        <label for="vertragsende">Vertragsende:</label>
                        <input type="date" id="vertragsende" name="vertragsende">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="provision">Provision (%):</label>
                        <input type="number" id="provision" name="provision" min="0" max="100" step="0.1" placeholder="0.0">
                    </div>
                    <div class="form-group">
                        <label for="rabatt">Rabatt (%):</label>
                        <input type="number" id="rabatt" name="rabatt" min="0" max="100" step="0.1" placeholder="0.0">
                    </div>
                </div>

                <h3>Zertifizierungen & Kompetenzen</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Zertifizierung</th>
                            <th>Level</th>
                            <th>G√ºltig bis</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="zertifizierungen-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Zertifizierung eingeben"></td>
                            <td>
                                <select>
                                    <option value="basic">Basic</option>
                                    <option value="advanced">Advanced</option>
                                    <option value="expert">Expert</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="abgelaufen">Abgelaufen</option>
                                    <option value="in-erneuerung">In Erneuerung</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addZertifizierung()">+ Zertifizierung hinzuf√ºgen</button>
            </div>
        </div>

        <div id="service" class="tab-content">
            <div class="section">
                <h2>Service Management</h2>
                
                <h3>Service-Portfolio</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Kategorie</th>
                            <th>SLA Level</th>
                            <th>Preis</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="services-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Service-Name"></td>
                            <td>
                                <select>
                                    <option value="support">Support</option>
                                    <option value="implementation">Implementation</option>
                                    <option value="consulting">Consulting</option>
                                    <option value="training">Training</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </td>
                            <td>
                                <select>
                                    <option value="bronze">Bronze</option>
                                    <option value="silver">Silver</option>
                                    <option value="gold">Gold</option>
                                    <option value="platinum">Platinum</option>
                                </select>
                            </td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="aktiv">Aktiv</option>
                                    <option value="inaktiv">Inaktiv</option>
                                    <option value="entwicklung">In Entwicklung</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addService()">+ Service hinzuf√ºgen</button>

                <h3>Service Level Agreements (SLA)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="response-time">Reaktionszeit (Std):</label>
                        <input type="number" id="response-time" name="response-time" min="0" step="0.5" placeholder="24">
                    </div>
                    <div class="form-group">
                        <label for="resolution-time">L√∂sungszeit (Std):</label>
                        <input type="number" id="resolution-time" name="resolution-time" min="0" step="0.5" placeholder="72">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="availability">Verf√ºgbarkeit (%):</label>
                        <input type="number" id="availability" name="availability" min="0" max="100" step="0.1" placeholder="99.9">
                    </div>
                    <div class="form-group">
                        <label for="support-hours">Support-Zeiten:</label>
                        <select id="support-hours" name="support-hours">
                            <option value="8x5">8x5 (Gesch√§ftszeiten)</option>
                            <option value="12x5">12x5 (Erweiterte Gesch√§ftszeiten)</option>
                            <option value="24x7">24x7 (Rund um die Uhr)</option>
                        </select>
                    </div>
                </div>

                <h3>Ticket Management</h3>
                <div class="status-indicators">
                    <div class="metric-card">
                        <h4 id="open-tickets">24</h4>
                        <p>Offene Tickets</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="avg-response">2.3h</h4>
                        <p>√ò Reaktionszeit</p>
                    </div>
                    <div class="metric-card">
                        <h4 id="satisfaction">4.7</h4>
                        <p>Kundenzufriedenheit</p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="ticket-system">Ticket-System Integration:</label>
                    <div class="integration-box">
                        <h4>Verf√ºgbare Integrationen</h4>
                        <div class="form-row">
                            <label><input type="checkbox" name="integrations" value="jira"> Jira Service Desk</label>
                            <label><input type="checkbox" name="integrations" value="servicenow"> ServiceNow</label>
                            <label><input type="checkbox" name="integrations" value="zendesk"> Zendesk</label>
                            <label><input type="checkbox" name="integrations" value="freshdesk"> Freshdesk</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="sales" class="tab-content">
            <div class="section">
                <h2>Vertrieb & Sales</h2>
                <h3>Sales Pipeline</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Opportunity</th>
                            <th>Kunde</th>
                            <th>Wert (‚Ç¨)</th>
                            <th>Stage</th>
                            <th>Wahrscheinlichkeit</th>
                            <th>Abschluss erwartet</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="opportunities-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Opportunity Name"></td>
                            <td><input type="text" placeholder="Kunde"></td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="lead">Lead</option>
                                    <option value="qualified">Qualified</option>
                                    <option value="proposal">Proposal</option>
                                    <option value="negotiation">Negotiation</option>
                                    <option value="closed-won">Closed Won</option>
                                    <option value="closed-lost">Closed Lost</option>
                                </select>
                            </td>
                            <td><input type="number" min="0" max="100" placeholder="%"></td>
                            <td><input type="date"></td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addOpportunity()">+ Opportunity hinzuf√ºgen</button>
                <h3>Sales Metriken</h3>
                <div class="status-indicators">
                    <div class="status-card">
                        <h4>Pipeline Wert</h4>
                        <input type="number" id="pipeline-value" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                    <div class="status-card">
                        <h4>Conversion Rate</h4>
                        <input type="number" id="conversion-rate" placeholder="0.0%" step="0.1">
                    </div>
                    <div class="status-card">
                        <h4>Durchschnittlicher Deal Wert</h4>
                        <input type="number" id="avg-deal-value" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                </div>

                <h3>Marketing Kampagnen</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Kampagnenname</th>
                            <th>Typ</th>
                            <th>Startdatum</th>
                            <th>Enddatum</th>
                            <th>Budget (‚Ç¨)</th>
                            <th>Status</th>
                            <th>Leads</th>
                            <th>Konversionen</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="campaigns-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Kampagnenname"></td>
                            <td>
                                <select>
                                    <option value="email">E-Mail</option>
                                    <option value="social-media">Social Media</option>
                                    <option value="webinar">Webinar</option>
                                    <option value="event">Event</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td><input type="date"></td>
                            <td><input type="number" placeholder="‚Ç¨"></td>
                            <td>
                                <select>
                                    <option value="planned">Planned</option>
                                    <option value="active">Active</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </td>
                            <td><input type="number" placeholder="0"></td>
                            <td><input type="number" placeholder="0"></td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addCampaign()">+ Kampagne hinzuf√ºgen</button>
            </div>
        </div>

        <div id="marketing" class="tab-content">
            <div class="section">
                <h2>Marketing & Kommunikation</h2>
                <h3>Inhalt & Materialien</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Titel</th>
                            <th>Typ</th>
                            <th>Erstellungsdatum</th>
                            <th>Status</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody id="content-tbody">
                        <tr class="data-row">
                            <td><input type="text" placeholder="Titel des Inhalts"></td>
                            <td>
                                <select>
                                    <option value="blog">Blog Post</option>
                                    <option value="whitepaper">Whitepaper</option>
                                    <option value="case-study">Case Study</option>
                                    <option value="video">Video</option>
                                    <option value="infographic">Infographic</option>
                                </select>
                            </td>
                            <td><input type="date"></td>
                            <td>
                                <select>
                                    <option value="draft">Draft</option>
                                    <option value="published">Published</option>
                                    <option value="archived">Archived</option>
                                </select>
                            </td>
                            <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
                        </tr>
                    </tbody>
                </table>
                <button class="add-button" onclick="addContent()">+ Inhalt hinzuf√ºgen</button>

                <h3>Kommunikationskan√§le</h3>
                <div class="form-group">
                    <label for="social-media-links">Social Media Links:</label>
                    <textarea id="social-media-links" placeholder="LinkedIn, Twitter, Facebook, etc."></textarea>
                </div>
                <div class="form-group">
                    <label for="newsletter-frequency">Newsletter Frequenz:</label>
                    <select id="newsletter-frequency">
                        <option value="weekly">W√∂chentlich</option>
                        <option value="bi-weekly">Zweiw√∂chentlich</option>
                        <option value="monthly">Monatlich</option>
                        <option value="quarterly">Quartalsweise</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="event-calendar">Event Kalender Integration:</label>
                    <input type="text" id="event-calendar" placeholder="Link zu externem Event Kalender">
                </div>
            </div>
        </div>

        <div id="reporting" class="tab-content">
            <div class="section">
                <h2>Reporting & Analyse</h2>
                <h3>Leistungsindikatoren (KPIs)</h3>
                <div class="status-indicators">
                    <div class="metric-card">
                        <h4>Umsatz mit Partnern</h4>
                        <input type="number" id="partner-revenue" placeholder="‚Ç¨ 0,00" step="0.01">
                    </div>
                    <div class="metric-card">
                        <h4>Neue Partner</h4>
                        <input type="number" id="new-partners" placeholder="0">
                    </div>
                    <div class="metric-card">
                        <h4>Partner-Zufriedenheit</h4>
                        <input type="number" id="partner-satisfaction" placeholder="0.0">
                    </div>
                </div>

                <h3>Finanzberichte</h3>
                <div class="data-row-export"><span class="data-label-export">Aktuelle Kosten (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${currentCosts.replace(/\n/g, '<br>')}</span></div>
                <div class="data-row-export"><span class="data-label-export">Kostenabweichung (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${costDeviation.replace(/\n/g, '<br>')}</span></div>
                <h3>Meilensteine & Arbeitspakete</h3>
                <table class="output-table">
                    <thead><tr><th>Arbeitspaket/Meilenstein</th><th>Verantwortlich</th><th>Geplantes Ende</th><th>Status</th></tr></thead>
                    <tbody>${milestonesTable}</tbody>
                </table>
            </div>
        </div>
        <div class="actions">
            <button class="btn btn-secondary" onclick="printDocument()">üìÑ Dokument drucken</button>
            <button class="btn btn-primary" onclick="generateDocumentation()">üíæ Dokument speichern</button>
            <button class="btn btn-success" onclick="exportHandover()">üîÑ √úbergabe-Paket exportieren</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const documentInfoDiv = document.getElementById('documentInfo');
            if (documentInfoDiv) {
                documentInfoDiv.innerHTML = `Version 1.0 (Stand: ${new Date().toLocaleDateString('de-DE')})`;
            }
        });

        function showTab(tabId, event) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');

            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        function addZertifizierung() {
            const tbody = document.getElementById('zertifizierungen-tbody');
            const row = document.createElement('tr');
            row.classList.add('data-row');
            row.innerHTML = `
                <td><input type="text" placeholder="Zertifizierung eingeben"></td>
                <td>
                    <select>
                        <option value="basic">Basic</option>
                        <option value="advanced">Advanced</option>
                        <option value="expert">Expert</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td>
                    <select>
                        <option value="aktiv">Aktiv</option>
                        <option value="abgelaufen">Abgelaufen</option>
                        <option value="in-erneuerung">In Erneuerung</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(row);
        }

        function addService() {
            const tbody = document.getElementById('services-tbody');
            const row = document.createElement('tr');
            row.classList.add('data-row');
            row.innerHTML = `
                <td><input type="text" placeholder="Service-Name"></td>
                <td>
                    <select>
                        <option value="support">Support</option>
                        <option value="implementation">Implementation</option>
                        <option value="consulting">Consulting</option>
                        <option value="training">Training</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option value="bronze">Bronze</option>
                        <option value="silver">Silver</option>
                        <option value="gold">Gold</option>
                        <option value="platinum">Platinum</option>
                    </select>
                </td>
                <td><input type="number" placeholder="‚Ç¨"></td>
                <td>
                    <select>
                        <option value="aktiv">Aktiv</option>
                        <option value="inaktiv">Inaktiv</option>
                        <option value="entwicklung">In Entwicklung</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(row);
        }

        function addOpportunity() {
            const tbody = document.getElementById('opportunities-tbody');
            const row = document.createElement('tr');
            row.classList.add('data-row');
            row.innerHTML = `
                <td><input type="text" placeholder="Opportunity Name"></td>
                <td><input type="text" placeholder="Kunde"></td>
                <td><input type="number" placeholder="‚Ç¨"></td>
                <td>
                    <select>
                        <option value="lead">Lead</option>
                        <option value="qualified">Qualified</option>
                        <option value="proposal">Proposal</option>
                        <option value="negotiation">Negotiation</option>
                        <option value="closed-won">Closed Won</option>
                        <option value="closed-lost">Closed Lost</option>
                    </select>
                </td>
                <td><input type="number" min="0" max="100" placeholder="%"></td>
                <td><input type="date"></td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(row);
        }

        function addCampaign() {
            const tbody = document.getElementById('campaigns-tbody');
            const row = document.createElement('tr');
            row.classList.add('data-row');
            row.innerHTML = `
                <td><input type="text" placeholder="Kampagnenname"></td>
                <td>
                    <select>
                        <option value="email">E-Mail</option>
                        <option value="social-media">Social Media</option>
                        <option value="webinar">Webinar</option>
                        <option value="event">Event</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td><input type="date"></td>
                <td><input type="number" placeholder="‚Ç¨"></td>
                <td>
                    <select>
                        <option value="planned">Planned</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                    </select>
                </td>
                <td><input type="number" placeholder="0"></td>
                <td><input type="number" placeholder="0"></td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(row);
        }

        function addContent() {
            const tbody = document.getElementById('content-tbody');
            const row = document.createElement('tr');
            row.classList.add('data-row');
            row.innerHTML = `
                <td><input type="text" placeholder="Titel des Inhalts"></td>
                <td>
                    <select>
                        <option value="blog">Blog Post</option>
                        <option value="whitepaper">Whitepaper</option>
                        <option value="case-study">Case Study</option>
                        <option value="video">Video</option>
                        <option value="infographic">Infographic</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td>
                    <select>
                        <option value="draft">Draft</option>
                        <option value="published">Published</option>
                        <option value="archived">Archived</option>
                    </select>
                </td>
                <td><button class="delete-button" onclick="deleteRow(this)">-</button></td>
            `;
            tbody.appendChild(row);
        }

        function deleteRow(button) {
            button.closest('tr').remove();
        }

        function generateDocumentation() {
            const projektname = document.getElementById('projektname').value || 'Unbenanntes Projekt';
            const projektId = document.getElementById('projekt-id').value || 'N/A';
            const projektleiter = document.getElementById('projektleiter').value || 'N/A';
            const projektstatus = document.getElementById('projektstatus').value || 'Nicht definiert';
            const startDatum = document.getElementById('start-datum').value || 'N/A';
            const endDatum = document.getElementById('end-datum').value || 'N/A';
            const budget = document.getElementById('budget').value || '0.00';
            const projektziel = document.getElementById('projektziel').value || 'Kein Ziel definiert.';
            const projektbeschreibung = document.getElementById('projektbeschreibung').value || 'Keine detaillierte Beschreibung vorhanden.';

            const partnerName = document.getElementById('partner-name').value || 'Nicht definiert';
            const partnerTyp = document.getElementById('partner-typ').value || 'Nicht definiert';
            const partnerTier = document.getElementById('partner-tier').value || 'Nicht definiert';
            const partnerStatus = document.getElementById('partner-status').value || 'Nicht definiert';
            const partnerAnsprechpartner = document.getElementById('partner-ansprechpartner').value || 'N/A';
            const partnerEmail = document.getElementById('partner-email').value || 'N/A';
            const partnerTelefon = document.getElementById('partner-telefon').value || 'N/A';
            const partnerWebsite = document.getElementById('partner-website').value || 'N/A';
            const vertragsstart = document.getElementById('vertragsstart').value || 'N/A';
            const vertragsende = document.getElementById('vertragsende').value || 'N/A';
            const provision = document.getElementById('provision').value || '0.0';
            const rabatt = document.getElementById('rabatt').value || '0.0';

            const zertifizierungen = Array.from(document.querySelectorAll('#zertifizierungen-tbody tr')).map(row => {
                const inputs = row.querySelectorAll('input, select');
                return {
                    zertifizierung: inputs[0].value,
                    level: inputs[1].value,
                    gueltigBis: inputs[2].value,
                    status: inputs[3].value
                };
            });

            const services = Array.from(document.querySelectorAll('#services-tbody tr')).map(row => {
                const inputs = row.querySelectorAll('input, select');
                return {
                    service: inputs[0].value,
                    kategorie: inputs[1].value,
                    slaLevel: inputs[2].value,
                    preis: inputs[3].value,
                    status: inputs[4].value
                };
            });

            const responseTime = document.getElementById('response-time').value || 'N/A';
            const resolutionTime = document.getElementById('resolution-time').value || 'N/A';
            const availability = document.getElementById('availability').value || 'N/A';
            const supportHours = document.getElementById('support-hours').value || 'N/A';
            const ticketSystemIntegration = Array.from(document.querySelectorAll('input[name="integrations"]:checked')).map(cb => cb.value).join(', ') || 'Keine';

            const opportunities = Array.from(document.querySelectorAll('#opportunities-tbody tr')).map(row => {
                const inputs = row.querySelectorAll('input, select');
                return {
                    opportunity: inputs[0].value,
                    kunde: inputs[1].value,
                    wert: inputs[2].value,
                    stage: inputs[3].value,
                    wahrscheinlichkeit: inputs[4].value,
                    abschlussErwartet: inputs[5].value
                };
            });

            const pipelineValue = document.getElementById('pipeline-value').value || '0.00';
            const conversionRate = document.getElementById('conversion-rate').value || '0.0';
            const avgDealValue = document.getElementById('avg-deal-value').value || '0.00';

            const campaigns = Array.from(document.querySelectorAll('#campaigns-tbody tr')).map(row => {
                const inputs = row.querySelectorAll('input, select');
                return {
                    kampagnenname: inputs[0].value,
                    typ: inputs[1].value,
                    startdatum: inputs[2].value,
                    enddatum: inputs[3].value,
                    budget: inputs[4].value,
                    status: inputs[5].value,
                    leads: inputs[6].value,
                    konversionen: inputs[7].value
                };
            });

            const content = Array.from(document.querySelectorAll('#content-tbody tr')).map(row => {
                const inputs = row.querySelectorAll('input, select');
                return {
                    titel: inputs[0].value,
                    typ: inputs[1].value,
                    erstellungsdatum: inputs[2].value,
                    status: inputs[3].value
                };
            });

            const socialMediaLinks = document.getElementById('social-media-links').value || 'N/A';
            const newsletterFrequency = document.getElementById('newsletter-frequency').value || 'N/A';
            const eventCalendar = document.getElementById('event-calendar').value || 'N/A';

            const partnerRevenue = document.getElementById('partner-revenue').value || '0.00';
            const newPartners = document.getElementById('new-partners').value || '0';
            const partnerSatisfaction = document.getElementById('partner-satisfaction').value || '0.0';

            const currentCosts = "Hier w√ºrden die tats√§chlichen Kosten aus einem Backend-System geladen.";
            const costDeviation = "Hier w√ºrde die Kostenabweichung berechnet.";

            const milestonesTable = `
                <tr><td>Meilenstein 1</td><td>Team A</td><td>2024-12-31</td><td>Abgeschlossen</td></tr>
                <tr><td>Meilenstein 2</td><td>Team B</td><td>2025-06-30</td><td>In Bearbeitung</td></tr>
            `; // Example static content

            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>PartnerRelationshipManagement-Dokumentation</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; background-color: #f4f4f4; color: #333; }
                        .document-container { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); max-width: 900px; margin: 20px auto; }
                        h1, h2, h3 { color: #333; }
                        .section { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
                        .section:last-child { border-bottom: none; }
                        .data-row-export { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #eee; }
                        .data-label-export { font-weight: bold; }
                        .data-value-export { text-align: right; }
                        .output-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                        .output-table th, .output-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        .output-table th { background-color: #f2f2f2; }
                        .status-indicators-export { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
                        .metric-card-export, .status-card-export { background-color: #e9e9e9; padding: 10px; border-radius: 5px; flex: 1; min-width: 150px; text-align: center; }
                        .metric-card-export h4, .status-card-export h4 { margin: 0 0 5px 0; color: #555; }
                        .metric-card-export p, .status-card-export p { margin: 0; font-size: 0.9em; color: #777; }
                        ul { list-style-type: none; padding: 0; }
                        ul li { background-color: #f9f9f9; padding: 8px; margin-bottom: 5px; border-radius: 4px; }
                        .document-info { font-size: 0.8em; color: #666; margin-top: 10px; text-align: right;}
                    </style>
                </head>
                <body>
                    <div class="document-container">
                        <div class="header">
                            <h1>OpenProject PRM Dokumentation</h1>
                            <p>Partner Relationship Management System</p>
                            <div class="document-info">Version 1.0 (Stand: ${new Date().toLocaleDateString('de-DE')})</div>
                        </div>

                        <div class="section">
                            <h2>Projektinitiierung</h2>
                            <div class="data-row-export"><span class="data-label-export">Projektname:</span><span class="data-value-export">${projektname.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projekt-ID:</span><span class="data-value-export">${projektId.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projektleiter:</span><span class="data-value-export">${projektleiter.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projektstatus:</span><span class="data-value-export">${projektstatus.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Startdatum:</span><span class="data-value-export">${startDatum.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Enddatum:</span><span class="data-value-export">${endDatum.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Budget (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${budget.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Projektziel:</span><span class="data-value-export">${projektziel.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Detaillierte Projektbeschreibung:</span><span class="data-value-export">${projektbeschreibung.replace(/\n/g, '<br>')}</span></div>
                        </div>

                        <div class="section">
                            <h2>Partner Management</h2>
                            <div class="data-row-export"><span class="data-label-export">Partner Name:</span><span class="data-value-export">${partnerName.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Typ:</span><span class="data-value-export">${partnerTyp.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Tier:</span><span class="data-value-export">${partnerTier.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Status:</span><span class="data-value-export">${partnerStatus.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Hauptansprechpartner:</span><span class="data-value-export">${partnerAnsprechpartner.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">E-Mail:</span><span class="data-value-export">${partnerEmail.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Telefon:</span><span class="data-value-export">${partnerTelefon.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Website:</span><span class="data-value-export">${partnerWebsite.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Vertragsbeginn:</span><span class="data-value-export">${vertragsstart.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Vertragsende:</span><span class="data-value-export">${vertragsende.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Provision (%):</span><span class="data-value-export">${provision.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Rabatt (%):</span><span class="data-value-export">${rabatt.replace(/\n/g, '<br>')}</span></div>
                            <h3>Zertifizierungen & Kompetenzen</h3>
                            <table class="output-table">
                                <thead><tr><th>Zertifizierung</th><th>Level</th><th>G√ºltig bis</th><th>Status</th></tr></thead>
                                <tbody>
                                    ${zertifizierungen.map(z => `
                                        <tr>
                                            <td>${z.zertifizierung.replace(/\n/g, '<br>')}</td>
                                            <td>${z.level.replace(/\n/g, '<br>')}</td>
                                            <td>${z.gueltigBis.replace(/\n/g, '<br>')}</td>
                                            <td>${z.status.replace(/\n/g, '<br>')}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>

                        <div class="section">
                            <h2>Service Management</h2>
                            <h3>Service-Portfolio</h3>
                            <table class="output-table">
                                <thead><tr><th>Service</th><th>Kategorie</th><th>SLA Level</th><th>Preis</th><th>Status</th></tr></thead>
                                <tbody>
                                    ${services.map(s => `
                                        <tr>
                                            <td>${s.service.replace(/\n/g, '<br>')}</td>
                                            <td>${s.kategorie.replace(/\n/g, '<br>')}</td>
                                            <td>${s.slaLevel.replace(/\n/g, '<br>')}</td>
                                            <td>${s.preis.replace(/\n/g, '<br>')}</td>
                                            <td>${s.status.replace(/\n/g, '<br>')}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            <h3>Service Level Agreements (SLA)</h3>
                            <div class="data-row-export"><span class="data-label-export">Reaktionszeit (Std):</span><span class="data-value-export">${responseTime.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">L√∂sungszeit (Std):</span><span class="data-value-export">${resolutionTime.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Verf√ºgbarkeit (%):</span><span class="data-value-export">${availability.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Support-Zeiten:</span><span class="data-value-export">${supportHours.replace(/\n/g, '<br>')}</span></div>
                            <h3>Ticket Management</h3>
                            <div class="data-row-export"><span class="data-label-export">Ticket-System Integration:</span><span class="data-value-export">${ticketSystemIntegration.replace(/\n/g, '<br>')}</span></div>
                        </div>

                        <div class="section">
                            <h2>Vertrieb & Sales</h2>
                            <h3>Sales Pipeline</h3>
                            <table class="output-table">
                                <thead><tr><th>Opportunity</th><th>Kunde</th><th>Wert (‚Ç¨)</th><th>Stage</th><th>Wahrscheinlichkeit</th><th>Abschluss erwartet</th></tr></thead>
                                <tbody>
                                    ${opportunities.map(o => `
                                        <tr>
                                            <td>${o.opportunity.replace(/\n/g, '<br>')}</td>
                                            <td>${o.kunde.replace(/\n/g, '<br>')}</td>
                                            <td>${o.wert.replace(/\n/g, '<br>')}</td>
                                            <td>${o.stage.replace(/\n/g, '<br>')}</td>
                                            <td>${o.wahrscheinlichkeit.replace(/\n/g, '<br>')}</td>
                                            <td>${o.abschlussErwartet.replace(/\n/g, '<br>')}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            <h3>Sales Metriken</h3>
                            <div class="data-row-export"><span class="data-label-export">Pipeline Wert:</span><span class="data-value-export">‚Ç¨ ${pipelineValue.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Conversion Rate:</span><span class="data-value-export">${conversionRate.replace(/\n/g, '<br>')}%</span></div>
                            <div class="data-row-export"><span class="data-label-export">Durchschnittlicher Deal Wert:</span><span class="data-value-export">‚Ç¨ ${avgDealValue.replace(/\n/g, '<br>')}</span></div>
                            <h3>Marketing Kampagnen</h3>
                            <table class="output-table">
                                <thead><tr><th>Kampagnenname</th><th>Typ</th><th>Startdatum</th><th>Enddatum</th><th>Budget (‚Ç¨)</th><th>Status</th><th>Leads</th><th>Konversionen</th></tr></thead>
                                <tbody>
                                    ${campaigns.map(c => `
                                        <tr>
                                            <td>${c.kampagnenname.replace(/\n/g, '<br>')}</td>
                                            <td>${c.typ.replace(/\n/g, '<br>')}</td>
                                            <td>${c.startdatum.replace(/\n/g, '<br>')}</td>
                                            <td>${c.enddatum.replace(/\n/g, '<br>')}</td>
                                            <td>${c.budget.replace(/\n/g, '<br>')}</td>
                                            <td>${c.status.replace(/\n/g, '<br>')}</td>
                                            <td>${c.leads.replace(/\n/g, '<br>')}</td>
                                            <td>${c.konversionen.replace(/\n/g, '<br>')}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>

                        <div class="section">
                            <h2>Marketing & Kommunikation</h2>
                            <h3>Inhalt & Materialien</h3>
                            <table class="output-table">
                                <thead><tr><th>Titel</th><th>Typ</th><th>Erstellungsdatum</th><th>Status</th></tr></thead>
                                <tbody>
                                    ${content.map(c => `
                                        <tr>
                                            <td>${c.titel.replace(/\n/g, '<br>')}</td>
                                            <td>${c.typ.replace(/\n/g, '<br>')}</td>
                                            <td>${c.erstellungsdatum.replace(/\n/g, '<br>')}</td>
                                            <td>${c.status.replace(/\n/g, '<br>')}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                            <h3>Kommunikationskan√§le</h3>
                            <div class="data-row-export"><span class="data-label-export">Social Media Links:</span><span class="data-value-export">${socialMediaLinks.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Newsletter Frequenz:</span><span class="data-value-export">${newsletterFrequency.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Event Kalender Integration:</span><span class="data-value-export">${eventCalendar.replace(/\n/g, '<br>')}</span></div>
                        </div>

                        <div class="section">
                            <h2>Reporting & Analyse</h2>
                            <h3>Leistungsindikatoren (KPIs)</h3>
                            <div class="data-row-export"><span class="data-label-export">Umsatz mit Partnern:</span><span class="data-value-export">‚Ç¨ ${partnerRevenue.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Neue Partner:</span><span class="data-value-export">${newPartners.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Partner-Zufriedenheit:</span><span class="data-value-export">${partnerSatisfaction.replace(/\n/g, '<br>')}</span></div>
                            <h3>Finanzberichte</h3>
                            <div class="data-row-export"><span class="data-label-export">Aktuelle Kosten (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${currentCosts.replace(/\n/g, '<br>')}</span></div>
                            <div class="data-row-export"><span class="data-label-export">Kostenabweichung (‚Ç¨):</span><span class="data-value-export">‚Ç¨ ${costDeviation.replace(/\n/g, '<br>')}</span></div>
                            <h3>Meilensteine & Arbeitspakete</h3>
                            <table class="output-table">
                                <thead><tr><th>Arbeitspaket/Meilenstein</th><th>Verantwortlich</th><th>Geplantes Ende</th><th>Status</th></tr></thead>
                                <tbody>${milestonesTable}</tbody>
                            </table>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'PartnerRelationshipManagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation f√ºr Partner Relationship Management erstellt!');
        }

    </script>
</body>
</html>