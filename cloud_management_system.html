<!DOCTYPE html>
<html lang="de">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Management Dokumentationssystem</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>Cloud Management Dokumentationssystem</h1>
            <p>Umfassende Dokumentvorlage für alle Projektphasen</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('grundlagen')">Projektübersicht</button>
            <button class="nav-tab" onclick="showTab('vorbereitung')">Vorbereitungsphase</button>
            <button class="nav-tab" onclick="showTab('bearbeitung')">Bearbeitungsphase</button>
            <button class="nav-tab" onclick="showTab('nachbereitung')">Nachbereitung & Kontrolle</button>
            <button class="nav-tab" onclick="showTab('vorlagen')">Vorlagen & Tools</button>
        </div>
        
        <div class="content">
            <!-- Projektübersicht -->
            <div id="grundlagen" class="tab-content active">
                <div class="section">
                    <h2>Projektübersicht</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Kundenname:</label>
                            <input type="text" placeholder="Name des Kunden">
                        </div>
                        <div class="form-group">
                            <label>Projektname:</label>
                            <input type="text" placeholder="Name des Projekts">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Projektbeschreibung (Leistungsbeschreibung):</label>
                        <textarea placeholder="Detaillierte Beschreibung der vertraglich festgelegten Leistungen"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Projektstart:</label>
                            <input type="date">
                        </div>
                        <div class="form-group">
                            <label>Projektende:</label>
                            <input type="date">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Beauftragter Zeitrahmen:</label>
                        <textarea placeholder="Detaillierte Zeitplanung und Laufzeit des Projektes"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Vorbereitungsphase -->
            <div id="vorbereitung" class="tab-content">
                <div class="section">
                    <h2>Vorbereitungsphase</h2>
                    
                    <h3>1. Projektinitialisierungsdokument</h3>
                    <div class="form-group">
                        <label>Projektziele:</label>
                        <textarea placeholder="Messbare Ziele des Projekts"></textarea>
                        
                        <label>Beteiligte Stakeholder:</label>
                        <textarea placeholder="Liste aller beteiligten Parteien mit Kontaktdaten"></textarea>
                        
                        <label>Erfolgskriterien:</label>
                        <textarea placeholder="Kriterien für den Projekterfolg"></textarea>
                    </div>
                    
                    <h3>2. Anforderungsdokument</h3>
                    <div class="form-group">
                        <label>Geschäftsanforderungen:</label>
                        <textarea placeholder="Beschreibung der Geschäftsanforderungen"></textarea>
                        
                        <label>Technische Anforderungen:</label>
                        <textarea placeholder="Detaillierte technische Anforderungen"></textarea>
                        
                        <label>Sicherheitsanforderungen:</label>
                        <textarea placeholder="Compliance- und Sicherheitsanforderungen"></textarea>
                    </div>
                    
                    <h3>3. Cloud-Strategie-Dokument</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Cloud-Modell:</label>
                            <select>
                                <option>Public Cloud</option>
                                <option>Private Cloud</option>
                                <option>Hybrid Cloud</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Cloud-Anbieter:</label>
                            <input type="text" placeholder="Ausgewählte Cloud-Anbieter">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Begründung für Cloud-Anbieter:</label>
                        <textarea placeholder="Begründung für die Auswahl des Cloud-Anbieters"></textarea>
                        
                        <label>Migrationsplan:</label>
                        <textarea placeholder="Schritte für die Migration bestehender Systeme"></textarea>
                    </div>
                    
                    <h3>4. Kostenanalyse</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Anfangsinvestition:</label>
                            <textarea placeholder="Details zu Anfangsinvestitionen"></textarea>
                            
                            <label>Laufende Kosten:</label>
                            <textarea placeholder="Details zu laufenden Betriebskosten"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Kosteneinsparungen:</label>
                            <textarea placeholder="Mögliche Kosteneinsparungen durch Cloud-Lösung"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bearbeitungsphase -->
            <div id="bearbeitung" class="tab-content">
                <div class="section">
                    <h2>Bearbeitungsphase</h2>
                    
                    <h3>1. Aufgabenverteilung</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Aufgabe</th>
                                <th>Verantwortlich</th>
                                <th>Status</th>
                                <th>Fällig</th>
                                <th>Kommentare</th>
                            </tr>
                        </thead>
                        <tbody id="aufgabenTable">
                            <tr>
                                <td><input type="text" placeholder="Aufgabenbeschreibung"></td>
                                <td><input type="text" placeholder="Verantwortlich"></td>
                                <td>
                                    <select>
                                        <option>Geplant</option>
                                        <option>In Bearbeitung</option>
                                        <option>Abgeschlossen</option>
                                        <option>Verzögert</option>
                                    </select>
                                </td>
                                <td><input type="date"></td>
                                <td><input type="text" placeholder="Kommentare"></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-secondary" onclick="addTaskRow()">+ Weitere Aufgabe hinzufügen</button>
                    
                    <h3>2. Zeitplan und Meilensteine</h3>
                    <div id="milestones">
                        <div class="milestone-item">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Meilenstein:</label>
                                    <input type="text" placeholder="Meilensteinbeschreibung">
                                </div>
                                <div class="form-group">
                                    <label>Datum:</label>
                                    <input type="date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Beschreibung:</label>
                                <textarea placeholder="Detaillierte Beschreibung des Meilensteins"></textarea>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="addMilestone()">+ Weiteren Meilenstein hinzufügen</button>
                    
                    <h3>3. Risikomanagement</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Risiko</th>
                                <th>Kategorie</th>
                                <th>Eintrittswahrscheinlichkeit</th>
                                <th>Auswirkung</th>
                                <th>Maßnahme</th>
                            </tr>
                        </thead>
                        <tbody id="risikoTable">
                            <tr>
                                <td><input type="text" placeholder="Risikobeschreibung"></td>
                                <td>
                                    <select>
                                        <option>Technisch</option>
                                        <option>Organisatorisch</option>
                                        <option>Finanziell</option>
                                        <option>Zeitlich</option>
                                    </select>
                                </td>
                                <td>
                                    <select>
                                        <option>Niedrig</option>
                                        <option>Mittel</option>
                                        <option>Hoch</option>
                                    </select>
                                </td>
                                <td>
                                    <select>
                                        <option>Gering</option>
                                        <option>Mittel</option>
                                        <option>Hoch</option>
                                    </select>
                                </td>
                                <td><input type="text" placeholder="Maßnahmen"></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-secondary" onclick="addRiskRow()">+ Weiteres Risiko hinzufügen</button>
                    
                    <h3>4. Fortschrittsbericht</h3>
                    <div class="form-group">
                        <label>Aktueller Status:</label>
                        <select>
                            <option>Planmäßig</option>
                            <option>Geringfügige Verzögerung</option>
                            <option>Erhebliche Verzögerung</option>
                            <option>Kritisch</option>
                        </select>
                        
                        <label>Abgeschlossene Arbeiten:</label>
                        <textarea placeholder="Beschreibung der abgeschlossenen Arbeiten"></textarea>
                        
                        <label>Nächste Schritte:</label>
                        <textarea placeholder="Geplante nächste Schritte"></textarea>
                        
                        <label>Probleme/Herausforderungen:</label>
                        <textarea placeholder="Aktuelle Probleme und Lösungsansätze"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Nachbereitung & Kontrolle -->
            <div id="nachbereitung" class="tab-content">
                <div class="section">
                    <h2>Nachbereitung und Kontrolle</h2>
                    
                    <h3>1. Abschlussbericht</h3>
                    <div class="form-group">
                        <label>Projektergebnis:</label>
                        <textarea placeholder="Zusammenfassung der Projektergebnisse"></textarea>
                        
                        <label>Erreichte Ziele:</label>
                        <textarea placeholder="Auflistung der erreichten Ziele"></textarea>
                        
                        <label>Nicht erreichte Ziele:</label>
                        <textarea placeholder="Auflistung der nicht erreichten Ziele mit Begründung"></textarea>
                    </div>
                    
                    <h3>2. Leistungsprüfung</h3>
                    <div class="form-group">
                        <label>Leistungskennzahlen:</label>
                        <textarea placeholder="Quantitative und qualitative Leistungskennzahlen"></textarea>
                        
                        <label>Abgleich mit Plan:</label>
                        <textarea placeholder="Vergleich der Ergebnisse mit dem ursprünglichen Plan"></textarea>
                        
                        <label>Kundenfeedback:</label>
                        <textarea placeholder="Feedback des Kunden zum Projekt"></textarea>
                    </div>
                    
                    <h3>3. Lessons Learned</h3>
                    <div class="form-group">
                        <label>Erfolgsfaktoren:</label>
                        <textarea placeholder="Was hat besonders gut funktioniert?"></textarea>
                        
                        <label>Verbesserungspotentiale:</label>
                        <textarea placeholder="Was sollte beim nächsten Mal besser gemacht werden?"></textarea>
                        
                        <label>Empfehlungen:</label>
                        <textarea placeholder="Empfehlungen für zukünftige Projekte"></textarea>
                    </div>
                    
                    <h3>4. Übergabe und Abschluss</h3>
                    <div class="form-group">
                        <label>Übergabedokumente:</label>
                        <textarea placeholder="Liste der übergebenen Dokumente und Systeme"></textarea>
                        
                        <label>Schulungen durchgeführt:</label>
                        <textarea placeholder="Durchgeführte Schulungen und Schulungsmaterialien"></textarea>
                        
                        <label>Gewährleistung/Support:</label>
                        <textarea placeholder="Details zu Gewährleistung und Support"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Vorlagen & Tools -->
            <div id="vorlagen" class="tab-content">
                <div class="section">
                    <h2>Vorlagen & Tools</h2>
                </div>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn btn-secondary" onclick="printDocument()">📄 Dokument drucken</button>
            <button class="btn btn-primary" onclick="saveDocument()">💾 Dokument speichern</button>
            <button class="btn btn-success" onclick="exportHandover()">🔄 Übergabe-Paket exportieren</button>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function addTaskRow() {
            const tableBody = document.getElementById('aufgabenTable');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Aufgabenbeschreibung"></td>
                <td><input type="text" placeholder="Verantwortlich"></td>
                <td>
                    <select>
                        <option>Geplant</option>
                        <option>In Bearbeitung</option>
                        <option>Abgeschlossen</option>
                        <option>Verzögert</option>
                    </select>
                </td>
                <td><input type="date"></td>
                <td><input type="text" placeholder="Kommentare"></td>
            `;
            tableBody.appendChild(newRow);
        }

        function addRiskRow() {
            const tableBody = document.getElementById('risikoTable');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Risikobeschreibung"></td>
                <td>
                    <select>
                        <option>Technisch</option>
                        <option>Organisatorisch</option>
                        <option>Finanziell</option>
                        <option>Zeitlich</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option>Niedrig</option>
                        <option>Mittel</option>
                        <option>Hoch</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option>Gering</option>
                        <option>Mittel</option>
                        <option>Hoch</option>
                    </select>
                </td>
                <td><input type="text" placeholder="Maßnahmen"></td>
            `;
            tableBody.appendChild(newRow);
        }

        function addMilestone() {
            const milestonesContainer = document.getElementById('milestones');
            const newMilestone = document.createElement('div');
            newMilestone.className = 'milestone-item';
            newMilestone.innerHTML = `
                <div class="form-row">
                    <div class="form-group">
                        <label>Meilenstein:</label>
                        <input type="text" placeholder="Meilensteinbeschreibung">
                    </div>
                    <div class="form-group">
                        <label>Datum:</label>
                        <input type="date">
                    </div>
                </div>
                <div class="form-group">
                    <label>Beschreibung:</label>
                    <textarea placeholder="Detaillierte Beschreibung des Meilensteins"></textarea>
                </div>
            `;
            milestonesContainer.appendChild(newMilestone);
        }

        function printDocument() {
            window.print();
        }

        function saveDocument() {
            // Daten aus allen Feldern sammeln - Projektübersicht
            const kundenname = document.querySelector('#grundlagen input[placeholder="Name des Kunden"]').value;
            const projektname = document.querySelector('#grundlagen input[placeholder="Name des Projekts"]').value;
            const projektbeschreibung = document.querySelector('#grundlagen textarea[placeholder="Detaillierte Beschreibung der vertraglich festgelegten Leistungen"]').value;
            const projektstart = document.querySelector('#grundlagen input[type="date"]').value;
            const projektende = document.querySelectorAll('#grundlagen input[type="date"]')[1].value;
            const zeitrahmen = document.querySelector('#grundlagen textarea[placeholder="Detaillierte Zeitplanung und Laufzeit des Projektes"]').value;

            // Vorbereitungsphase
            const projektziele = document.querySelector('#vorbereitung textarea[placeholder="Messbare Ziele des Projekts"]').value;
            const stakeholder = document.querySelector('#vorbereitung textarea[placeholder="Liste aller beteiligten Parteien mit Kontaktdaten"]').value;
            const erfolgskriterien = document.querySelector('#vorbereitung textarea[placeholder="Kriterien für den Projekterfolg"]').value;
            const geschaeftsanforderungen = document.querySelector('#vorbereitung textarea[placeholder="Beschreibung der Geschäftsanforderungen"]').value;
            const technischeAnforderungen = document.querySelector('#vorbereitung textarea[placeholder="Detaillierte technische Anforderungen"]').value;
            const sicherheitsanforderungen = document.querySelector('#vorbereitung textarea[placeholder="Compliance- und Sicherheitsanforderungen"]').value;
            const cloudModell = document.querySelector('#vorbereitung select').value;
            const cloudAnbieter = document.querySelector('#vorbereitung input[placeholder="Ausgewählte Cloud-Anbieter"]').value;
            const begruendungCloud = document.querySelector('#vorbereitung textarea[placeholder="Begründung für die Auswahl des Cloud-Anbieters"]').value;
            const migrationsplan = document.querySelector('#vorbereitung textarea[placeholder="Schritte für die Migration bestehender Systeme"]').value;
            const anfangsInves = document.querySelector('#vorbereitung textarea[placeholder="Details zu Anfangsinvestitionen"]').value;
            const laufendeKosten = document.querySelector('#vorbereitung textarea[placeholder="Details zu laufenden Betriebskosten"]').value;
            const kostenEinsparungen = document.querySelector('#vorbereitung textarea[placeholder="Mögliche Kosteneinsparungen durch Cloud-Lösung"]').value;

            // Bearbeitungsphase - Aufgabenverteilung
            const aufgabenRows = document.querySelectorAll('#aufgabenTable tr');
            let aufgabenHtml = '';
            aufgabenRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                aufgabenHtml += `
                    <tr>
                        <td>${inputs[0].value}</td>
                        <td>${inputs[1].value}</td>
                        <td>${inputs[2].value}</td>
                        <td>${inputs[3].value}</td>
                        <td>${inputs[4].value}</td>
                    </tr>
                `;
            });

            // Bearbeitungsphase - Meilensteine
            const milestoneItems = document.querySelectorAll('#milestones .milestone-item');
            let milestonesHtml = '';
            milestoneItems.forEach(item => {
                const milestoneName = item.querySelector('input[placeholder="Meilensteinbeschreibung"]').value;
                const milestoneDate = item.querySelector('input[type="date"]').value;
                const milestoneDescription = item.querySelector('textarea[placeholder="Detaillierte Beschreibung des Meilensteins"]').value;
                milestonesHtml += `
                    <div class="milestone-item">
                        <h4>${milestoneName} (Datum: ${milestoneDate})</h4>
                        <p>${milestoneDescription.replace(/\n/g, '<br>')}</p>
                    </div>
                `;
            });

            // Bearbeitungsphase - Risikomanagement
            const risikoRows = document.querySelectorAll('#risikoTable tr');
            let risikoHtml = '';
            risikoRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                risikoHtml += `
                    <tr>
                        <td>${inputs[0].value}</td>
                        <td>${inputs[1].value}</td>
                        <td>${inputs[2].value}</td>
                        <td>${inputs[3].value}</td>
                        <td>${inputs[4].value}</td>
                    </tr>
                `;
            });

            // Bearbeitungsphase - Fortschrittsbericht
            const aktuellerStatus = document.querySelector('#bearbeitung select').value;
            const abgeschlosseneArbeiten = document.querySelector('#bearbeitung textarea[placeholder="Beschreibung der abgeschlossenen Arbeiten"]').value;
            const naechsteSchritte = document.querySelector('#bearbeitung textarea[placeholder="Geplante nächste Schritte"]').value;
            const problemeHerausforderungen = document.querySelector('#bearbeitung textarea[placeholder="Aktuelle Probleme und Lösungsansätze"]').value;

            // Nachbereitung & Kontrolle
            const projektergebnis = document.querySelector('#nachbereitung textarea[placeholder="Zusammenfassung der Projektergebnisse"]').value;
            const erreichteZiele = document.querySelector('#nachbereitung textarea[placeholder="Auflistung der erreichten Ziele"]').value;
            const nichtErreichteZiele = document.querySelector('#nachbereitung textarea[placeholder="Auflistung der nicht erreichten Ziele mit Begründung"]').value;
            const leistungskennzahlen = document.querySelector('#nachbereitung textarea[placeholder="Quantitative und qualitative Leistungskennzahlen"]').value;
            const abgleichPlan = document.querySelector('#nachbereitung textarea[placeholder="Vergleich der Ergebnisse mit dem ursprünglichen Plan"]').value;
            const kundenfeedback = document.querySelector('#nachbereitung textarea[placeholder="Feedback des Kunden zum Projekt"]').value;
            const erfolgsfaktoren = document.querySelector('#nachbereitung textarea[placeholder="Was hat besonders gut funktioniert?"]').value;
            const verbesserungspotentiale = document.querySelector('#nachbereitung textarea[placeholder="Was sollte beim nächsten Mal besser gemacht werden?"]').value;
            const empfehlungen = document.querySelector('#nachbereitung textarea[placeholder="Empfehlungen für zukünftige Projekte"]').value;
            const uebergabedokumente = document.querySelector('#nachbereitung textarea[placeholder="Liste der übergebenen Dokumente und Systeme"]').value;
            const schulungenDurchgefuehrt = document.querySelector('#nachbereitung textarea[placeholder="Durchgeführte Schulungen und Schulungsmaterialien"]').value;
            const gewaehrleistungSupport = document.querySelector('#nachbereitung textarea[placeholder="Details zu Gewährleistung und Support"]').value;

            // Vorlagen & Tools (nur Textareas, falls gefüllt)
            /*
            const cloudArchitekturDok = document.querySelector('#vorlagen textarea[placeholder="Vorlage für die Dokumentation der Cloud-Architektur"]').value;
            const sicherheitskonzeptVorlage = document.querySelector('#vorlagen textarea[placeholder="Vorlage für Cloud-Sicherheitskonzepte"]').value;
            const migrationCheckliste = document.querySelector('#vorlagen textarea[placeholder="Checkliste für Cloud-Migration"]').value;
            const monitoringSetup = document.querySelector('#vorlagen textarea[placeholder="Vorlage für Monitoring-Konfiguration"]').value;
            const datenschutzDok = document.querySelector('#vorlagen textarea[placeholder="DSGVO-konforme Dokumentation"]').value;
            const auditBereitschaft = document.querySelector('#vorlagen textarea[placeholder="Checkliste für Cloud-Audits"]').value;
            const incidentResponsePlan = document.querySelector('#vorlagen textarea[placeholder="Vorlage für Incident Response"]').value;
            */

            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Cloud Management Dokumentation (Statisch)</title>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; line-height: 1.6; color: #333; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); padding: 40px; }
                        .header { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; margin-bottom: 30px;}
                        .header h1 { font-size: 2.2rem; margin-bottom: 10px; }
                        .header p { font-size: 1.1rem; opacity: 0.9; }
                        .section { margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
                        .section h2 { color: #1e293b; font-size: 1.8rem; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }
                        .section h3 { color: #334155; font-size: 1.3rem; margin-bottom: 15px; margin-top: 25px; }
                        .form-group { margin-bottom: 20px; }
                        .form-group label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; }
                        .form-group p { margin-top: 0; margin-bottom: 0; padding: 8px 0; border-bottom: 1px dotted #ccc; }
                        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
                        .table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
                        .table th, .table td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #e5e7eb; }
                        .table th { background: #f8fafc; font-weight: 600; color: #374151; }
                        .milestone-item { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin: 10px 0; }
                        .highlight-box { background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-left: 4px solid #0ea5e9; padding: 20px; margin: 20px 0; border-radius: 8px; }
                        @media (max-width: 768px) {
                            .form-row { grid-template-columns: 1fr; }
                            .container { padding: 20px; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>Cloud Management Dokumentationssystem</h1>
                            <p>Umfassende Dokumentvorlage für alle Projektphasen</p>
                        </div>

                        <div class="content">
                            <div class="section">
                                <h2>Projektübersicht</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Kundenname:</label>
                                        <p>${kundenname}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Projektname:</label>
                                        <p>${projektname}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Projektbeschreibung (Leistungsbeschreibung):</label>
                                    <p>${projektbeschreibung.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projektstart:</label>
                                        <p>${projektstart}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Projektende:</label>
                                        <p>${projektende}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Beauftragter Zeitrahmen:</label>
                                    <p>${zeitrahmen.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Vorbereitungsphase</h2>
                                <h3>1. Projektinitialisierungsdokument</h3>
                                <div class="form-group">
                                    <label>Projektziele:</label>
                                    <p>${projektziele.replace(/\n/g, '<br>')}</p>
                                    <label>Beteiligte Stakeholder:</label>
                                    <p>${stakeholder.replace(/\n/g, '<br>')}</p>
                                    <label>Erfolgskriterien:</label>
                                    <p>${erfolgskriterien.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>2. Anforderungsdokument</h3>
                                <div class="form-group">
                                    <label>Geschäftsanforderungen:</label>
                                    <p>${geschaeftsanforderungen.replace(/\n/g, '<br>')}</p>
                                    <label>Technische Anforderungen:</label>
                                    <p>${technischeAnforderungen.replace(/\n/g, '<br>')}</p>
                                    <label>Sicherheitsanforderungen:</label>
                                    <p>${sicherheitsanforderungen.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>3. Cloud-Strategie-Dokument</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Cloud-Modell:</label>
                                        <p>${cloudModell}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Cloud-Anbieter:</label>
                                        <p>${cloudAnbieter}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Begründung für Cloud-Anbieter:</label>
                                    <p>${begruendungCloud.replace(/\n/g, '<br>')}</p>
                                    <label>Migrationsplan:</label>
                                    <p>${migrationsplan.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>4. Kostenanalyse</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Anfangsinvestition:</label>
                                        <p>${anfangsInves.replace(/\n/g, '<br>')}</p>
                                        <label>Laufende Kosten:</label>
                                        <p>${laufendeKosten.replace(/\n/g, '<br>')}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Kosteneinsparungen:</label>
                                        <p>${kostenEinsparungen.replace(/\n/g, '<br>')}</p>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Bearbeitungsphase</h2>
                                <h3>1. Aufgabenverteilung</h3>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Aufgabe</th>
                                            <th>Verantwortlich</th>
                                            <th>Status</th>
                                            <th>Fällig</th>
                                            <th>Kommentare</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${aufgabenHtml}
                                    </tbody>
                                </table>
                                <h3>2. Zeitplan und Meilensteine</h3>
                                <div id="milestones">
                                    ${milestonesHtml}
                                </div>
                                <h3>3. Risikomanagement</h3>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Risiko</th>
                                            <th>Kategorie</th>
                                            <th>Eintrittswahrscheinlichkeit</th>
                                            <th>Auswirkung</th>
                                            <th>Maßnahme</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${risikoHtml}
                                    </tbody>
                                </table>
                                <h3>4. Fortschrittsbericht</h3>
                                <div class="form-group">
                                    <label>Aktueller Status:</label>
                                    <p>${aktuellerStatus}</p>
                                    <label>Abgeschlossene Arbeiten:</label>
                                    <p>${abgeschlosseneArbeiten.replace(/\n/g, '<br>')}</p>
                                    <label>Nächste Schritte:</label>
                                    <p>${naechsteSchritte.replace(/\n/g, '<br>')}</p>
                                    <label>Probleme/Herausforderungen:</label>
                                    <p>${problemeHerausforderungen.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Nachbereitung und Kontrolle</h2>
                                <h3>1. Abschlussbericht</h3>
                                <div class="form-group">
                                    <label>Projektergebnis:</label>
                                    <p>${projektergebnis.replace(/\n/g, '<br>')}</p>
                                    <label>Erreichte Ziele:</label>
                                    <p>${erreichteZiele.replace(/\n/g, '<br>')}</p>
                                    <label>Nicht erreichte Ziele:</label>
                                    <p>${nichtErreichteZiele.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>2. Leistungsprüfung</h3>
                                <div class="form-group">
                                    <label>Leistungskennzahlen:</label>
                                    <p>${leistungskennzahlen.replace(/\n/g, '<br>')}</p>
                                    <label>Abgleich mit Plan:</label>
                                    <p>${abgleichPlan.replace(/\n/g, '<br>')}</p>
                                    <label>Kundenfeedback:</label>
                                    <p>${kundenfeedback.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>3. Lessons Learned</h3>
                                <div class="form-group">
                                    <label>Erfolgsfaktoren:</label>
                                    <p>${erfolgsfaktoren.replace(/\n/g, '<br>')}</p>
                                    <label>Verbesserungspotentiale:</label>
                                    <p>${verbesserungspotentiale.replace(/\n/g, '<br>')}</p>
                                    <label>Empfehlungen:</label>
                                    <p>${empfehlungen.replace(/\n/g, '<br>')}</p>
                                </div>
                                <h3>4. Übergabe und Abschluss</h3>
                                <div class="form-group">
                                    <label>Übergabedokumente:</label>
                                    <p>${uebergabedokumente.replace(/\n/g, '<br>')}</p>
                                    <label>Schulungen durchgeführt:</label>
                                    <p>${schulungenDurchgefuehrt.replace(/\n/g, '<br>')}</p>
                                    <label>Gewährleistung/Support:</label>
                                    <p>${gewaehrleistungSupport.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Vorlagen & Tools</h2>
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Cloud-Management-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation erstellt!');
        }


        function exportHandover() {
            alert('Übergabe-Paket Export würde hier implementiert werden - alle relevanten Dokumente und Daten für nahtlose Übergabe');
        }
    </script>
    </body>
</html>
