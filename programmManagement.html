<!DOCTYPE html>
<html lang="de">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programmmanagement Dokumentationssystem</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>Programmmanagement Dokumentationssystem</h1>
            <p>Umfassende Vorlage f√ºr die gesamte Programmlebensdauer</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('grundlagen', event)">Programmgrundlagen</button>
            <button class="nav-tab" onclick="showTab('strategie', event)">Programmstrategie & Planung</button>
            <button class="nav-tab" onclick="showTab('durchfuehrung', event)">Programmdurchf√ºhrung & Kontrolle</button>
            <button class="nav-tab" onclick="showTab('abschluss', event)">Programm-Abschluss & √úbergabe</button>
            <button class="nav-tab" onclick="showTab('vorlagen', event)">Vorlagen & Tools</button>
        </div>

        <div class="content">
            <div id="grundlagen" class="tab-content active">
                <div class="section">
                    <h2>Programmgrundlagen</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <h3>Organisationsdaten</h3>
                            <label>Unternehmens-/Organisationsname:</label>
                            <input type="text" placeholder="Name der Organisation">

                            <label>Programm-Sponsor:</label>
                            <input type="text" placeholder="Name & Position des Programm-Sponsors">

                            <label>Lenkungsausschuss (falls zutreffend):</label>
                            <textarea placeholder="Mitglieder des Lenkungsausschusses f√ºr das Programm"></textarea>

                            <h3>Stakeholder/Ansprechpartner</h3>
                            <div id="stakeholderContainer">
                                <div class="stakeholder-item">
                                    <button type="button" class="delete-button" onclick="deleteStakeholder(this)">X</button>
                                    <div class="form-group">
                                        <label>Name:</label>
                                        <input type="text" placeholder="Name des Stakeholders">
                                    </div>
                                    <div class="form-group">
                                        <label>Firma:</label>
                                        <input type="text" placeholder="Firma des Stakeholders">
                                    </div>
                                    <div class="form-group">
                                        <label>E-Mail:</label>
                                        <input type="email" placeholder="E-Mail des Stakeholders">
                                    </div>
                                    <div class="form-group">
                                        <label>Telefonnummer:</label>
                                        <input type="tel" placeholder="Telefonnummer des Stakeholders">
                                    </div>
                                    <div class="form-group">
                                        <label>Rolle/Interesse:</label>
                                        <textarea placeholder="Rolle oder Interesse des Stakeholders am Programm"></textarea>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-secondary" onclick="addStakeholder()">+ Weiteren Stakeholder hinzuf√ºgen</button>

                        </div>

                        <div class="form-group">
                            <h3>Programm-Details</h3>
                            <label>Programmname:</label>
                            <input type="text" placeholder="Bezeichnung des Programms">

                            <label>Programm-ID:</label>
                            <input type="text" placeholder="Interne Programm-Kennung">

                            <label>Programm-Manager:</label>
                            <input type="text" placeholder="Name des verantwortlichen Programm-Managers">

                            <label>Programmlaufzeit:</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="date" placeholder="Startdatum">
                                <input type="date" placeholder="Enddatum">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Programm-Vision & Strategische Ziele:</label>
                        <textarea placeholder="√úbergeordnete Vision und strategische Ausrichtung des Programms"></textarea>

                        <label>Business Case & Nutzen (Benefits):</label>
                        <textarea placeholder="Gesch√§ftlicher Nutzen, erwarteter ROI und Begr√ºndung des Programms"></textarea>

                        <label>Programm-Beschreibung (Umfang & Abgrenzung):</label>
                        <textarea placeholder="Detaillierte Beschreibung des Programmumfangs und die Abgrenzung zu anderen Initiativen"></textarea>

                        <label>Verbundene Projekte:</label>
                        <div id="projectContainer">
                            <div class="project-row">
                                <button type="button" class="delete-button" onclick="deleteProject(this)">X</button>
                                <div class="form-group">
                                    <label>Projektname:</label>
                                    <input type="text" placeholder="Name des Projekts">
                                </div>
                                <div class="form-group">
                                    <label>Projektleiter:</label>
                                    <input type="text" placeholder="Name des Projektleiters">
                                </div>
                                <div class="form-group">
                                    <label>Startdatum:</label>
                                    <input type="date">
                                </div>
                                <div class="form-group">
                                    <label>Enddatum:</label>
                                    <input type="date">
                                </div>
                                <div class="form-group">
                                    <label>Status:</label>
                                    <select>
                                        <option>Geplant</option>
                                        <option>Aktiv</option>
                                        <option>On Hold</option>
                                        <option>Abgeschlossen</option>
                                        <option>Abgebrochen</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="addProject()">+ Weiteres Projekt hinzuf√ºgen</button>
                    </div>
                </div>
            </div>

            <div id="strategie" class="tab-content">
                <div class="section">
                    <h2>Programmstrategie & Planung</h2>

                    <h3>1. Programm-Governance & Organisation</h3>
                    <div class="form-group">
                        <label>Governance-Struktur des Programms:</label>
                        <textarea placeholder="Beschreibung der Entscheidungsstrukturen, Gremien und Rollen innerhalb des Programms"></textarea>

                        <label>Rollen und Verantwortlichkeiten:</label>
                        <textarea placeholder="Detaillierte Definition der Rollen und Verantwortlichkeiten f√ºr alle Programmmitglieder und Stakeholder"></textarea>
                    </div>

                    <h3>2. Umfassendes Anforderungsmanagement</h3>
                    <div class="form-group">
                        <label>Gesch√§ftsanforderungen auf Programmebene:</label>
                        <textarea placeholder="√úbergeordnete Gesch√§ftsanforderungen, die durch das Programm erf√ºllt werden sollen"></textarea>

                        <label>Technische und systemische Anforderungen:</label>
                        <textarea placeholder="Anforderungen an die Gesamtarchitektur, Integrationen und technische Infrastruktur"></textarea>

                        <label>Nicht-funktionale Anforderungen:</label>
                        <textarea placeholder="Anforderungen an Performance, Skalierbarkeit, Sicherheit, Compliance, Verf√ºgbarkeit etc. auf Programmebene"></textarea>
                    </div>

                    <h3>3. Ressourcen- und Finanzmanagement</h3>
                    <div class="form-group">
                        <label>Ressourcenplanung (Personal, Infrastruktur, Tools):</label>
                        <textarea placeholder="Planung der ben√∂tigten personellen Ressourcen, Infrastruktur und Tools f√ºr das gesamte Programm"></textarea>

                        <label>Programm-Budget & Finanzierungsplan:</label>
                        <textarea placeholder="Detailliertes Gesamtbudget des Programms und Plan f√ºr die Mittelbeschaffung"></textarea>

                        <label>Kosten-Nutzen-Analyse und ROI-Prognose:</label>
                        <textarea placeholder="Analyse der erwarteten Kosten und Nutzen √ºber die gesamte Programmlaufzeit, inkl. ROI-Prognosen"></textarea>
                    </div>

                    <h3>4. Kommunikations- und Change-Management</h3>
                    <div class="form-group">
                        <label>Kommunikationsstrategie & -plan:</label>
                        <textarea placeholder="Plan f√ºr die interne und externe Kommunikation des Programms, Zielgruppen und Kan√§le"></textarea>

                        <label>Change-Management-Strategie:</label>
                        <textarea placeholder="Strategie zur Begleitung von Ver√§nderungen, Sicherstellung der Akzeptanz und Minimierung von Widerst√§nden"></textarea>

                        <label>Stakeholder-Engagement-Plan:</label>
                        <textarea placeholder="Plan zur aktiven Einbindung und Pflege der Beziehungen zu allen relevanten Stakeholdern"></textarea>
                    </div>
                </div>
            </div>

            <div id="durchfuehrung" class="tab-content">
                <div class="section">
                    <h2>Programmdurchf√ºhrung & Kontrolle</h2>

                    <h3>1. Fortschrittsbericht & Statusaktualisierung</h3>
                    <div class="form-group">
                        <label>Aktueller Gesamtstatus Programm:</label>
                        <select>
                            <option>üü¢ Gr√ºn - Im Plan</option>
                            <option>üü° Gelb - Achtung</option>
                            <option>üî¥ Rot - Kritisch</option>
                        </select>

                        <label>Abgeschlossene Meilensteine im Berichtszeitraum:</label>
                        <textarea placeholder="Detaillierte Beschreibung der fertiggestellten Meilensteine und erreichten Ziele der Projekte"></textarea>

                        <label>N√§chste geplante Meilensteine & Aktivit√§ten:</label>
                        <textarea placeholder="√úbersicht der unmittelbar bevorstehenden Meilensteine und Aktivit√§ten f√ºr den n√§chsten Berichtszeitraum"></textarea>

                        <label>Herausforderungen & L√∂sungsans√§tze auf Programmebene:</label>
                        <textarea placeholder="Aktuelle Herausforderungen, aufgetretene Probleme und die geplanten oder bereits eingeleiteten L√∂sungsans√§tze"></textarea>
                    </div>

                    <h3>2. Programm-Zeitplan & -Roadmap</h3>
                    <div class="form-group">
                        <label>Detaillierter Zeitplan & Phasen:</label>
                        <textarea placeholder="Umfassender Zeitplan mit allen Programmphasen, Hauptaktivit√§ten und Abh√§ngigkeiten"></textarea>

                        <label>Meilensteine auf Programmebene:</label>
                        <div id="programMilestones">
                            <div class="milestone-item">
                                <button type="button" class="delete-button" onclick="deleteProgramMilestone(this)">X</button>
                                <div class="form-group">
                                    <label>Meilenstein:</label>
                                    <input type="text" placeholder="Meilenstein-Bezeichnung">
                                </div>
                                <div class="form-group">
                                    <label>Zieldatum:</label>
                                    <input type="date">
                                </div>
                                <div class="form-group">
                                    <label>Beschreibung & Erfolgskriterien:</label>
                                    <textarea placeholder="Detaillierte Beschreibung des Meilensteins und messbare Erfolgskriterien"></textarea>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="addProgramMilestone()">+ Weiteren Programm-Meilenstein hinzuf√ºgen</button>

                        <label>Programm-Roadmap:</label>
                        <textarea placeholder="Visualisierung des Programmverlaufs und der Hauptlieferobjekte √ºber die Zeit"></textarea>
                    </div>

                    <h3>3. Risikomanagement auf Programmebene</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Risiko</th>
                                <th>Kategorie</th>
                                <th>Eintrittswahrscheinlichkeit</th>
                                <th>Auswirkung</th>
                                <th>Ma√ünahme & Verantwortlicher</th>
                            </tr>
                        </thead>
                        <tbody id="risikoTable">
                            <tr>
                                <td><input type="text" placeholder="Risikobeschreibung"></td>
                                <td>
                                    <select>
                                        <option>Strategisch</option>
                                        <option>Finanziell</option>
                                        <option>Operativ</option>
                                        <option>Regulatorisch/Compliance</option>
                                        <option>Reputation</option>
                                        <option>Technologisch</option>
                                    </select>
                                </td>
                                <td>
                                    <select>
                                        <option>Niedrig</option>
                                        <option>Mittel</option>
                                        <option>Hoch</option>
                                    </select>
                                </td>
                                <td>
                                    <select>
                                        <option>Gering</option>
                                        <option>Mittel</option>
                                        <option>Hoch</option>
                                    </select>
                                </td>
                                <td><input type="text" placeholder="Ma√ünahmen zur Risikominimierung und wer ist verantwortlich"></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-secondary" onclick="addRiskRow()">+ Weiteres Risiko hinzuf√ºgen</button>

                    <div class="form-group">
                        <label>Aktuelle Issues/Probleme auf Programmebene:</label>
                        <textarea placeholder="Liste der aktuellen Probleme, Blockaden und offenen Punkte, die das Programm betreffen"></textarea>
                        <label>Eskalationsprozesse:</label>
                        <textarea placeholder="Beschreibung der Eskalationswege f√ºr kritische Probleme im Programmkontext"></textarea>
                    </div>
                </div>
            </div>

            <div id="abschluss" class="tab-content">
                <div class="section">
                    <h2>Programm-Abschluss & √úbergabe</h2>

                    <h3>1. Abschlussbericht des Programms</h3>
                    <div class="form-group">
                        <label>Zusammenfassung der Programmergebnisse:</label>
                        <textarea placeholder="Kurze und pr√§gnante √úbersicht √ºber die wichtigsten Ergebnisse und Erfolge des Programms"></textarea>

                        <label>Erreichte Nutzen (Benefits) & Ziele:</label>
                        <textarea placeholder="Auflistung aller urspr√ºnglich definierten Nutzen und Ziele, die erreicht wurden"></textarea>

                        <label>Nicht erreichte Nutzen/Ziele & Begr√ºndung:</label>
                        <textarea placeholder="Auflistung der Nutzen oder Ziele, die nicht vollst√§ndig erreicht wurden, mit detaillierter Begr√ºndung"></textarea>

                        <label>Finanzieller Abschluss & Abweichungen vom Budget:</label>
                        <textarea placeholder="Analyse der finalen Programmkosten, Abweichungen vom urspr√ºnglichen Budget und Ursachenanalyse"></textarea>

                        <label>Qualitativer Abschluss & Lessons Learned:</label>
                        <textarea placeholder="Zusammenfassung der wichtigsten Learnings, Best Practices und Empfehlungen f√ºr zuk√ºnftige Programme oder Projekte"></textarea>
                    </div>

                    <h3>2. Evaluierung & Monitoring des Nutzens</h3>
                    <div class="form-group">
                        <label>KPIs zur Nutzenmessung nach Programm-Abschluss:</label>
                        <textarea placeholder="Definition von Key Performance Indicators (KPIs) zur Messung des langfristigen Nutzens nach Programmende"></textarea>

                        <label>Monitoring-Plan f√ºr Benefits:</label>
                        <textarea placeholder="Plan zur √úberwachung und Berichterstattung √ºber die Realisierung der erwarteten Nutzen nach Programm-Abschluss"></textarea>
                    </div>

                    <h3>3. Formeller Programm-Abschluss</h3>
                    <div class="form-group">
                        <label>√úbergabe an den Linienbetrieb/Nachfolgeorganisation:</label>
                        <textarea placeholder="Details zur formellen √úbergabe der Programmergebnisse an die zust√§ndigen Linienorganisationen oder nachfolgende Programme/Projekte"></textarea>

                        <label>Formelle Programmschlie√üung:</label>
                        <textarea placeholder="Datum und Details zur formellen Abnahme und Schlie√üung des Programms"></textarea>
                    </div>
                </div>
            </div>

            <div id="vorlagen" class="tab-content">
                <div class="section">
                    <h2>Vorlagen & Tools</h2>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-secondary" onclick="printDocument()">üìÑ Dokument drucken</button>
            <button class="btn btn-primary" onclick="saveAsStaticHtml()">üíæ Dokument speichern</button>
            <button class="btn btn-success" onclick="exportHandover()">üîÑ √úbergabe-Paket exportieren</button>
        </div>
    </div>

    <script>
        function showTab(tabName, event) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');

            if (event) {
                event.currentTarget.classList.add('active');
            }
        }

        // Add Stakeholder for Programmmanagement
        function addStakeholder() {
            const container = document.getElementById('stakeholderContainer');
            const newStakeholder = document.createElement('div');
            newStakeholder.className = 'stakeholder-item';
            newStakeholder.innerHTML = `
                <button type="button" class="delete-button" onclick="deleteStakeholder(this)">X</button>
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" placeholder="Name des Stakeholders">
                </div>
                <div class="form-group">
                    <label>Firma:</label>
                    <input type="text" placeholder="Firma des Stakeholders">
                </div>
                <div class="form-group">
                    <label>E-Mail:</label>
                    <input type="email" placeholder="E-Mail des Stakeholders">
                </div>
                <div class="form-group">
                    <label>Telefonnummer:</label>
                    <input type="tel" placeholder="Telefonnummer des Stakeholders">
                </div>
                <div class="form-group">
                    <label>Rolle/Interesse:</label>
                    <textarea placeholder="Rolle oder Interesse des Stakeholders am Programm"></textarea>
                </div>
            `;
            container.appendChild(newStakeholder);
        }

        // Delete Stakeholder for Programmmanagement
        function deleteStakeholder(buttonElement) {
            const item = buttonElement.closest('.stakeholder-item');
            if (item) {
                item.remove();
            }
        }

        // Add Project for Programmmanagement
        function addProject() {
            const container = document.getElementById('projectContainer');
            const newProject = document.createElement('div');
            newProject.className = 'project-row';
            newProject.innerHTML = `
                <button type="button" class="delete-button" onclick="deleteProject(this)">X</button>
                <div class="form-group">
                    <label>Projektname:</label>
                    <input type="text" placeholder="Name des Projekts">
                </div>
                <div class="form-group">
                    <label>Projektleiter:</label>
                    <input type="text" placeholder="Name des Projektleiters">
                </div>
                <div class="form-group">
                    <label>Startdatum:</label>
                    <input type="date">
                </div>
                <div class="form-group">
                    <label>Enddatum:</label>
                    <input type="date">
                </div>
                <div class="form-group">
                    <label>Status:</label>
                    <select>
                        <option>Geplant</option>
                        <option>Aktiv</option>
                        <option>On Hold</option>
                        <option>Abgeschlossen</option>
                        <option>Abgebrochen</option>
                    </select>
                </div>
            `;
            container.appendChild(newProject);
        }

        // Delete Project for Programmmanagement
        function deleteProject(buttonElement) {
            const item = buttonElement.closest('.project-row');
            if (item) {
                item.remove();
            }
        }

        // Add Program Milestone for Programmmanagement
        function addProgramMilestone() {
            const milestonesContainer = document.getElementById('programMilestones');
            const newMilestone = document.createElement('div');
            newMilestone.className = 'milestone-item';
            newMilestone.innerHTML = `
                <button type="button" class="delete-button" onclick="deleteProgramMilestone(this)">X</button>
                <div class="form-group">
                    <label>Meilenstein:</label>
                    <input type="text" placeholder="Meilenstein-Bezeichnung">
                </div>
                <div class="form-group">
                    <label>Zieldatum:</label>
                    <input type="date">
                </div>
                <div class="form-group">
                    <label>Beschreibung & Erfolgskriterien:</label>
                    <textarea placeholder="Detaillierte Beschreibung des Meilensteins und messbare Erfolgskriterien"></textarea>
                </div>
            `;
            milestonesContainer.appendChild(newMilestone);
        }

        // Delete Program Milestone for Programmmanagement
        function deleteProgramMilestone(buttonElement) {
            const item = buttonElement.closest('.milestone-item');
            if (item) {
                item.remove();
            }
        }

        function addRiskRow() {
            const tableBody = document.getElementById('risikoTable');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="Risikobeschreibung"></td>
                <td>
                    <select>
                        <option>Strategisch</option>
                        <option>Finanziell</option>
                        <option>Operativ</option>
                        <option>Regulatorisch/Compliance</option>
                        <option>Reputation</option>
                        <option>Technologisch</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option>Niedrig</option>
                        <option>Mittel</option>
                        <option>Hoch</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option>Gering</option>
                        <option>Mittel</option>
                        <option>Hoch</option>
                    </select>
                </td>
                <td><input type="text" placeholder="Ma√ünahmen zur Risikominimierung und wer ist verantwortlich"></td>
            `;
            tableBody.appendChild(newRow);
        }

        function printDocument() {
            window.print();
        }

        function saveAsStaticHtml() {
            // Daten aus allen Feldern sammeln - Programmgrundlagen
            const unternehmensname = document.querySelector('#grundlagen input[placeholder="Name der Organisation"]').value;
            const programmSponsor = document.querySelector('#grundlagen input[placeholder="Name & Position des Programm-Sponsors"]').value;
            const lenkungsausschuss = document.querySelector('#grundlagen textarea[placeholder="Mitglieder des Lenkungsausschusses f√ºr das Programm"]').value;

            const stakeholders = [];
            document.querySelectorAll('#stakeholderContainer .stakeholder-item').forEach(item => {
                stakeholders.push({
                    name: item.querySelector('input[placeholder="Name des Stakeholders"]').value,
                    firma: item.querySelector('input[placeholder="Firma des Stakeholders"]').value,
                    email: item.querySelector('input[placeholder="E-Mail des Stakeholders"]').value,
                    telefonnummer: item.querySelector('input[placeholder="Telefonnummer des Stakeholders"]').value,
                    rolle: item.querySelector('textarea[placeholder="Rolle oder Interesse des Stakeholders am Programm"]').value
                });
            });

            const programmname = document.querySelector('#grundlagen input[placeholder="Bezeichnung des Programms"]').value;
            const programmId = document.querySelector('#grundlagen input[placeholder="Interne Programm-Kennung"]').value;
            const programmManager = document.querySelector('#grundlagen input[placeholder="Name des verantwortlichen Programm-Managers"]').value;
            const programmlaufzeitStart = document.querySelector('div[style*="display: flex;"] input[type="date"]:nth-of-type(1)').value;
            const programmlaufzeitEnde = document.querySelector('div[style*="display: flex;"] input[type="date"]:nth-of-type(2)').value;
            const programmVision = document.querySelector('#grundlagen textarea[placeholder="√úbergeordnete Vision und strategische Ausrichtung des Programms"]').value;
            const businessCase = document.querySelector('#grundlagen textarea[placeholder="Gesch√§ftlicher Nutzen, erwarteter ROI und Begr√ºndung des Programms"]').value;
            const programmBeschreibung = document.querySelector('#grundlagen textarea[placeholder="Detaillierte Beschreibung des Programmumfangs und die Abgrenzung zu anderen Initiativen"]').value;

            const projects = [];
            document.querySelectorAll('#projectContainer .project-row').forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                projects.push({
                    name: inputs[0].value,
                    leiter: inputs[1].value,
                    startdatum: inputs[2].value,
                    enddatum: inputs[3].value,
                    status: inputs[4].value
                });
            });

            // Programmstrategie & Planung
            const governanceStruktur = document.querySelector('#strategie textarea[placeholder="Beschreibung der Entscheidungsstrukturen, Gremien und Rollen innerhalb des Programms"]').value;
            const rollenVerantwortlichkeiten = document.querySelector('#strategie textarea[placeholder="Detaillierte Definition der Rollen und Verantwortlichkeiten f√ºr alle Programmmitglieder und Stakeholder"]').value;
            const geschaeftsanforderungen = document.querySelector('#strategie textarea[placeholder="√úbergeordnete Gesch√§ftsanforderungen, die durch das Programm erf√ºllt werden sollen"]').value;
            const technischeAnforderungen = document.querySelector('#strategie textarea[placeholder="Anforderungen an die Gesamtarchitektur, Integrationen und technische Infrastruktur"]').value;
            const nichtFunktionaleAnforderungen = document.querySelector('#strategie textarea[placeholder="Anforderungen an Performance, Skalierbarkeit, Sicherheit, Compliance, Verf√ºgbarkeit etc. auf Programmebene"]').value;
            const ressourcenplanung = document.querySelector('#strategie textarea[placeholder="Planung der ben√∂tigten personellen Ressourcen, Infrastruktur und Tools f√ºr das gesamte Programm"]').value;
            const programmBudget = document.querySelector('#strategie textarea[placeholder="Detailliertes Gesamtbudget des Programms und Plan f√ºr die Mittelbeschaffung"]').value;
            const kostenNutzenAnalyse = document.querySelector('#strategie textarea[placeholder="Analyse der erwarteten Kosten und Nutzen √ºber die gesamte Programmlaufzeit, inkl. ROI-Prognosen"]').value;
            const kommunikationsstrategie = document.querySelector('#strategie textarea[placeholder="Plan f√ºr die interne und externe Kommunikation des Programms, Zielgruppen und Kan√§le"]').value;
            const changeManagement = document.querySelector('#strategie textarea[placeholder="Strategie zur Begleitung von Ver√§nderungen, Sicherstellung der Akzeptanz und Minimierung von Widerst√§nden"]').value;
            const stakeholderEngagement = document.querySelector('#strategie textarea[placeholder="Plan zur aktiven Einbindung und Pflege der Beziehungen zu allen relevanten Stakeholdern"]').value;

            // Programmdurchf√ºhrung & Kontrolle
            const aktuellerStatusProgramm = document.querySelector('#durchfuehrung select').value;
            const abgeschlosseneMeilensteine = document.querySelector('#durchfuehrung textarea[placeholder="Detaillierte Beschreibung der fertiggestellten Meilensteine und erreichten Ziele der Projekte"]').value;
            const naechsteMeilensteine = document.querySelector('#durchfuehrung textarea[placeholder="√úbersicht der unmittelbar bevorstehenden Meilensteine und Aktivit√§ten f√ºr den n√§chsten Berichtszeitraum"]').value;
            const herausforderungenProgramm = document.querySelector('#durchfuehrung textarea[placeholder="Aktuelle Herausforderungen, aufgetretene Probleme und die geplanten oder bereits eingeleiteten L√∂sungsans√§tze"]').value;
            const detaillierterZeitplan = document.querySelector('#durchfuehrung textarea[placeholder="Umfassender Zeitplan mit allen Programmphasen, Hauptaktivit√§ten und Abh√§ngigkeiten"]').value;

            const programMilestones = [];
            document.querySelectorAll('#programMilestones .milestone-item').forEach(item => {
                programMilestones.push({
                    name: item.querySelector('input[placeholder="Meilenstein-Bezeichnung"]').value,
                    zieldatum: item.querySelector('input[type="date"]').value,
                    beschreibung: item.querySelector('textarea[placeholder="Detaillierte Beschreibung des Meilensteins und messbare Erfolgskriterien"]').value
                });
            });

            const programmRoadmap = document.querySelector('#durchfuehrung textarea[placeholder="Visualisierung des Programmverlaufs und der Hauptlieferobjekte √ºber die Zeit"]').value;

            const risikoRows = document.querySelectorAll('#risikoTable tr');
            let risikoHtml = '';
            risikoRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                risikoHtml += `
                    <tr>
                        <td>${inputs[0].value}</td>
                        <td>${inputs[1].value}</td>
                        <td>${inputs[2].value}</td>
                        <td>${inputs[3].value}</td>
                        <td>${inputs[4].value}</td>
                    </tr>
                `;
            });

            const aktuelleIssuesProgramm = document.querySelector('#durchfuehrung textarea[placeholder="Liste der aktuellen Probleme, Blockaden und offenen Punkte, die das Programm betreffen"]').value;
            const eskalationsprozesseProgramm = document.querySelector('#durchfuehrung textarea[placeholder="Beschreibung der Eskalationswege f√ºr kritische Probleme im Programmkontext"]').value;

            // Programm-Abschluss & √úbergabe
            const programmergebnisse = document.querySelector('#abschluss textarea[placeholder="Kurze und pr√§gnante √úbersicht √ºber die wichtigsten Ergebnisse und Erfolge des Programms"]').value;
            const erreichteNutzenZiele = document.querySelector('#abschluss textarea[placeholder="Auflistung aller urspr√ºnglich definierten Nutzen und Ziele, die erreicht wurden"]').value;
            const nichtErreichteNutzenZiele = document.querySelector('#abschluss textarea[placeholder="Auflistung der Nutzen oder Ziele, die nicht vollst√§ndig erreicht wurden, mit detaillierter Begr√ºndung"]').value;
            const finanziellerAbschluss = document.querySelector('#abschluss textarea[placeholder="Analyse der finalen Programmkosten, Abweichungen vom urspr√ºnglichen Budget und Ursachenanalyse"]').value;
            const qualitativerAbschluss = document.querySelector('#abschluss textarea[placeholder="Zusammenfassung der wichtigsten Learnings, Best Practices und Empfehlungen f√ºr zuk√ºnftige Programme oder Projekte"]').value;
            const kpisNutzenmessung = document.querySelector('#abschluss textarea[placeholder="Definition von Key Performance Indicators (KPIs) zur Messung des langfristigen Nutzens nach Programmende"]').value;
            const monitoringPlanBenefits = document.querySelector('#abschluss textarea[placeholder="Plan zur √úberwachung und Berichterstattung √ºber die Realisierung der erwarteten Nutzen nach Programm-Abschluss"]').value;
            const uebergabeLinienbetrieb = document.querySelector('#abschluss textarea[placeholder="Details zur formellen √úbergabe der Programmergebnisse an die zust√§ndigen Linienorganisationen oder nachfolgende Programme/Projekte"]').value;
            const formelleSchliessung = document.querySelector('#abschluss textarea[placeholder="Datum und Details zur formellen Abnahme und Schlie√üung des Programms"]').value;


            let stakeholdersHtml = '';
            stakeholders.forEach(s => {
                stakeholdersHtml += `
                    <div class="stakeholder-item">
                        <h4>${s.name}</h4>
                        <p><strong>Firma:</strong> ${s.firma}</p>
                        <p><strong>E-Mail:</strong> ${s.email}</p>
                        <p><strong>Telefonnummer:</strong> ${s.telefonnummer}</p>
                        <p><strong>Rolle/Interesse:</strong> ${s.rolle.replace(/\n/g, '<br>')}</p>
                    </div>
                `;
            });

            let projectsHtml = '';
            projects.forEach(p => {
                projectsHtml += `
                    <tr>
                        <td>${p.name}</td>
                        <td>${p.leiter}</td>
                        <td>${p.startdatum}</td>
                        <td>${p.enddatum}</td>
                        <td>${p.status}</td>
                    </tr>
                `;
            });

            let programMilestonesHtml = '';
            programMilestones.forEach(m => {
                programMilestonesHtml += `
                    <div class="milestone-item">
                        <h4>${m.name} (Zieldatum: ${m.zieldatum})</h4>
                        <p>${m.beschreibung.replace(/\n/g, '<br>')}</p>
                    </div>
                `;
            });

            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Programmmanagement Dokumentation (Statisch)</title>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; line-height: 1.6; color: #333; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); padding: 40px; }
                        .header { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; margin-bottom: 30px;}
                        .header h1 { font-size: 2.2rem; margin-bottom: 10px; }
                        .header p { font-size: 1.1rem; opacity: 0.9; }
                        .section { margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
                        .section h2 { color: #1e293b; font-size: 1.8rem; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }
                        .section h3 { color: #334155; font-size: 1.3rem; margin-bottom: 15px; margin-top: 25px; }
                        .form-group { margin-bottom: 20px; }
                        .form-group label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; }
                        .form-group p {
                            margin-top: 0;
                            margin-bottom: 0;
                            padding: 8px 0;
                            border-bottom: 1px dotted #ccc;
                            word-wrap: break-word; /* Ensure long words break */
                            overflow-wrap: break-word; /* Modern equivalent */
                        }
                        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
                        .table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 20px 0;
                            background: white;
                            border-radius: 8px;
                            overflow: hidden;
                            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
                            table-layout: auto; /* Use 'auto' for flexible column widths */
                        }
                        .table th, .table td {
                            padding: 12px 15px;
                            text-align: left;
                            border-bottom: 1px solid #e5e7eb;
                            word-wrap: break-word; /* Ensure text in table cells wraps */
                            overflow-wrap: break-word; /* Modern equivalent */
                        }
                        .table th { background: #f8fafc; font-weight: 600; color: #374151; }
                        .stakeholder-item, .milestone-item { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin: 10px 0; position: relative;}
                        .highlight-box { background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-left: 4px solid #0ea5e9; padding: 20px; margin: 20px 0; border-radius: 8px; }
                        @media (max-width: 768px) {
                            .form-row { grid-template-columns: 1fr; }
                            .container { padding: 20px; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>Programmmanagement Dokumentationssystem</h1>
                            <p>Umfassende Vorlage f√ºr die gesamte Programmlebensdauer</p>
                        </div>

                        <div class="content">
                            <div class="section">
                                <h2>Programmgrundlagen</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <h3>Organisationsdaten</h3>
                                        <label>Unternehmens-/Organisationsname:</label>
                                        <p>${unternehmensname}</p>

                                        <label>Programm-Sponsor:</label>
                                        <p>${programmSponsor}</p>

                                        <label>Lenkungsausschuss (falls zutreffend):</label>
                                        <p>${lenkungsausschuss.replace(/\n/g, '<br>')}</p>

                                        <h3>Stakeholder/Ansprechpartner</h3>
                                        ${stakeholdersHtml}
                                    </div>
                                    <div class="form-group">
                                        <h3>Programm-Details</h3>
                                        <label>Programmname:</label>
                                        <p>${programmname}</p>

                                        <label>Programm-ID:</label>
                                        <p>${programmId}</p>

                                        <label>Programm-Manager:</label>
                                        <p>${programmManager}</p>

                                        <label>Programmlaufzeit:</label>
                                        <p>${programmlaufzeitStart} bis ${programmlaufzeitEnde}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Programm-Vision & Strategische Ziele:</label>
                                    <p>${programmVision.replace(/\n/g, '<br>')}</p>

                                    <label>Business Case & Nutzen (Benefits):</label>
                                    <p>${businessCase.replace(/\n/g, '<br>')}</p>

                                    <label>Programm-Beschreibung (Umfang & Abgrenzung):</label>
                                    <p>${programmBeschreibung.replace(/\n/g, '<br>')}</p>

                                    <label>Verbundene Projekte:</label>
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Projektname</th>
                                                <th>Projektleiter</th>
                                                <th>Startdatum</th>
                                                <th>Enddatum</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${projectsHtml}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Programmstrategie & Planung</h2>

                                <h3>1. Programm-Governance & Organisation</h3>
                                <div class="form-group">
                                    <label>Governance-Struktur des Programms:</label>
                                    <p>${governanceStruktur.replace(/\n/g, '<br>')}</p>

                                    <label>Rollen und Verantwortlichkeiten:</label>
                                    <p>${rollenVerantwortlichkeiten.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>2. Umfassendes Anforderungsmanagement</h3>
                                <div class="form-group">
                                    <label>Gesch√§ftsanforderungen auf Programmebene:</label>
                                    <p>${geschaeftsanforderungen.replace(/\n/g, '<br>')}</p>

                                    <label>Technische und systemische Anforderungen:</label>
                                    <p>${technischeAnforderungen.replace(/\n/g, '<br>')}</p>

                                    <label>Nicht-funktionale Anforderungen:</label>
                                    <p>${nichtFunktionaleAnforderungen.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>3. Ressourcen- und Finanzmanagement</h3>
                                <div class="form-group">
                                    <label>Ressourcenplanung (Personal, Infrastruktur, Tools):</label>
                                    <p>${ressourcenplanung.replace(/\n/g, '<br>')}</p>

                                    <label>Programm-Budget & Finanzierungsplan:</label>
                                    <p>${programmBudget.replace(/\n/g, '<br>')}</p>

                                    <label>Kosten-Nutzen-Analyse und ROI-Prognose:</label>
                                    <p>${kostenNutzenAnalyse.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>4. Kommunikations- und Change-Management</h3>
                                <div class="form-group">
                                    <label>Kommunikationsstrategie & -plan:</label>
                                    <p>${kommunikationsstrategie.replace(/\n/g, '<br>')}</p>

                                    <label>Change-Management-Strategie:</label>
                                    <p>${changeManagement.replace(/\n/g, '<br>')}</p>

                                    <label>Stakeholder-Engagement-Plan:</label>
                                    <p>${stakeholderEngagement.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Programmdurchf√ºhrung & Kontrolle</h2>

                                <h3>1. Fortschrittsbericht & Statusaktualisierung</h3>
                                <div class="form-group">
                                    <label>Aktueller Gesamtstatus Programm:</label>
                                    <p>${aktuellerStatusProgramm}</p>

                                    <label>Abgeschlossene Meilensteine im Berichtszeitraum:</label>
                                    <p>${abgeschlosseneMeilensteine.replace(/\n/g, '<br>')}</p>

                                    <label>N√§chste geplante Meilensteine & Aktivit√§ten:</label>
                                    <p>${naechsteMeilensteine.replace(/\n/g, '<br>')}</p>

                                    <label>Herausforderungen & L√∂sungsans√§tze auf Programmebene:</label>
                                    <p>${herausforderungenProgramm.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>2. Programm-Zeitplan & -Roadmap</h3>
                                <div class="form-group">
                                    <label>Detaillierter Zeitplan & Phasen:</label>
                                    <p>${detaillierterZeitplan.replace(/\n/g, '<br>')}</p>

                                    <label>Meilensteine auf Programmebene:</label>
                                    <div id="programMilestones">
                                        ${programMilestonesHtml}
                                    </div>

                                    <label>Programm-Roadmap:</label>
                                    <p>${programmRoadmap.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>3. Risikomanagement auf Programmebene</h3>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Risiko</th>
                                            <th>Kategorie</th>
                                            <th>Eintrittswahrscheinlichkeit</th>
                                            <th>Auswirkung</th>
                                            <th>Ma√ünahme & Verantwortlicher</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${risikoHtml}
                                    </tbody>
                                </table>

                                <div class="form-group">
                                    <label>Aktuelle Issues/Probleme auf Programmebene:</label>
                                    <p>${aktuelleIssuesProgramm.replace(/\n/g, '<br>')}</p>
                                    <label>Eskalationsprozesse:</label>
                                    <p>${eskalationsprozesseProgramm.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Programm-Abschluss & √úbergabe</h2>

                                <h3>1. Abschlussbericht des Programms</h3>
                                <div class="form-group">
                                    <label>Zusammenfassung der Programmergebnisse:</label>
                                    <p>${programmergebnisse.replace(/\n/g, '<br>')}</p>

                                    <label>Erreichte Nutzen (Benefits) & Ziele:</label>
                                    <p>${erreichteNutzenZiele.replace(/\n/g, '<br>')}</p>

                                    <label>Nicht erreichte Nutzen/Ziele & Begr√ºndung:</label>
                                    <p>${nichtErreichteNutzenZiele.replace(/\n/g, '<br>')}</p>

                                    <label>Finanzieller Abschluss & Abweichungen vom Budget:</label>
                                    <p>${finanziellerAbschluss.replace(/\n/g, '<br>')}</p>

                                    <label>Qualitativer Abschluss & Lessons Learned:</label>
                                    <p>${qualitativerAbschluss.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>2. Evaluierung & Monitoring des Nutzens</h3>
                                <div class="form-group">
                                    <label>KPIs zur Nutzenmessung nach Programm-Abschluss:</label>
                                    <p>${kpisNutzenmessung.replace(/\n/g, '<br>')}</p>

                                    <label>Monitoring-Plan f√ºr Benefits:</label>
                                    <p>${monitoringPlanBenefits.replace(/\n/g, '<br>')}</p>
                                </div>

                                <h3>3. Formeller Programm-Abschluss</h3>
                                <div class="form-group">
                                    <label>√úbergabe an den Linienbetrieb/Nachfolgeorganisation:</label>
                                    <p>${uebergabeLinienbetrieb.replace(/\n/g, '<br>')}</p>

                                    <label>Formelle Programmschlie√üung:</label>
                                    <p>${formelleSchliessung.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Programmmanagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation erstellt!');
        }

        function exportHandover() {
            alert('√úbergabe-Paket Export w√ºrde hier implementiert werden - alle relevanten Dokumente und Daten f√ºr nahtlose √úbergabe');
        }
    </script>

</body>
</html>
