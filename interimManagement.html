<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interim Management Dokumentationssystem</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Script-Bibliotheken für PDF-Export und OCR -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>Interim Management Dokumentationssystem</h1>
            <p>Umfassende Vorlage für die gesamte Interim Management Phase</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('kickoff', event)">Kickoff</button>
            <button class="nav-tab" onclick="showTab('report', event)">Status Report</button>
            <button class="nav-tab" onclick="showTab('handover', event)">Handover & Exit</button>
        </div>

        <div class="content">
            <div id="kickoff" class="tab-content active">
                <div class="section">
                    <h2>Interim Management Kickoff Details</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name">Projektname:</label>
                            <input type="text" id="project-name" placeholder="Projektname">
                        </div>
                        <div class="form-group">
                            <label for="client-company">Kundenunternehmen:</label>
                            <input type="text" id="client-company" placeholder="Name des Kundenunternehmens">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="interim-manager">Interim Manager:</label>
                            <input type="text" id="interim-manager" placeholder="Name des Interim Managers">
                        </div>
                        <div class="form-group">
                            <label for="role">Rolle/Position:</label>
                            <input type="text" id="role" placeholder="Übernommene Rolle/Position">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="start-date">Startdatum:</label>
                            <input type="date" id="start-date">
                        </div>
                        <div class="form-group">
                            <label for="end-date">Voraussichtliches Enddatum:</label>
                            <input type="date" id="end-date">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="assignment-goals">Ziele des Einsatzes:</label>
                        <textarea id="assignment-goals" placeholder="Detaillierte Beschreibung der primären Ziele und Erwartungen des Interim Mandats" class="textarea-large"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="scope">Umfang des Mandats:</label>
                        <textarea id="scope" placeholder="Genaue Definition des Umfangs, Verantwortlichkeiten und Abgrenzungen" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Stakeholder Analyse</h2>
                    <div id="stakeholder-list">
                        <div class="stakeholder-card">
                            <h3>Stakeholder 1</h3>
                            <div class="stakeholder-details">
                                <div class="stakeholder-detail">
                                    <strong>Name:</strong> <input type="text" class="data-table-input" placeholder="Name">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Rolle:</strong> <input type="text" class="data-table-input" placeholder="Rolle">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Abteilung:</strong> <input type="text" class="data-table-input" placeholder="Abteilung">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>E-Mail:</strong> <input type="email" class="data-table-input" placeholder="E-Mail">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Interesse:</strong>
                                    <select class="data-table-input interest-level">
                                        <option value="low" class="level-low">Niedrig</option>
                                        <option value="medium" class="level-medium">Mittel</option>
                                        <option value="high" class="level-high">Hoch</option>
                                    </select>
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Einfluss:</strong>
                                    <select class="data-table-input influence-level">
                                        <option value="low" class="level-low">Niedrig</option>
                                        <option value="medium" class="level-medium">Mittel</option>
                                        <option value="high" class="level-high">Hoch</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Kommunikationsstrategie:</label>
                                <textarea class="data-table-input" placeholder="Geplante Kommunikationsmaßnahmen"></textarea>
                            </div>
                            <button onclick="removeStakeholderKickoff(this)" class="delete-button">X</button>
                        </div>
                    </div>
                    <button class="add-button" onclick="addStakeholderKickoff()">+ Weiteren Stakeholder hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Deliverables & Meilensteine</h2>
                    <table class="data-table" id="deliverables-table">
                        <thead>
                            <tr>
                                <th>Aufgabe/Liefergegenstand</th>
                                <th>Verantwortlicher</th>
                                <th>Fälligkeitsdatum</th>
                                <th>Status</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Aufgabe beschreiben"></td>
                                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                                <td><input type="date" class="data-table-input"></td>
                                <td>
                                    <select class="data-table-input">
                                        <option>Geplant</option>
                                        <option>In Arbeit</option>
                                        <option>Abgeschlossen</option>
                                        <option>Verzögert</option>
                                    </select>
                                </td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addDeliverableRow()">+ Liefergegenstand hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Kommunikationsplan</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Zielgruppe</th>
                                <th>Frequenz</th>
                                <th>Kanal</th>
                                <th>Format</th>
                                <th>Zweck</th>
                                <th>Verantwortlicher</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="communication-plan-table">
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Zielgruppe"></td>
                                <td><input type="text" class="data-table-input" placeholder="Frequenz"></td>
                                <td><input type="text" class="data-table-input" placeholder="Kanal"></td>
                                <td><input type="text" class="data-table-input" placeholder="Format"></td>
                                <td><input type="text" class="data-table-input" placeholder="Zweck"></td>
                                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addCommunicationRow()">+ Kommunikationspunkt hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Ressourcen & Tools</h2>
                    <div class="form-group">
                        <label for="needed-resources">Benötigte Ressourcen (Teammitglieder, Software, Hardware):</label>
                        <textarea id="needed-resources" placeholder="Liste aller benötigten Ressourcen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="access-requirements">Zugangsberechtigungen & Systeme:</label>
                        <textarea id="access-requirements" placeholder="Erforderliche Zugänge und Systeme" class="textarea-large"></textarea>
                    </div>
                </div>
            </div>

            <div id="report" class="tab-content">
                <div class="section">
                    <h2>Berichtsübersicht</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name-report">Projektname:</label>
                            <input type="text" id="project-name-report" placeholder="Projektname">
                        </div>
                        <div class="form-group">
                            <label for="interim-manager-report">Interim Manager:</label>
                            <input type="text" id="interim-manager-report" placeholder="Name des Interim Managers">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="report-date">Berichtsdatum:</label>
                            <input type="date" id="report-date">
                        </div>
                        <div class="form-group">
                            <label for="reporting-period">Berichtszeitraum:</label>
                            <input type="text" id="reporting-period" placeholder="z.B. KW 28-30">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="overall-status">Gesamtstatus:</label>
                        <select id="overall-status">
                            <option value="green">🟢 Grün - Im Plan</option>
                            <option value="yellow">🟡 Gelb - Achtung</option>
                            <option value="red">🔴 Rot - Kritisch</option>
                        </select>
                    </div>
                </div>

                <div class="section">
                    <h2>Fortschritt & Meilensteine</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Meilenstein/Ziel</th>
                                <th>Plan-Datum</th>
                                <th>Aktuell/Prognose</th>
                                <th>Status</th>
                                <th>Kommentare</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="milestones-table-body">
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Milestone/Goal"></td>
                                <td><input type="date" class="data-table-input"></td>
                                <td><input type="text" class="data-table-input" placeholder="Actual/Forecast"></td>
                                <td>
                                    <select class="data-table-input">
                                        <option>Completed</option>
                                        <option>In progress</option>
                                        <option>Delayed</option>
                                        <option>Not started</option>
                                    </select>
                                </td>
                                <td><input type="text" class="data-table-input" placeholder="Comments"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addMilestoneReportRow()">+ Meilenstein hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Top Themen & Herausforderungen</h2>
                    <div class="form-group">
                        <label for="current-challenges">Aktuelle Herausforderungen:</label>
                        <textarea id="current-challenges" placeholder="Beschreibung der wichtigsten Herausforderungen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="measures-taken">Getroffene Maßnahmen & nächste Schritte:</label>
                        <textarea id="measures-taken" placeholder="Welche Maßnahmen wurden ergriffen und welche sind geplant?" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Risikomanagement (R.A.G.)</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Beschreibung des Risikos/Problems</th>
                                <th>Auswirkung</th>
                                <th>Wahrscheinlichkeit</th>
                                <th>Status</th>
                                <th>Maßnahmen & Verantwortlicher</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="risk-report-table-body">
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Risk/Issue Description"></td>
                                <td><input type="text" class="data-table-input" placeholder="Impact"></td>
                                <td><input type="text" class="data-table-input" placeholder="Probability"></td>
                                <td>
                                    <select class="data-table-input">
                                        <option>Rot</option>
                                        <option>Gelb</option>
                                        <option>Grün</option>
                                    </select>
                                </td>
                                <td><input type="text" class="data-table-input" placeholder="Actions & Owner"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addRiskReportRow()">+ Risiko/Problem hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Nächste Schritte & Empfehlungen</h2>
                    <div class="form-group">
                        <label for="next-steps-report">Geplante nächste Schritte:</label>
                        <textarea id="next-steps-report" placeholder="Detaillierte Auflistung der für den nächsten Zeitraum geplanten Aktivitäten" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="recommendations">Empfehlungen an das Management:</label>
                        <textarea id="recommendations" placeholder="Vorschläge und Empfehlungen zur Entscheidungsfindung" class="textarea-large"></textarea>
                    </div>
                </div>
            </div>

            <div id="handover" class="tab-content">
                <div class="section">
                    <h2>Mandatsübersicht</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mandate-project-name">Projekt/Mandatsname:</label>
                            <input type="text" id="mandate-project-name" placeholder="Name des Projekts oder Mandats">
                        </div>
                        <div class="form-group">
                            <label for="mandate-client">Kundenunternehmen:</label>
                            <input type="text" id="mandate-client" placeholder="Name des Kundenunternehmens">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mandate-interim-manager">Interim Manager:</label>
                            <input type="text" id="mandate-interim-manager" placeholder="Name des Interim Managers">
                        </div>
                        <div class="form-group">
                            <label for="mandate-role">Rolle/Position:</label>
                            <input type="text" id="mandate-role" placeholder="Übernommene Rolle/Position">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mandate-start-date">Startdatum:</label>
                            <input type="date" id="mandate-start-date">
                        </div>
                        <div class="form-group">
                            <label for="mandate-end-date">Enddatum:</label>
                            <input type="date" id="mandate-end-date">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="mandate-summary">Zusammenfassung der Mandatsziele & -ergebnisse:</label>
                        <textarea id="mandate-summary" placeholder="Kurze Beschreibung der ursprünglichen Ziele und der tatsächlich erreichten Ergebnisse" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Schlüsselinformationen & Dokumentation</h2>
                    <div class="form-group">
                        <label for="key-documents">Liste Schlüssel-Dokumente & Speicherorte:</label>
                        <textarea id="key-documents" placeholder="Wichtige Dokumente (Konzepte, Berichte, Verträge) und wo sie zu finden sind (SharePoint, Drive, etc.)" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="it-systems-access">Wichtige IT-Systeme & Zugänge:</label>
                        <textarea id="it-systems-access" placeholder="Liste der genutzten Systeme, Tools und notwendiger Zugänge/Passwörter (sicher übergeben!)" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="contacts-stakeholders">Wichtige Kontakte & Stakeholder:</label>
                        <textarea id="contacts-stakeholders" placeholder="Übersicht der internen und externen Schlüsselkontakte, Ansprechpartner und ihre Rollen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="pending-tasks">Offene Aufgaben & nächste Schritte:</label>
                        <textarea id="pending-tasks" placeholder="Detaillierte Liste aller offenen Aufgaben, Verantwortlichkeiten und Deadlines" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="current-projects-initiatives">Aktuelle Projekte & Initiativen:</label>
                        <textarea id="current-projects-initiatives" placeholder="Beschreibung laufender Projekte, deren Status und Abhängigkeiten" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Finanzielle Übergabe</h2>
                    <div class="form-group">
                        <label for="budget-overview">Budgetübersicht & offene Posten:</label>
                        <textarea id="budget-overview" placeholder="Aktueller Budgetstatus, ausstehende Zahlungen, Rechnungen, etc." class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="contract-details">Vertragsdetails & Konditionen:</label>
                        <textarea id="contract-details" placeholder="Wichtige Vertragskonditionen, Laufzeiten und Kündigungsfristen" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Lessons Learned & Empfehlungen</h2>
                    <div class="form-group">
                        <label for="lessons-learned">Lessons Learned aus dem Mandat:</label>
                        <textarea id="lessons-learned" placeholder="Erkenntnisse, Erfolgsfaktoren und Herausforderungen aus dem abgeschlossenen Mandat" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="recommendations-handover">Empfehlungen für Nachfolger/Organisation:</label>
                        <textarea id="recommendations-handover" placeholder="Konkrete Empfehlungen für den Nachfolger oder die Organisation" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Formelle Übergabe & Abnahme</h2>
                    <div class="form-group">
                        <label for="handover-date-final">Datum der Übergabe:</label>
                        <input type="date" id="handover-date-final">
                    </div>
                    <div class="form-group">
                        <label for="receiving-person">Übergabe an (Name, Position):</label>
                        <input type="text" id="receiving-person" placeholder="Name und Position des Empfängers">
                    </div>
                    <div class="form-group">
                        <label for="sign-off">Bestätigung/Sign-Off:</label>
                        <textarea id="sign-off" placeholder="Platz für Unterschriften oder formelle Bestätigung" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Checkliste für den Exit-Prozess</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-1">
                        <label for="checklist-1">Alle offenen Aufgaben dokumentiert und übergeben.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-2">
                        <label for="checklist-2">Alle wichtigen Dokumente zentral abgelegt und Zugänge geklärt.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-3">
                        <label for="checklist-3">IT-Zugänge und Berechtigungen widerrufen oder übergeben.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-4">
                        <label for="checklist-4">Alle finanziellen Aspekte (Rechnungen, Spesen) geklärt.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-5">
                        <label for="checklist-5">Formelle Übergabe & Abnahme erfolgt.</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-6">
                        <label for="checklist-6">Feedback-Gespräch mit dem Kunden geführt.</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-secondary" onclick="printDocument()">📄 Dokument drucken</button>
            <button class="btn btn-primary" onclick="saveCombinedDocument()">💾 Dokument speichern</button>
            <button class="btn btn-success" onclick="exportHandover()">🔄 Übergabe-Paket exportieren</button>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const firstTabButton = document.querySelector(".nav-tab");
            if (firstTabButton) {
                firstTabButton.click();
            }

            // Set today's date for relevant inputs
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) { // Only set if not already set
                    input.value = today;
                }
            });
            // Initialisierung für Kickoff-Datum (falls vorhanden)
            const kickoffCreationDate = document.getElementById('creation-date');
            if (kickoffCreationDate) {
                kickoffCreationDate.textContent = new Date().toLocaleDateString('de-DE');
            }
            const kickoffLastUpdate = document.getElementById('last-update');
            if (kickoffLastUpdate) {
                kickoffLastUpdate.textContent = new Date().toLocaleDateString('de-DE');
            }
            const reportDate = document.getElementById('report-date');
            if (reportDate) {
                reportDate.valueAsDate = new Date();
            }
        });

        function showTab(tabName, event) {
            // Entfernen der 'active'-Klasse von allen Tab-Inhalten
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Entfernen der 'active'-Klasse von allen Navigations-Buttons
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Hinzufügen der 'active'-Klasse zum ausgewählten Tab-Inhalt
            document.getElementById(tabName).classList.add('active');

            // Hinzufügen der 'active'-Klasse zum geklickten Navigations-Button
            if (event) {
                event.currentTarget.classList.add('active');
            }
        }

        function addDeliverableRow() {
            const tbody = document.querySelector('#deliverables-table tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="data-table-input" placeholder="Aufgabe beschreiben"></td>
                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                <td><input type="date" class="data-table-input"></td>
                <td>
                    <select class="data-table-input">
                        <option>Geplant</option>
                        <option>In Arbeit</option>
                        <option>Abgeschlossen</option>
                        <option>Verzögert</option>
                    </select>
                </td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function removeRow(button) {
            const row = button.closest('tr');
            row.remove();
        }

        function addStakeholderKickoff() {
            const stakeholderList = document.getElementById('stakeholder-list');
            const newStakeholderCard = document.createElement('div');
            newStakeholderCard.classList.add('stakeholder-card');
            newStakeholderCard.innerHTML = `
                <h3>Neuer Stakeholder</h3>
                <div class="stakeholder-details">
                    <div class="stakeholder-detail">
                        <strong>Name:</strong> <input type="text" class="data-table-input" placeholder="Name">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Rolle:</strong> <input type="text" class="data-table-input" placeholder="Rolle">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Abteilung:</strong> <input type="text" class="data-table-input" placeholder="Abteilung">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>E-Mail:</strong> <input type="email" class="data-table-input" placeholder="E-Mail">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Interesse:</strong>
                        <select class="data-table-input interest-level">
                            <option value="low" class="level-low">Niedrig</option>
                            <option value="medium" class="level-medium">Mittel</option>
                            <option value="high" class="level-high">Hoch</option>
                        </select>
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Einfluss:</strong>
                        <select class="data-table-input influence-level">
                            <option value="low" class="level-low">Niedrig</option>
                            <option value="medium" class="level-medium">Mittel</option>
                            <option value="high" class="level-high">Hoch</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Kommunikationsstrategie:</label>
                    <textarea class="data-table-input" placeholder="Geplante Kommunikationsmaßnahmen"></textarea>
                </div>
                <button onclick="removeStakeholderKickoff(this)" class="delete-button">X</button>
            `;
            stakeholderList.appendChild(newStakeholderCard);
        }

        function removeStakeholderKickoff(button) {
            button.closest('.stakeholder-card').remove();
        }

        function addCommunicationRow() {
            const tbody = document.getElementById('communication-plan-table');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="data-table-input" placeholder="Zielgruppe"></td>
                <td><input type="text" class="data-table-input" placeholder="Frequenz"></td>
                <td><input type="text" class="data-table-input" placeholder="Kanal"></td>
                <td><input type="text" class="data-table-input" placeholder="Format"></td>
                <td><input type="text" class="data-table-input" placeholder="Zweck"></td>
                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addMilestoneReportRow() {
            const tbody = document.getElementById('milestones-table-body');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="data-table-input" placeholder="Milestone/Goal"></td>
                <td><input type="date" class="data-table-input"></td>
                <td><input type="text" class="data-table-input" placeholder="Actual/Forecast"></td>
                <td>
                    <select class="data-table-input">
                        <option>Completed</option>
                        <option>In progress</option>
                        <option>Delayed</option>
                        <option>Not started</option>
                    </select>
                </td>
                <td><input type="text" class="data-table-input" placeholder="Comments"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function addRiskReportRow() {
            const tbody = document.getElementById('risk-report-table-body');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" class="data-table-input" placeholder="Risk/Issue Description"></td>
                <td><input type="text" class="data-table-input" placeholder="Impact"></td>
                <td><input type="text" class="data-table-input" placeholder="Probability"></td>
                <td>
                    <select class="data-table-input">
                        <option>Rot</option>
                        <option>Gelb</option>
                        <option>Grün</option>
                    </select>
                </td>
                <td><input type="text" class="data-table-input" placeholder="Actions & Owner"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function printDocument() {
            alert('Das Dokument wird gedruckt. In einer echten Anwendung würde dies die Druckfunktion des Browsers aufrufen.');
            window.print();
        }

        function saveCombinedDocument() {
            // Funktion zum Sammeln von Daten aus einer Tabelle
            function getTableData(tableBodyId) {
                const data = [];
                document.querySelectorAll(`#${tableBodyId} tr`).forEach(row => {
                    const rowData = {};
                    row.querySelectorAll('input, select, textarea').forEach((input, index) => {
                        const key = input.id || input.name || input.placeholder || `col${index}`;
                        rowData[key] = input.value;
                    });
                    data.push(rowData);
                });
                return data;
            }

            // Funktion zum Erstellen von HTML für Tabellendaten
            function createTableHtml(headers, data) {
                let html = '<table class="output-table"><thead><tr>';
                headers.forEach(header => {
                    html += `<th>${header}</th>`;
                });
                html += '</tr></thead><tbody>';
                data.forEach(row => {
                    html += '<tr>';
                    headers.forEach(header => {
                        const key = Object.keys(row).find(k => row[k] === row[header] || k.toLowerCase().includes(header.toLowerCase().replace(/ /g, '')));
                        html += `<td>${row[key] ? row[key].replace(/\n/g, '<br>') : ''}</td>`;
                    });
                    html += '</tr>';
                });
                html += '</tbody></table>';
                return html;
            }

            // --- Daten sammeln für Kickoff ---
            const projectNameKickoff = document.getElementById('project-name').value;
            const clientCompany = document.getElementById('client-company').value;
            const interimManagerKickoff = document.getElementById('interim-manager').value;
            const roleKickoff = document.getElementById('role').value;
            const startDate = document.getElementById('start-date').value;
            const endDate = document.getElementById('end-date').value;
            const assignmentGoals = document.getElementById('assignment-goals').value;
            const scopeKickoff = document.getElementById('scope').value;

            const stakeholderCards = [];
            document.querySelectorAll('#stakeholder-list .stakeholder-card').forEach(card => {
                const name = card.querySelector('.stakeholder-detail input[placeholder="Name"]').value;
                const role = card.querySelector('.stakeholder-detail input[placeholder="Rolle"]').value;
                const department = card.querySelector('.stakeholder-detail input[placeholder="Abteilung"]').value;
                const email = card.querySelector('.stakeholder-detail input[placeholder="E-Mail"]').value;
                const interest = card.querySelector('.stakeholder-detail select.interest-level').value;
                const influence = card.querySelector('.stakeholder-detail select.influence-level').value;
                const strategy = card.querySelector('.form-group textarea[placeholder="Geplante Kommunikationsmaßnahmen"]').value;
                stakeholderCards.push({ name, role, department, email, interest, influence, strategy });
            });

            const deliverables = getTableData('deliverables-table');
            const communicationPlan = getTableData('communication-plan-table');
            const neededResources = document.getElementById('needed-resources').value;
            const accessRequirements = document.getElementById('access-requirements').value;

            // --- Daten sammeln für Report ---
            const projectNameReport = document.getElementById('project-name-report').value;
            const interimManagerReport = document.getElementById('interim-manager-report').value;
            const reportDate = document.getElementById('report-date').value;
            const reportingPeriod = document.getElementById('reporting-period').value;
            const overallStatus = document.getElementById('overall-status').value;
            const milestonesReport = getTableData('milestones-table-body');
            const currentChallenges = document.getElementById('current-challenges').value;
            const measuresTaken = document.getElementById('measures-taken').value;
            const risksReport = getTableData('risk-report-table-body');
            const nextStepsReport = document.getElementById('next-steps-report').value;
            const recommendations = document.getElementById('recommendations').value;


            // --- Daten sammeln für Handover ---
            const mandateProjectName = document.getElementById('mandate-project-name').value;
            const mandateClient = document.getElementById('mandate-client').value;
            const mandateInterimManager = document.getElementById('mandate-interim-manager').value;
            const mandateRole = document.getElementById('mandate-role').value;
            const mandateStartDate = document.getElementById('mandate-start-date').value;
            const mandateEndDate = document.getElementById('mandate-end-date').value;
            const mandateSummary = document.getElementById('mandate-summary').value;
            const keyDocuments = document.getElementById('key-documents').value;
            const itSystemsAccess = document.getElementById('it-systems-access').value;
            const contactsStakeholders = document.getElementById('contacts-stakeholders').value;
            const pendingTasks = document.getElementById('pending-tasks').value;
            const currentProjectsInitiatives = document.getElementById('current-projects-initiatives').value;
            const budgetOverview = document.getElementById('budget-overview').value;
            const contractDetails = document.getElementById('contract-details').value;
            const lessonsLearnedHandover = document.getElementById('lessons-learned').value;
            const recommendationsHandover = document.getElementById('recommendations-handover').value;
            const handoverDateFinal = document.getElementById('handover-date-final').value;
            const receivingPerson = document.getElementById('receiving-person').value;
            const signOff = document.getElementById('sign-off').value;

            const checklistItems = [];
            document.querySelectorAll('.checklist-item input[type="checkbox"]').forEach(checkbox => {
                checklistItems.push({ id: checkbox.id, checked: checkbox.checked, label: document.querySelector(`label[for="${checkbox.id}"]`).textContent });
            });


            // --- HTML-Struktur für den Download erstellen ---
            let deliverablesHtml = createTableHtml(['Aufgabe/Liefergegenstand', 'Verantwortlicher', 'Fälligkeitsdatum', 'Status'], deliverables);
            let communicationPlanHtml = createTableHtml(['Zielgruppe', 'Frequenz', 'Kanal', 'Format', 'Zweck', 'Verantwortlicher'], communicationPlan);
            let milestonesReportHtml = createTableHtml(['Meilenstein/Ziel', 'Plan-Datum', 'Aktuell/Prognose', 'Status', 'Kommentare'], milestonesReport);
            let risksReportHtml = createTableHtml(['Beschreibung des Risikos/Problems', 'Auswirkung', 'Wahrscheinlichkeit', 'Status', 'Maßnahmen & Verantwortlicher'], risksReport);

            let stakeholderCardsHtml = stakeholderCards.map(s => `
                <div class="stakeholder-card-output">
                    <h4>${s.name}</h4>
                    <p><strong>Rolle:</strong> ${s.role}</p>
                    <p><strong>Abteilung:</strong> ${s.department}</p>
                    <p><strong>E-Mail:</strong> ${s.email}</p>
                    <p><strong>Interesse:</strong> <span class="level-${s.interest}">${s.interest}</span></p>
                    <p><strong>Einfluss:</strong> <span class="level-${s.influence}">${s.influence}</span></p>
                    <p><strong>Kommunikationsstrategie:</strong> ${s.strategy.replace(/\n/g, '<br>')}</p>
                </div>
            `).join('');


            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Interim Management Dokumentation (Statisch)</title>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; line-height: 1.6; color: #333; background: #f0f2f5; }
                        .report-container { max-width: 900px; margin: 20px auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
                        .header-exported {
                            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
                            color: white;
                            padding: 30px;
                            text-align: center;
                            border-radius: 8px 8px 0 0;
                            margin: -30px -30px 30px -30px;
                        }
                        .header-exported h1 { font-size: 2.2em; margin-bottom: 10px; font-weight: 300; }
                        .header-exported p { font-size: 1.1em; opacity: 0.9; }
                        h2, h3, h4 { color: #2c3e50; margin-top: 25px; margin-bottom: 10px; }
                        h2 { font-size: 1.8em; border-bottom: 2px solid #e0e0e0; padding-bottom: 8px; }
                        h3 { font-size: 1.3em; margin-bottom: 15px; }
                        h4 { font-size: 1.1em; margin-bottom: 10px; color: #4f46e5; }
                        .section { margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
                        .form-group p {
                            margin-top: 0;
                            margin-bottom: 0;
                            padding: 8px 0;
                            border-bottom: 1px dotted #ccc;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                        }
                        .form-group label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; }
                        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
                        .output-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 20px 0;
                            background: white;
                            border-radius: 8px;
                            overflow: hidden;
                            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
                            table-layout: auto;
                        }
                        .output-table th, .output-table td {
                            padding: 12px 15px;
                            text-align: left;
                            border-bottom: 1px solid #e5e7eb;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                        }
                        .output-table th { background: #f8fafc; font-weight: 600; color: #374151; }
                        .stakeholder-card-output {
                            background: #f8f9fa;
                            padding: 20px;
                            border-radius: 8px;
                            border-left: 4px solid #3498db;
                            margin-bottom: 15px;
                            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
                        }
                        .stakeholder-card-output h4 {
                            margin-top: 0;
                            color: #34495e;
                        }
                        .stakeholder-card-output p {
                            margin-bottom: 5px;
                        }
                        .level-low { background: #e8f5e8; color: #2e7d32; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; }
                        .level-medium { background: #fff3e0; color: #ef6c00; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; }
                        .level-high { background: #ffebee; color: #c62828; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; }
                        .checklist-item-output {
                            display: flex;
                            align-items: center;
                            margin-bottom: 10px;
                            padding: 10px;
                            background: #f0f2f5;
                            border-radius: 5px;
                        }
                        .checklist-item-output .checkbox-icon {
                            margin-right: 10px;
                            font-size: 1.2em;
                        }
                        .checklist-item-output .checkbox-icon.checked { color: #28a745; }
                        .checklist-item-output .checkbox-icon.unchecked { color: #dc3545; }

                        @media (max-width: 768px) {
                            .form-row { grid-template-columns: 1fr; }
                            .report-container { padding: 20px; }
                        }
                    </style>
                </head>
                <body>
                    <div class="report-container">
                        <div class="header-exported">
                            <h1>Interim Management Dokumentation</h1>
                            <p>Umfassende Vorlage für die gesamte Interim Management Phase</p>
                        </div>

                        <div class="content">
                            <div class="section">
                                <h2>Interim Management Kickoff Details</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projektname:</label>
                                        <p>${projectNameKickoff}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Kundenunternehmen:</label>
                                        <p>${clientCompany}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Interim Manager:</label>
                                        <p>${interimManagerKickoff}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Rolle/Position:</label>
                                        <p>${roleKickoff}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Startdatum:</label>
                                        <p>${startDate}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Voraussichtliches Enddatum:</label>
                                        <p>${endDate}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Ziele des Einsatzes:</label>
                                    <p>${assignmentGoals.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Umfang des Mandats:</label>
                                    <p>${scopeKickoff.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Stakeholder Analyse</h2>
                                ${stakeholderCardsHtml}
                            </div>

                            <div class="section">
                                <h2>Deliverables & Meilensteine</h2>
                                ${deliverablesHtml}
                            </div>

                            <div class="section">
                                <h2>Kommunikationsplan</h2>
                                ${communicationPlanHtml}
                            </div>

                            <div class="section">
                                <h2>Ressourcen & Tools</h2>
                                <div class="form-group">
                                    <label>Benötigte Ressourcen (Teammitglieder, Software, Hardware):</label>
                                    <p>${neededResources.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Zugangsberechtigungen & Systeme:</label>
                                    <p>${accessRequirements.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Berichtsübersicht</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projektname:</label>
                                        <p>${projectNameReport}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Interim Manager:</label>
                                        <p>${interimManagerReport}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Berichtsdatum:</label>
                                        <p>${reportDate}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Berichtszeitraum:</label>
                                        <p>${reportingPeriod}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Gesamtstatus:</label>
                                    <p>${overallStatus}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Fortschritt & Meilensteine</h2>
                                ${milestonesReportHtml}
                            </div>

                            <div class="section">
                                <h2>Top Themen & Herausforderungen</h2>
                                <div class="form-group">
                                    <label>Aktuelle Herausforderungen:</label>
                                    <p>${currentChallenges.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Getroffene Maßnahmen & nächste Schritte:</label>
                                    <p>${measuresTaken.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Risikomanagement (R.A.G.)</h2>
                                ${risksReportHtml}
                            </div>

                            <div class="section">
                                <h2>Nächste Schritte & Empfehlungen</h2>
                                <div class="form-group">
                                    <label>Geplante nächste Schritte:</label>
                                    <p>${nextStepsReport.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Empfehlungen an das Management:</label>
                                    <p>${recommendations.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Mandatsübersicht (Handover)</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projekt/Mandatsname:</label>
                                        <p>${mandateProjectName}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Kundenunternehmen:</label>
                                        <p>${mandateClient}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Interim Manager:</label>
                                        <p>${mandateInterimManager}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Rolle/Position:</label>
                                        <p>${mandateRole}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Startdatum:</label>
                                        <p>${mandateStartDate}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Enddatum:</label>
                                        <p>${mandateEndDate}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Zusammenfassung der Mandatsziele & -ergebnisse:</label>
                                    <p>${mandateSummary.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Schlüsselinformationen & Dokumentation</h2>
                                <div class="form-group">
                                    <label>Liste Schlüssel-Dokumente & Speicherorte:</label>
                                    <p>${keyDocuments.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Wichtige IT-Systeme & Zugänge:</label>
                                    <p>${itSystemsAccess.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Wichtige Kontakte & Stakeholder:</label>
                                    <p>${contactsStakeholders.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Offene Aufgaben & nächste Schritte:</label>
                                    <p>${pendingTasks.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Aktuelle Projekte & Initiativen:</label>
                                    <p>${currentProjectsInitiatives.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Finanzielle Übergabe</h2>
                                <div class="form-group">
                                    <label>Budgetübersicht & offene Posten:</label>
                                    <p>${budgetOverview.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Vertragsdetails & Konditionen:</label>
                                    <p>${contractDetails.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Lessons Learned & Empfehlungen (Handover)</h2>
                                <div class="form-group">
                                    <label>Lessons Learned aus dem Mandat:</label>
                                    <p>${lessonsLearnedHandover.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Empfehlungen für Nachfolger/Organisation:</label>
                                    <p>${recommendationsHandover.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Formelle Übergabe & Abnahme</h2>
                                <div class="form-group">
                                    <label>Datum der Übergabe:</label>
                                    <p>${handoverDateFinal}</p>
                                </div>
                                <div class="form-group">
                                    <label>Übergabe an (Name, Position):</label>
                                    <p>${receivingPerson}</p>
                                </div>
                                <div class="form-group">
                                    <label>Bestätigung/Sign-Off:</label>
                                    <p>${signOff.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Checkliste für den Exit-Prozess</h2>
                                ${checklistItems.map(item => `
                                    <div class="checklist-item-output">
                                        <span class="checkbox-icon ${item.checked ? 'checked' : 'unchecked'}">${item.checked ? '&#10003;' : '&#10007;'}</span>
                                        <p>${item.label}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'InterimManagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation erstellt!');
        }

        function exportHandover() {
            alert('Übergabe-Paket Export würde hier implementiert werden - alle relevanten Dokumente und Daten für nahtlose Übergabe');
        }
    </script>
</body>
</html>
