<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interim Management Dokumentationssystem</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.0/dist/tesseract.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-button">Zur Startseite</a>
            <h1>Interim Management Dokumentationssystem</h1>
            <p>Umfassende Vorlage für die gesamte Interim Management Phase</p>
            <div id="documentInfo" style="font-size: 0.8em; color: #666; margin-top: 10px;">Version 1.0 / <script>document.write(new Date().toLocaleDateString('de-DE'))</script></div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('kickoff', event)">Kickoff</button>
            <button class="nav-tab" onclick="showTab('report', event)">Status Report</button>
            <button class="nav-tab" onclick="showTab('handover', event)">Handover & Exit</button>
        </div>

        <div class="content">
            <div id="kickoff" class="tab-content active">
                <div class="section">
                    <h2>Interim Management Kickoff Details</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name">Projektname:</label>
                            <input type="text" id="project-name" placeholder="Projektname">
                        </div>
                        <div class="form-group">
                            <label for="client-company">Kundenunternehmen:</label>
                            <input type="text" id="client-company" placeholder="Name des Kundenunternehmens">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="interim-manager">Interim Manager:</label>
                            <input type="text" id="interim-manager" placeholder="Name des Interim Managers">
                        </div>
                        <div class="form-group">
                            <label for="role">Rolle/Position:</label>
                            <input type="text" id="role" placeholder="Übernommene Rolle/Position">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="start-date">Startdatum:</label>
                            <input type="date" id="start-date">
                        </div>
                        <div class="form-group">
                            <label for="end-date">Voraussichtliches Enddatum:</label>
                            <input type="date" id="end-date">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="assignment-goals">Ziele des Einsatzes:</label>
                        <textarea id="assignment-goals" placeholder="Detaillierte Beschreibung der primären Ziele und Erwartungen des Interim Mandats" class="textarea-large"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="scope">Umfang des Mandats:</label>
                        <textarea id="scope" placeholder="Genaue Definition des Umfangs, Verantwortlichkeiten und Abgrenzungen" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Stakeholder Analyse</h2>
                    <div id="stakeholder-list">
                        <div class="stakeholder-card">
                            <h3>Stakeholder 1</h3>
                            <div class="stakeholder-details">
                                <div class="stakeholder-detail">
                                    <strong>Name:</strong> <input type="text" class="data-table-input" placeholder="Name">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Rolle:</strong> <input type="text" class="data-table-input" placeholder="Rolle">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Abteilung:</strong> <input type="text" class="data-table-input" placeholder="Abteilung">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>E-Mail:</strong> <input type="email" class="data-table-input" placeholder="E-Mail">
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Interesse:</strong>
                                    <select class="data-table-input interest-level">
                                        <option value="low" class="level-low">Niedrig</option>
                                        <option value="medium" class="level-medium">Mittel</option>
                                        <option value="high" class="level-high">Hoch</option>
                                    </select>
                                </div>
                                <div class="stakeholder-detail">
                                    <strong>Einfluss:</strong>
                                    <select class="data-table-input influence-level">
                                        <option value="low" class="level-low">Niedrig</option>
                                        <option value="medium" class="level-medium">Mittel</option>
                                        <option value="high" class="level-high">Hoch</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Kommunikationsstrategie:</label>
                                <textarea class="data-table-input" placeholder="Geplante Kommunikationsmaßnahmen"></textarea>
                            </div>
                            <button onclick="removeStakeholderKickoff(this)" class="delete-button">X</button>
                        </div>
                    </div>
                    <button class="add-button" onclick="addStakeholderKickoff()">+ Weiteren Stakeholder hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Deliverables & Meilensteine</h2>
                    <table class="data-table" id="deliverables-table">
                        <thead>
                            <tr>
                                <th>Aufgabe/Liefergegenstand</th>
                                <th>Verantwortlicher</th>
                                <th>Fälligkeitsdatum</th>
                                <th>Status</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Aufgabe beschreiben"></td>
                                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                                <td><input type="date" class="data-table-input"></td>
                                <td>
                                    <select class="data-table-input">
                                        <option>Geplant</option>
                                        <option>In Arbeit</option>
                                        <option>Abgeschlossen</option>
                                        <option>Verzögert</option>
                                    </select>
                                </td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addDeliverableRow()">+ Liefergegenstand hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Kommunikationsplan</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Zielgruppe</th>
                                <th>Frequenz</th>
                                <th>Kanal</th>
                                <th>Format</th>
                                <th>Zweck</th>
                                <th>Verantwortlicher</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="communication-plan-table">
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Zielgruppe"></td>
                                <td><input type="text" class="data-table-input" placeholder="Frequenz"></td>
                                <td><input type="text" class="data-table-input" placeholder="Kanal"></td>
                                <td><input type="text" class="data-table-input" placeholder="Format"></td>
                                <td><input type="text" class="data-table-input" placeholder="Zweck"></td>
                                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addCommunicationRow()">+ Kommunikationspunkt hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Ressourcen & Tools</h2>
                    <div class="form-group">
                        <label for="needed-resources">Benötigte Ressourcen (Teammitglieder, Software, Hardware):</label>
                        <textarea id="needed-resources" placeholder="Liste aller benötigten Ressourcen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="access-requirements">Zugangsberechtigungen & Systeme:</label>
                        <textarea id="access-requirements" placeholder="Erforderliche Zugänge und Systeme" class="textarea-large"></textarea>
                    </div>
                </div>
            </div>

            <div id="report" class="tab-content">
                <div class="section">
                    <h2>Berichtsübersicht</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name-report">Projektname:</label>
                            <input type="text" id="project-name-report" placeholder="Projektname">
                        </div>
                        <div class="form-group">
                            <label for="interim-manager-report">Interim Manager:</label>
                            <input type="text" id="interim-manager-report" placeholder="Name des Interim Managers">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="report-date">Berichtsdatum:</label>
                            <input type="date" id="report-date">
                        </div>
                        <div class="form-group">
                            <label for="reporting-period">Berichtszeitraum:</label>
                            <input type="text" id="reporting-period" placeholder="z.B. KW 28-30">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="overall-status">Gesamtstatus:</label>
                        <select id="overall-status">
                            <option value="green">🟢 Grün - Im Plan</option>
                            <option value="yellow">🟡 Gelb - Achtung</option>
                            <option value="red">🔴 Rot - Kritisch</option>
                        </select>
                    </div>
                </div>

                <div class="section">
                    <h2>Fortschritt & Meilensteine</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Meilenstein/Ziel</th>
                                <th>Plan-Datum</th>
                                <th>Aktuell/Prognose</th>
                                <th>Status</th>
                                <th>Kommentare</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="milestones-table-body">
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Milestone/Goal"></td>
                                <td><input type="date" class="data-table-input"></td>
                                <td><input type="text" class="data-table-input" placeholder="Actual/Forecast"></td>
                                <td>
                                    <select class="data-table-input">
                                        <option>Completed</option>
                                        <option>In progress</option>
                                        <option>Delayed</option>
                                        <option>Not started</option>
                                    </select>
                                </td>
                                <td><input type="text" class="data-table-input" placeholder="Comments"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addMilestoneReportRow()">+ Meilenstein hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Top Themen & Herausforderungen</h2>
                    <div class="form-group">
                        <label for="current-challenges">Aktuelle Herausforderungen:</label>
                        <textarea id="current-challenges" placeholder="Beschreibung der wichtigsten Herausforderungen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="measures-taken">Getroffene Maßnahmen & nächste Schritte:</label>
                        <textarea id="measures-taken" placeholder="Welche Maßnahmen wurden ergriffen und welche sind geplant?" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Risikomanagement (R.A.G.)</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Beschreibung des Risikos/Problems</th>
                                <th>Auswirkung</th>
                                <th>Wahrscheinlichkeit</th>
                                <th>Status</th>
                                <th>Maßnahmen & Verantwortlicher</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="risk-report-table-body">
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Risk/Issue Description"></td>
                                <td><input type="text" class="data-table-input" placeholder="Impact"></td>
                                <td><input type="text" class="data-table-input" placeholder="Probability"></td>
                                <td>
                                    <select class="data-table-input">
                                        <option>Rot</option>
                                        <option>Gelb</option>
                                        <option>Grün</option>
                                    </select>
                                </td>
                                <td><input type="text" class="data-table-input" placeholder="Actions & Owner"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addRiskReportRow()">+ Risiko/Problem hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Nächste Schritte & Empfehlungen</h2>
                    <div class="form-group">
                        <label for="next-steps-report">Geplante nächste Schritte:</label>
                        <textarea id="next-steps-report" placeholder="Detaillierte Auflistung der für den nächsten Zeitraum geplanten Aktivitäten" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="recommendations">Empfehlungen an das Management:</label>
                        <textarea id="recommendations" placeholder="Vorschläge und Empfehlungen zur Entscheidungsfindung" class="textarea-large"></textarea>
                    </div>
                </div>
            </div>

            <div id="handover" class="tab-content">
                <div class="section">
                    <h2>Mandatsübersicht</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mandate-project-name">Projekt/Mandatsname:</label>
                            <input type="text" id="mandate-project-name" placeholder="Name des Projekts oder Mandats">
                        </div>
                        <div class="form-group">
                            <label for="mandate-client">Kundenunternehmen:</label>
                            <input type="text" id="mandate-client" placeholder="Name des Kundenunternehmens">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mandate-interim-manager">Interim Manager:</label>
                            <input type="text" id="mandate-interim-manager" placeholder="Name des Interim Managers">
                        </div>
                        <div class="form-group">
                            <label for="mandate-role">Rolle/Position:</label>
                            <input type="text" id="mandate-role" placeholder="Übernommene Rolle/Position">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mandate-start-date">Startdatum des Mandats:</label>
                            <input type="date" id="mandate-start-date">
                        </div>
                        <div class="form-group">
                            <label for="mandate-end-date">Enddatum des Mandats:</label>
                            <input type="date" id="mandate-end-date">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="mandate-summary">Zusammenfassung des Mandats & Erfolge:</label>
                        <textarea id="mandate-summary" placeholder="Kurze Zusammenfassung der Kernaufgaben, Ziele und wichtigsten Erfolge des Interim Mandats" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Wichtige Dokumente & Übergabematerialien</h2>
                    <table class="data-table" id="handover-documents-table">
                        <thead>
                            <tr>
                                <th>Dokument/Material</th>
                                <th>Beschreibung</th>
                                <th>Speicherort/Link</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Dokumentname"></td>
                                <td><input type="text" class="data-table-input" placeholder="Kurze Beschreibung"></td>
                                <td><input type="text" class="data-table-input" placeholder="Link oder Pfad"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addHandoverDocumentRow()">+ Dokument hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Offene Punkte & Empfehlungen für Nachfolger</h2>
                    <div class="form-group">
                        <label for="open-items">Liste der offenen Punkte & To-Dos:</label>
                        <textarea id="open-items" placeholder="Alle unerledigten Aufgaben, ungelösten Probleme oder weiterzuführende Initiativen" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="recommendations-successor">Empfehlungen für den Nachfolger:</label>
                        <textarea id="recommendations-successor" placeholder="Wichtige Hinweise, strategische Empfehlungen und Lessons Learned für die Fortführung des Mandats" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Ansprechpartner & Kontakte für die Übergabe</h2>
                    <table class="data-table" id="handover-contacts-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Rolle/Beziehung</th>
                                <th>Kontaktinformationen</th>
                                <th>Relevanz für Nachfolger</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="data-table-input" placeholder="Name"></td>
                                <td><input type="text" class="data-table-input" placeholder="Rolle"></td>
                                <td><input type="text" class="data-table-input" placeholder="E-Mail / Telefon"></td>
                                <td><input type="text" class="data-table-input" placeholder="Z.B. Entscheidungsgeber, Experte"></td>
                                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-button" onclick="addHandoverContactRow()">+ Ansprechpartner hinzufügen</button>
                </div>

                <div class="section">
                    <h2>Exit-Prozess & Lessons Learned</h2>
                    <div class="form-group">
                        <label for="exit-strategy">Exit-Strategie:</label>
                        <textarea id="exit-strategy" placeholder="Beschreibung des geplanten Exit-Prozesses und der Sicherstellung eines reibungslosen Übergangs" class="textarea-large"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="lessons-learned-im">Lessons Learned aus dem Mandat:</label>
                        <textarea id="lessons-learned-im" placeholder="Wichtige Erkenntnisse und Best Practices, die aus dem Interim Mandat gewonnen wurden" class="textarea-large"></textarea>
                    </div>
                </div>

                <div class="section">
                    <h2>Checkliste für den Exit-Prozess</h2>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-1">
                        <label for="checklist-1">Alle offenen Aufgaben dokumentiert und an Nachfolger übergeben</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-2">
                        <label for="checklist-2">Zugangsberechtigungen geprüft und ggf. deaktiviert</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-3">
                        <label for="checklist-3">Alle relevanten Dokumente und Berichte archiviert</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-4">
                        <label for="checklist-4">Abschlussgespräch mit Kunden/Sponsor durchgeführt</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="checklist-5">
                        <label for="checklist-5">Rechnungsstellung und administrative Aufgaben abgeschlossen</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName, event) {
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
        }

        // Common function to add rows for tables
        function addRow(tableId, rowHtml) {
            const tbody = document.querySelector(`#${tableId} tbody`);
            const newRow = document.createElement('tr');
            newRow.innerHTML = rowHtml;
            tbody.appendChild(newRow);
        }

        function removeRow(button) {
            button.closest('tr').remove();
        }

        // Kickoff Tab specific functions
        function addStakeholderKickoff() {
            const stakeholderList = document.getElementById('stakeholder-list');
            const newStakeholderCard = document.createElement('div');
            newStakeholderCard.classList.add('stakeholder-card');
            newStakeholderCard.innerHTML = `
                <h3>Neuer Stakeholder</h3>
                <div class="stakeholder-details">
                    <div class="stakeholder-detail">
                        <strong>Name:</strong> <input type="text" class="data-table-input" placeholder="Name">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Rolle:</strong> <input type="text" class="data-table-input" placeholder="Rolle">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Abteilung:</strong> <input type="text" class="data-table-input" placeholder="Abteilung">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>E-Mail:</strong> <input type="email" class="data-table-input" placeholder="E-Mail">
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Interesse:</strong>
                        <select class="data-table-input interest-level">
                            <option value="low" class="level-low">Niedrig</option>
                            <option value="medium" class="level-medium">Mittel</option>
                            <option value="high" class="level-high">Hoch</option>
                        </select>
                    </div>
                    <div class="stakeholder-detail">
                        <strong>Einfluss:</strong>
                        <select class="data-table-input influence-level">
                            <option value="low" class="level-low">Niedrig</option>
                            <option value="medium" class="level-medium">Mittel</option>
                            <option value="high" class="level-high">Hoch</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Kommunikationsstrategie:</label>
                    <textarea class="data-table-input" placeholder="Geplante Kommunikationsmaßnahmen"></textarea>
                </div>
                <button onclick="removeStakeholderKickoff(this)" class="delete-button">X</button>
            `;
            stakeholderList.appendChild(newStakeholderCard);
        }

        function removeStakeholderKickoff(button) {
            button.closest('.stakeholder-card').remove();
        }

        function addDeliverableRow() {
            const rowHtml = `
                <td><input type="text" class="data-table-input" placeholder="Aufgabe beschreiben"></td>
                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                <td><input type="date" class="data-table-input"></td>
                <td>
                    <select class="data-table-input">
                        <option>Geplant</option>
                        <option>In Arbeit</option>
                        <option>Abgeschlossen</option>
                        <option>Verzögert</option>
                    </select>
                </td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            addRow('deliverables-table', rowHtml);
        }

        function addCommunicationRow() {
            const rowHtml = `
                <td><input type="text" class="data-table-input" placeholder="Zielgruppe"></td>
                <td><input type="text" class="data-table-input" placeholder="Frequenz"></td>
                <td><input type="text" class="data-table-input" placeholder="Kanal"></td>
                <td><input type="text" class="data-table-input" placeholder="Format"></td>
                <td><input type="text" class="data-table-input" placeholder="Zweck"></td>
                <td><input type="text" class="data-table-input" placeholder="Verantwortlicher"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            addRow('communication-plan-table', rowHtml);
        }

        // Report Tab specific functions
        function addMilestoneReportRow() {
            const rowHtml = `
                <td><input type="text" class="data-table-input" placeholder="Milestone/Goal"></td>
                <td><input type="date" class="data-table-input"></td>
                <td><input type="text" class="data-table-input" placeholder="Actual/Forecast"></td>
                <td>
                    <select class="data-table-input">
                        <option>Completed</option>
                        <option>In progress</option>
                        <option>Delayed</option>
                        <option>Not started</option>
                    </select>
                </td>
                <td><input type="text" class="data-table-input" placeholder="Comments"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            addRow('milestones-table-body', rowHtml);
        }

        function addRiskReportRow() {
            const rowHtml = `
                <td><input type="text" class="data-table-input" placeholder="Risk/Issue Description"></td>
                <td><input type="text" class="data-table-input" placeholder="Impact"></td>
                <td><input type="text" class="data-table-input" placeholder="Probability"></td>
                <td>
                    <select class="data-table-input">
                        <option>Rot</option>
                        <option>Gelb</option>
                        <option>Grün</option>
                    </select>
                </td>
                <td><input type="text" class="data-table-input" placeholder="Actions & Owner"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            addRow('risk-report-table-body', rowHtml);
        }

        // Handover Tab specific functions
        function addHandoverDocumentRow() {
            const rowHtml = `
                <td><input type="text" class="data-table-input" placeholder="Dokumentname"></td>
                <td><input type="text" class="data-table-input" placeholder="Kurze Beschreibung"></td>
                <td><input type="text" class="data-table-input" placeholder="Link oder Pfad"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            addRow('handover-documents-table', rowHtml);
        }

        function addHandoverContactRow() {
            const rowHtml = `
                <td><input type="text" class="data-table-input" placeholder="Name"></td>
                <td><input type="text" class="data-table-input" placeholder="Rolle"></td>
                <td><input type="text" class="data-table-input" placeholder="E-Mail / Telefon"></td>
                <td><input type="text" class="data-table-input" placeholder="Z.B. Entscheidungsgeber, Experte"></td>
                <td><button onclick="removeRow(this)" class="delete-button">X</button></td>
            `;
            addRow('handover-contacts-table', rowHtml);
        }

        // Generate Static HTML function
        function generateStaticHtml() {
            const staticHtmlContent = `
                <!DOCTYPE html>
                <html lang="de">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Interim Management Dokumentation</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; color: #333; }
                        .container { max-width: 900px; margin: auto; padding: 20px; border: 1px solid #ddd; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 20px; }
                        .header h1 { color: #333; }
                        .section { margin-bottom: 30px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
                        .section h2 { color: #555; border-bottom: 2px solid #555; padding-bottom: 10px; margin-bottom: 20px; }
                        .form-group label { font-weight: bold; display: block; margin-bottom: 5px; }
                        .form-group p { margin-bottom: 15px; background-color: #f9f9f9; padding: 10px; border-radius: 3px; border: 1px solid #e1e1e1; white-space: pre-wrap; word-wrap: break-word;}
                        .form-row { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 15px;}
                        .form-row .form-group { flex: 1; min-width: 300px; }
                        .data-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        .data-table th, .data-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        .data-table th { background-color: #f2f2f2; }
                        .stakeholder-card { border: 1px solid #ccc; padding: 15px; margin-bottom: 15px; border-radius: 5px; background-color: #fdfdfd; }
                        .stakeholder-card h3 { margin-top: 0; color: #007bff; }
                        .stakeholder-details { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 10px; }
                        .stakeholder-detail { flex: 1; min-width: 200px; }
                        .checklist-item-output { display: flex; align-items: center; margin-bottom: 10px; }
                        .checkbox-icon { margin-right: 10px; font-size: 1.2em; }
                        .checkbox-icon.checked { color: green; }
                        .checkbox-icon.unchecked { color: red; }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>Interim Management Dokumentation</h1>
                            <p>Umfassende Vorlage für die gesamte Interim Management Phase</p>
                            <div id="documentInfo" style="font-size: 0.8em; color: #666; margin-top: 10px;">Version 1.0 / ${new Date().toLocaleDateString('de-DE')}</div>
                        </div>

                        <div class="content">
                            <div class="section">
                                <h2>Interim Management Kickoff Details</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projektname:</label>
                                        <p>${document.getElementById('project-name').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Kundenunternehmen:</label>
                                        <p>${document.getElementById('client-company').value}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Interim Manager:</label>
                                        <p>${document.getElementById('interim-manager').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Rolle/Position:</label>
                                        <p>${document.getElementById('role').value}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Startdatum:</label>
                                        <p>${document.getElementById('start-date').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Voraussichtliches Enddatum:</label>
                                        <p>${document.getElementById('end-date').value}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Ziele des Einsatzes:</label>
                                    <p>${document.getElementById('assignment-goals').value.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Umfang des Mandats:</label>
                                    <p>${document.getElementById('scope').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Stakeholder Analyse</h2>
                                ${Array.from(document.querySelectorAll('#stakeholder-list .stakeholder-card')).map((card, index) => `
                                    <div class="stakeholder-card">
                                        <h3>Stakeholder ${index + 1}</h3>
                                        <div class="stakeholder-details">
                                            <div class="stakeholder-detail">
                                                <strong>Name:</strong> <p>${card.querySelector('input[placeholder="Name"]').value}</p>
                                            </div>
                                            <div class="stakeholder-detail">
                                                <strong>Rolle:</strong> <p>${card.querySelector('input[placeholder="Rolle"]').value}</p>
                                            </div>
                                            <div class="stakeholder-detail">
                                                <strong>Abteilung:</strong> <p>${card.querySelector('input[placeholder="Abteilung"]').value}</p>
                                            </div>
                                            <div class="stakeholder-detail">
                                                <strong>E-Mail:</strong> <p>${card.querySelector('input[placeholder="E-Mail"]').value}</p>
                                            </div>
                                            <div class="stakeholder-detail">
                                                <strong>Interesse:</strong> <p>${card.querySelector('.interest-level').options[card.querySelector('.interest-level').selectedIndex].text}</p>
                                            </div>
                                            <div class="stakeholder-detail">
                                                <strong>Einfluss:</strong> <p>${card.querySelector('.influence-level').options[card.querySelector('.influence-level').selectedIndex].text}</p>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Kommunikationsstrategie:</label>
                                            <p>${card.querySelector('textarea[placeholder="Geplante Kommunikationsmaßnahmen"]').value.replace(/\n/g, '<br>')}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>

                            <div class="section">
                                <h2>Deliverables & Meilensteine</h2>
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Aufgabe/Liefergegenstand</th>
                                            <th>Verantwortlicher</th>
                                            <th>Fälligkeitsdatum</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${Array.from(document.querySelectorAll('#deliverables-table tbody tr')).map(row => `
                                            <tr>
                                                <td><p>${row.cells[0].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[1].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[2].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[3].querySelector('select').options[row.cells[3].querySelector('select').selectedIndex].text}</p></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="section">
                                <h2>Kommunikationsplan</h2>
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Zielgruppe</th>
                                            <th>Frequenz</th>
                                            <th>Kanal</th>
                                            <th>Format</th>
                                            <th>Zweck</th>
                                            <th>Verantwortlicher</th>
                                        </tr>
                                    </thead>
                                    <tbody id="communication-plan-table">
                                        ${Array.from(document.querySelectorAll('#communication-plan-table tr')).map(row => `
                                            <tr>
                                                <td><p>${row.cells[0].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[1].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[2].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[3].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[4].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[5].querySelector('input').value}</p></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="section">
                                <h2>Ressourcen & Tools</h2>
                                <div class="form-group">
                                    <label>Benötigte Ressourcen (Teammitglieder, Software, Hardware):</label>
                                    <p>${document.getElementById('needed-resources').value.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Zugangsberechtigungen & Systeme:</label>
                                    <p>${document.getElementById('access-requirements').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Berichtsübersicht</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projektname:</label>
                                        <p>${document.getElementById('project-name-report').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Interim Manager:</label>
                                        <p>${document.getElementById('interim-manager-report').value}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Berichtsdatum:</label>
                                        <p>${document.getElementById('report-date').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Berichtszeitraum:</label>
                                        <p>${document.getElementById('reporting-period').value}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Gesamtstatus:</label>
                                    <p>${document.getElementById('overall-status').options[document.getElementById('overall-status').selectedIndex].text}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Fortschritt & Meilensteine</h2>
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Meilenstein/Ziel</th>
                                            <th>Plan-Datum</th>
                                            <th>Aktuell/Prognose</th>
                                            <th>Status</th>
                                            <th>Kommentare</th>
                                        </tr>
                                    </thead>
                                    <tbody id="milestones-table-body">
                                        ${Array.from(document.querySelectorAll('#milestones-table-body tr')).map(row => `
                                            <tr>
                                                <td><p>${row.cells[0].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[1].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[2].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[3].querySelector('select').options[row.cells[3].querySelector('select').selectedIndex].text}</p></td>
                                                <td><p>${row.cells[4].querySelector('input').value}</p></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="section">
                                <h2>Top Themen & Herausforderungen</h2>
                                <div class="form-group">
                                    <label>Aktuelle Herausforderungen:</label>
                                    <p>${document.getElementById('current-challenges').value.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Getroffene Maßnahmen & nächste Schritte:</label>
                                    <p>${document.getElementById('measures-taken').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Risikomanagement (R.A.G.)</h2>
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Beschreibung des Risikos/Problems</th>
                                            <th>Auswirkung</th>
                                            <th>Wahrscheinlichkeit</th>
                                            <th>Status</th>
                                            <th>Maßnahmen & Verantwortlicher</th>
                                        </tr>
                                    </thead>
                                    <tbody id="risk-report-table-body">
                                        ${Array.from(document.querySelectorAll('#risk-report-table-body tr')).map(row => `
                                            <tr>
                                                <td><p>${row.cells[0].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[1].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[2].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[3].querySelector('select').options[row.cells[3].querySelector('select').selectedIndex].text}</p></td>
                                                <td><p>${row.cells[4].querySelector('input').value}</p></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="section">
                                <h2>Nächste Schritte & Empfehlungen</h2>
                                <div class="form-group">
                                    <label>Geplante nächste Schritte:</label>
                                    <p>${document.getElementById('next-steps-report').value.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Empfehlungen an das Management:</label>
                                    <p>${document.getElementById('recommendations').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Mandatsübersicht</h2>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Projekt/Mandatsname:</label>
                                        <p>${document.getElementById('mandate-project-name').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Kundenunternehmen:</label>
                                        <p>${document.getElementById('mandate-client').value}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Interim Manager:</label>
                                        <p>${document.getElementById('mandate-interim-manager').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Rolle/Position:</label>
                                        <p>${document.getElementById('mandate-role').value}</p>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Startdatum des Mandats:</label>
                                        <p>${document.getElementById('mandate-start-date').value}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>Enddatum des Mandats:</label>
                                        <p>${document.getElementById('mandate-end-date').value}</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Zusammenfassung des Mandats & Erfolge:</label>
                                    <p>${document.getElementById('mandate-summary').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Wichtige Dokumente & Übergabematerialien</h2>
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Dokument/Material</th>
                                            <th>Beschreibung</th>
                                            <th>Speicherort/Link</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${Array.from(document.querySelectorAll('#handover-documents-table tbody tr')).map(row => `
                                            <tr>
                                                <td><p>${row.cells[0].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[1].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[2].querySelector('input').value}</p></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="section">
                                <h2>Offene Punkte & Empfehlungen für Nachfolger</h2>
                                <div class="form-group">
                                    <label>Liste der offenen Punkte & To-Dos:</label>
                                    <p>${document.getElementById('open-items').value.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Empfehlungen für den Nachfolger:</label>
                                    <p>${document.getElementById('recommendations-successor').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Ansprechpartner & Kontakte für die Übergabe</h2>
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Rolle/Beziehung</th>
                                            <th>Kontaktinformationen</th>
                                            <th>Relevanz für Nachfolger</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${Array.from(document.querySelectorAll('#handover-contacts-table tbody tr')).map(row => `
                                            <tr>
                                                <td><p>${row.cells[0].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[1].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[2].querySelector('input').value}</p></td>
                                                <td><p>${row.cells[3].querySelector('input').value}</p></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="section">
                                <h2>Exit-Prozess & Lessons Learned</h2>
                                <div class="form-group">
                                    <label>Exit-Strategie:</label>
                                    <p>${document.getElementById('exit-strategy').value.replace(/\n/g, '<br>')}</p>
                                </div>
                                <div class="form-group">
                                    <label>Lessons Learned aus dem Mandat:</label>
                                    <p>${document.getElementById('lessons-learned-im').value.replace(/\n/g, '<br>')}</p>
                                </div>
                            </div>

                            <div class="section">
                                <h2>Checkliste für den Exit-Prozess</h2>
                                ${Array.from(document.querySelectorAll('.checklist-item')).map(item => {
                                    const checked = item.querySelector('input[type="checkbox"]').checked;
                                    const label = item.querySelector('label').innerText;
                                    return `
                                        <div class="checklist-item-output">
                                            <span class="checkbox-icon ${checked ? 'checked' : 'unchecked'}">${checked ? '&#10003;' : '&#10007;'}</span>
                                            <p>${label}</p>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([staticHtmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'InterimManagement-Dokumentation.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('Statische HTML-Dokumentation erstellt!');
        }

        function exportHandover() {
            alert('Übergabe-Paket Export würde hier implementiert werden - alle relevanten Dokumente und Daten für nahtlose Übergabe');
        }
    </script>
</body>
</html>